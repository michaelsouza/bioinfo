(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    509180,      12141]
NotebookOptionsPosition[    497443,      11792]
NotebookOutlinePosition[    497986,      11813]
CellTagsIndexPosition[    497943,      11810]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["DMDGP Package", "Title",
 CellChangeTimes->{{3.6793495261201363`*^9, 3.6793495384395885`*^9}, 
   3.679349644788345*^9, 3.67934974754046*^9},
 Background->RGBColor[0.88, 1, 0.88]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Aborting", " ", "after", " ", "first", " ", "error"}], " ", "-", 
    " ", 
    RowBox[{
    "Put", " ", "the", " ", "following", " ", "two", " ", "lines", " ", "at", 
     " ", "the", " ", "top", " ", "of", " ", "every", " ", 
     RowBox[{"notebook", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"messageHandler", "=", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Last", "[", "#", "]"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}], "&"}]}], ";", "\n", 
    RowBox[{"Internal`AddHandler", "[", 
     RowBox[{"\"\<Message\>\"", ",", "messageHandler"}], "]"}], ";"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.679757497923143*^9, 3.679757497925144*^9}, {
  3.679757553203314*^9, 3.6797575703583574`*^9}, {3.6798207857498636`*^9, 
  3.6798207957920666`*^9}, {3.6815755003341312`*^9, 3.6815755057314215`*^9}, {
  3.6816410775004396`*^9, 3.681641077953618*^9}, {3.68605379297364*^9, 
  3.6860538180843325`*^9}}],

Cell[CellGroupData[{

Cell["Basic Routines, Instance Creation, LDME and RMSD", "Section",
 CellChangeTimes->{{3.6793500520209*^9, 3.679350065056984*^9}, {
  3.6950585832964363`*^9, 3.6950585871556697`*^9}, {3.695721180314636*^9, 
  3.695721206866439*^9}},
 Background->RGBColor[1, 1, 0.85]],

Cell[CellGroupData[{

Cell["Source Code: Instance Creation and Basic Routines", "Subsection",
 CellChangeTimes->{{3.6957166751540866`*^9, 3.695716678572562*^9}, {
  3.69571845100841*^9, 3.695718453293476*^9}, {3.695718950695672*^9, 
  3.695718956236369*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\[IndentingNewLine]", 
    RowBox[{
    "SetPositionUsingCartesianSystem", ",", "\[IndentingNewLine]", 
     "SetPositionUsingHomogeneousCoords", ",", "\[IndentingNewLine]", 
     "CalculateProteinAngles", ",", "\[IndentingNewLine]", 
     "CalculateTorsionAngles", ",", "\[IndentingNewLine]", 
     "GenerateRandom3DBackbone", ",", "\[IndentingNewLine]", 
     "GenerateRandomMDGP", ",", "\[IndentingNewLine]", "GetMatrixDistance", 
     ",", "\[IndentingNewLine]", "Plot3DBackbone", ",", "\[IndentingNewLine]",
      "WriteMDGP"}], "\[IndentingNewLine]", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetEdgeWeight", "::", "usage"}], "=", 
   "\"\<Gets edge weight. 'E' can be a single edge or a list of edges.\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetEdgeWeight", "[", 
    RowBox[{"G_", ",", "E_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"D", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"FailureQ", "[", 
          RowBox[{"PropertyValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"G", ",", 
              RowBox[{"E", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "EdgeWeight"}], 
           "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "E", " ", "is", " ", "a", " ", "list", " ", "of", " ", "edges"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"i", "=", "1"}], ",", 
          RowBox[{"i", "\[LessEqual]", 
           RowBox[{"Length", "[", "E", "]"}]}], ",", 
          RowBox[{"i", "++"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"D", ",", 
            RowBox[{"PropertyValue", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"G", ",", 
                RowBox[{"E", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", "EdgeWeight"}],
              "]"}]}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"E", " ", "is", " ", "a", " ", "single", " ", "edge"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"D", "=", 
         RowBox[{"PropertyValue", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"G", ",", "E"}], "}"}], ",", "EdgeWeight"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "D", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetEdgeDistanceBounds", "[", 
     RowBox[{"G_", ",", "E_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Lij", ",", "Uij", ",", "Vij"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Vij", "=", 
        RowBox[{"PropertyValue", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"G", ",", "E"}], "}"}], ",", "\"\<DistanceBounds\>\""}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Vij", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetPositionUsingCartesianSystem", "[", 
     RowBox[{"d_", ",", "\[Theta]_", ",", "\[Omega]_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Calculates", " ", "Euclidean", " ", "coords", " ", "from", " ", 
       "distances"}], ",", " ", 
      RowBox[{
       RowBox[{
       "planar", " ", "and", " ", "dihedral", " ", "angles", " ", "using", 
        " ", "rotations", " ", "and", " ", "translations", " ", 
        "explicitly"}], ";", "\[IndentingNewLine]", "   ", 
       StyleBox[
        RowBox[{"Input", " ", "parameters"}],
        FontVariations->{"Underline"->True}], ";", "\[IndentingNewLine]", 
       "   ", 
       RowBox[{
        StyleBox["d",
         FontSlant->"Italic"], ":", 
        StyleBox[" ",
         FontWeight->"Plain"], 
        StyleBox[
         RowBox[{"distances", "       ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", "[", "i", "]"}], " ", "=", " ", 
            RowBox[{"norm", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "-", 
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ")"}]}]}], ")"}]}],
         FontWeight->"Plain"]}], 
       StyleBox[";",
        FontWeight->"Plain"], "            ", "\[IndentingNewLine]", "   ", 
       RowBox[{
        StyleBox["\[Theta]",
         FontSlant->"Italic"], ":", " ", 
        StyleBox[
         RowBox[{"planar", " ", "angles", "   ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "i", "]"}], " ", "=", " ", 
            RowBox[{"angle", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x", "[", "i", "]"}], ",", 
               RowBox[{"x", "[", 
                RowBox[{"i", "-", "1"}], "]"}], ",", 
               RowBox[{"x", "[", 
                RowBox[{"i", "-", "2"}], "]"}]}], ")"}]}]}], ")"}]}],
         FontWeight->"Plain"]}], 
       StyleBox[";",
        FontWeight->"Plain"], "        ", "\[IndentingNewLine]", "   ", 
       RowBox[{
        StyleBox["\[Omega]",
         FontSlant->"Italic"], ":", " ", 
        RowBox[{
         StyleBox["dihedral",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox["angles",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         RowBox[{
          StyleBox["(",
           FontWeight->"Plain"], 
          StyleBox[
           RowBox[{
            RowBox[{"\[Omega]", "[", "i", "]"}], " ", "=", " ", 
            RowBox[{"angle", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x", "[", "i", "]"}], ",", 
               RowBox[{"x", "[", 
                RowBox[{"i", "-", "1"}], "]"}], ",", 
               RowBox[{"x", "[", 
                RowBox[{"i", "-", "2"}], "]"}], ",", 
               RowBox[{"x", "[", 
                RowBox[{"i", "-", "3"}], "]"}]}], ")"}]}]}],
           FontWeight->"Plain"], " ", "\[IndentingNewLine]"}]}]}]}]}], "*)"}],
     "\[IndentingNewLine]", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"declare", " ", "local", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "a", ",", "b", ",", "c", ",", "i", ",", "v", ",", "n", ",", "R", ",", 
        "X", ",", "numberOfAtoms"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"numberOfAtoms", "=", 
        RowBox[{"Length", "[", "d", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "atoms", " ", "positions", " ", "on", " ", "Euclidean", " ", "3", "d",
          " ", "space"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"X", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "numberOfAtoms"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "set", " ", "the", " ", "position", " ", "of", " ", "the", " ", 
         "three", " ", "first", " ", "points"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"d", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", "0", ",", "0"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"d", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"d", "[", 
               RowBox[{"[", "3", "]"}], "]"}], 
              RowBox[{"Cos", "[", 
               RowBox[{"\[Theta]", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"[", "3", "]"}], "]"}], 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}]}], " ", ",", "0"}], 
           "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "remaining", " ", "positions"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "4"}], ",", 
         RowBox[{"i", "\[LessEqual]", "numberOfAtoms"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"[", 
               RowBox[{"i", "-", "3"}], "]"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"[", 
               RowBox[{"i", "-", "2"}], "]"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"[", 
               RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"v", "=", " ", 
           RowBox[{
            RowBox[{"d", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", " ", 
            RowBox[{"Normalize", "[", 
             RowBox[{"b", "-", "c"}], "]"}]}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "normal", " ", "to", " ", "the", " ", "plane", " ", "abc"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"n", "=", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"a", "-", "b"}], ",", 
             RowBox[{"c", "-", "b"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"apply", " ", "plane", " ", "rotation"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"R", "=", 
           RowBox[{"RotationTransform", "[", 
            RowBox[{
             RowBox[{"\[Theta]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "n"}], "]"}]}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"rotation", " ", "creation"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"v", "=", 
           RowBox[{"R", "[", "v", "]"}]}], ";", " ", 
          RowBox[{"(*", " ", 
           RowBox[{"rotation", " ", "apply"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "apply", " ", "torsion", " ", "rotation", " ", "and", " ", 
            "translation"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"R", "=", 
           RowBox[{"RotationTransform", "[", 
            RowBox[{
             RowBox[{"\[Omega]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"c", "-", "b"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"v", "=", 
           RowBox[{
            RowBox[{"R", "[", "v", "]"}], "+", "c"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"set", " ", "i"}], "-", 
            RowBox[{"th", " ", "coordinate"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", "v"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "X", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetPositionUsingHomogeneousCoords", "::", "usage"}], "=", 
   "\"\<Set the atoms positions using internal coordinate system.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetPositionUsingHomogeneousCoords", "[", 
     RowBox[{"d_", ",", "\[Theta]_", ",", "\[Omega]_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Calculates", " ", "Euclidean", " ", "coords", " ", "from", " ", 
       "distances"}], ",", " ", 
      RowBox[{
       RowBox[{
       "planar", " ", "and", " ", "dihedral", " ", "angles", " ", "using", 
        " ", "transformation", " ", "matrices"}], ";", "\[IndentingNewLine]", 
       "   ", 
       StyleBox[
        RowBox[{"Input", " ", "parameters"}],
        FontVariations->{"Underline"->True}], ";", "\[IndentingNewLine]", 
       "   ", 
       RowBox[{
        StyleBox["d",
         FontSlant->"Italic"], ":", " ", 
        StyleBox[
         RowBox[{"distances", "       ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", "[", "i", "]"}], " ", "=", " ", 
            RowBox[{"norm", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "-", 
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "-", "1"}], "]"}], "]"}]}], ")"}]}]}], ")"}]}],
         FontWeight->"Plain"]}], 
       StyleBox[";",
        FontWeight->"Plain"], 
       StyleBox[
        RowBox[{
         StyleBox["    ",
          FontWeight->"Plain"], "        "}]], "\[IndentingNewLine]", "   ", 
       RowBox[{
        StyleBox["\[Theta]",
         FontSlant->"Italic"], ":", " ", 
        StyleBox[
         RowBox[{"planar", " ", "angles", "   ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "i", "]"}], " ", "=", " ", 
            RowBox[{"angle", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"x", "[", "i", "]"}], ",", 
               RowBox[{"x", "[", 
                RowBox[{"i", "-", "1"}], "]"}], ",", 
               RowBox[{"x", "[", 
                RowBox[{"i", "-", "2"}], "]"}]}], ")"}]}]}], ")"}]}],
         FontWeight->"Plain"]}], 
       StyleBox[";",
        FontWeight->"Plain"], 
       StyleBox["        ",
        FontWeight->"Plain"], "\[IndentingNewLine]", "   ", 
       RowBox[{
        StyleBox["\[Omega]",
         FontSlant->"Italic"], ":", " ", 
        RowBox[{
         StyleBox["dihedral",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox["angles",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         RowBox[{
          StyleBox["(",
           FontWeight->"Plain"], 
          StyleBox[
           RowBox[{
            RowBox[{
             RowBox[{"\[Omega]", "[", "i", "]"}], " ", "=", " ", 
             RowBox[{"angle", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x", "[", "i", "]"}], ",", 
                RowBox[{"x", "[", 
                 RowBox[{"i", "-", "1"}], "]"}], ",", 
                RowBox[{"x", "[", 
                 RowBox[{"i", "-", "2"}], "]"}], ",", 
                RowBox[{"x", "[", 
                 RowBox[{"i", "-", "3"}], "]"}]}], ")"}]}]}], ";"}],
           FontWeight->"Plain"], 
          StyleBox[" ",
           FontWeight->"Plain"], "\[IndentingNewLine]"}]}]}]}]}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "B", ",", "B1", ",", "B2", ",", "B3", ",", "X", ",", "i", ",", "di", 
        ",", "ct", ",", "st", ",", "cw", ",", "sw", ",", "v", ",", 
        "numberOfAtoms"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"numberOfAtoms", "=", 
        RowBox[{"Length", "[", "d", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "atoms", " ", "positions", " ", "on", " ", "Euclidean", " ", "3", "d",
          " ", "space"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"X", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "numberOfAtoms"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "set", " ", "the", " ", "position", " ", "of", " ", "the", " ", 
         "three", " ", "first", " ", "points"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ct", ",", "st"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Sin", "[", 
           RowBox[{"\[Theta]", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"d", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", "0", ",", "0"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"d", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"d", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "ct"}]}], ",", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "st"}], " ", ",", "0"}], 
           "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "first", " ", "transformation", " ", "matrices"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"B1", "=", 
        RowBox[{"IdentityMatrix", "[", "4", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"B2", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0", ",", "0", ",", 
            RowBox[{"-", 
             RowBox[{"d", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"di", "=", 
        RowBox[{"d", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"B3", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "ct"}], ",", 
            RowBox[{"-", "st"}], ",", "0", ",", 
            RowBox[{
             RowBox[{"-", "di"}], "*", "ct"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"st", ",", 
            RowBox[{"-", "ct"}], ",", "0", ",", 
            RowBox[{"di", "*", "st"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "remaining", " ", "coordinates"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"B", "=", 
        RowBox[{"B1", ".", "B2", ".", "B3"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "4"}], ",", 
         RowBox[{"i", "\[LessEqual]", "numberOfAtoms"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ct", ",", "st"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Theta]", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Theta]", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"cw", ",", "sw"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"\[Omega]", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Omega]", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"di", "=", 
           RowBox[{"d", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"concatenate", " ", "transformation", " ", "matrices"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"B", " ", "=", 
           RowBox[{"B", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "ct"}], ",", 
                RowBox[{"-", "st"}], ",", "0", ",", 
                RowBox[{
                 RowBox[{"-", "di"}], "*", "ct"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"st", "*", "cw"}], ",", 
                RowBox[{
                 RowBox[{"-", "ct"}], "*", "cw"}], ",", 
                RowBox[{"-", "sw"}], ",", 
                RowBox[{"di", "*", "st", "*", "cw"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"st", "*", "sw"}], ",", 
                RowBox[{
                 RowBox[{"-", "ct"}], "*", "sw"}], ",", "cw", ",", 
                RowBox[{"di", "*", "st", "*", "sw"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], 
             "}"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"apply", " ", "transformation", " ", "at", " ", "origin"}],
            " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"v", " ", "=", 
           RowBox[{"B", ".", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"update", " ", "coordinate"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"v", "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "X", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenerateRandom3DBackbone", "[", 
     RowBox[{"numberOfAtoms_", ",", 
      RowBox[{"algorithm_:", "\"\<HomogeneousCoords\>\""}], ",", 
      RowBox[{"seed_:", "0"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{
      "Generates", " ", "a", " ", "random", " ", "backbone", " ", "in", " ", 
       "tridimensional", " ", "Euclidean", " ", "space"}], ";", 
      "\[IndentingNewLine]", "   ", 
      StyleBox[
       RowBox[{"Input", " ", "parameters"}],
       FontVariations->{"Underline"->True}], 
      StyleBox[";",
       FontVariations->{"Underline"->True}], "\[IndentingNewLine]", "   ", 
      RowBox[{
       StyleBox["numberOfAtoms",
        FontSlant->"Italic"], ":", " ", 
       StyleBox[
        RowBox[{
        "number", " ", "of", " ", "3", "D", " ", "Euclidean", " ", "points", 
         " ", "to", " ", "be", " ", "generated"}],
        FontWeight->"Plain"]}], 
      StyleBox[";",
       FontWeight->"Plain"], "\[IndentingNewLine]", "   ", 
      RowBox[{
       StyleBox["algorithm",
        FontSlant->"Italic"], ":", " ", 
       StyleBox[
        RowBox[{
        "algorithm", " ", "to", " ", "be", " ", "applied", " ", "during", " ",
          "coordinates", " ", 
         RowBox[{"calculation", ".", " ", "The"}], " ", 
         RowBox[{"options", " ", "'"}], "are", " ", 
         RowBox[{"HomogeneousCoords", "'"}], " ", 
         RowBox[{"or", " ", "'"}], 
         RowBox[{"CartesianSystem", "'"}]}],
        FontWeight->"Plain"]}], 
      StyleBox[";",
       FontWeight->"Plain"], "\[IndentingNewLine]", "   ", 
      RowBox[{
       RowBox[{
        StyleBox["seed",
         FontSlant->"Italic"], ":", " ", 
        StyleBox[
         RowBox[{
         "integer", " ", "number", " ", "used", " ", "to", " ", "reproduce", 
          " ", "random", " ", "sequence", " ", 
          RowBox[{"generation", ".", " ", "If"}], " ", "seed"}],
         FontWeight->"Plain"]}], 
       StyleBox["=",
        FontWeight->"Plain"], 
       StyleBox[
        RowBox[{
        "0", " ", "a", " ", "sequence", " ", "based", " ", "on", " ", "the", 
         " ", "current", " ", "time", " ", "is", " ", "constructed"}],
        FontWeight->"Plain"]}], 
      StyleBox[";",
       FontWeight->"Plain"]}], "\[IndentingNewLine]", " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"declare", " ", "the", " ", "local", " ", "variables"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "d", ",", "\[Theta]", ",", "\[Omega]", ",", "X", ",", "output", ",", 
        RowBox[{"\[Epsilon]", "=", "0.05"}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"set", " ", "seed"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"seed", ">", "0"}], ",", 
         RowBox[{"SeedRandom", "[", "seed", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"length", " ", "of", " ", "covalent", " ", "bonds"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"1.526", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", "0"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"plane", " ", "angles"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"\[Theta]", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"1.91", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Theta]", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"torsion", " ", "angles"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"\[Omega]", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"RandomChoice", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"60", "Degree"}], ",", 
              RowBox[{"180", "Degree"}], ",", 
              RowBox[{"300", "Degree"}]}], "}"}], "]"}], "*", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"RandomReal", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "\[Epsilon]"}], ",", "\[Epsilon]"}], "}"}], 
              "]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Omega]", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "set", " ", "the", " ", "remaining", " ", "3", "d", " ", 
         "positions"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "algorithm", ",", "\[IndentingNewLine]", "\"\<HomogeneousCoords\>\"", 
         ",", 
         RowBox[{"X", "=", 
          RowBox[{"SetPositionUsingHomogeneousCoords", "[", 
           RowBox[{"d", ",", "\[Theta]", ",", "\[Omega]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\"\<CartesianSystem\>\"", ",", 
         RowBox[{"X", "=", 
          RowBox[{"SetPositionUsingCartesianSystem", "[", 
           RowBox[{"d", ",", "\[Theta]", ",", "\[Omega]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "_", ",", 
         RowBox[{"Throw", "[", 
          RowBox[{"\"\<InvalidAlgorithm:\>\"", ",", 
           RowBox[{"OptionValue", "[", "algorithm", "]"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "output"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Points\>\"", "->", "X"}], ",", 
         RowBox[{"\"\<TorsionAngles\>\"", "\[Rule]", "\[Omega]"}], ",", 
         RowBox[{"\"\<CovalentBondLengths\>\"", "->", "d"}], ",", 
         RowBox[{"\"\<PlaneRotationAngles\>\"", "\[Rule]", "\[Theta]"}]}], 
        "|>"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetMatrixDistance", "[", "x_", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Calculates", " ", "the", " ", "complete", " ", "distance", " ", 
      "matrix", " ", "for", " ", "all", " ", "coordinates", " ", 
      RowBox[{"x", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", "in", " ", "the", " ", "array", 
      " ", 
      RowBox[{"x", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "-", 
        RowBox[{"x", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "x", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenerateRandomMDGP", "[", 
     RowBox[{"numberOfAtoms_", ",", 
      RowBox[{"dijMax_:", "5.0"}], ",", 
      RowBox[{"dijPrec_:", "0.0"}], ",", 
      RowBox[{"seed_:", "0"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Generates", " ", "a", " ", "random", " ", "DMDGP", " ", 
       RowBox[{"instance", "."}]}], ";", " ", "\[IndentingNewLine]", "   ", 
      RowBox[{
       RowBox[{
        StyleBox["numberOfAtoms",
         FontSlant->"Italic"], ":", " ", 
        RowBox[{
         StyleBox["number",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox["of",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox["3",
          FontWeight->"Plain"], 
         StyleBox["D",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox["Euclidean",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox["points",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox["to",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox["be",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox["generated",
          FontWeight->"Plain"], 
         StyleBox["\[IndentingNewLine]",
          FontWeight->"Plain"], 
         StyleBox["dijMax",
          FontSlant->"Italic"]}], ":", 
        StyleBox[" ",
         FontWeight->"Plain"], 
        RowBox[{
         StyleBox["all",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox["distances",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox["greater",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox["than",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox["dijMax",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox["are",
          FontWeight->"Plain"], 
         StyleBox[" ",
          FontWeight->"Plain"], 
         StyleBox["dropped",
          FontWeight->"Plain"], 
         StyleBox["\[IndentingNewLine]",
          FontWeight->"Plain"], 
         RowBox[{
          StyleBox["dijPrec",
           FontSlant->"Italic"], 
          StyleBox[":",
           FontWeight->"Plain"], 
          StyleBox[" ",
           FontWeight->"Plain"], 
          StyleBox[
           RowBox[{
            RowBox[{"the", " ", "upper", " ", 
             RowBox[{"(", "uij", ")"}], " ", "and", " ", "lower", " ", 
             RowBox[{"(", "lij", ")"}], " ", "constraints", " ", "boundaries",
              " ", "are"}], " ", "\[IndentingNewLine]", 
            RowBox[{
            "generated", " ", "using", " ", "the", " ", "formulae", " ", 
             "lij"}]}],
           FontWeight->"Plain"]}]}]}], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox["=",
        FontWeight->"Plain"], 
       StyleBox[" ",
        FontWeight->"Plain"], 
       StyleBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "dijPrec"}], ")"}], " ", "and", " ", "uij"}], 
         " ", "=", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "dijPrec"}], ")"}]}],
        FontWeight->"Plain"]}], 
      StyleBox[";",
       FontWeight->"Plain"], 
      StyleBox[" ",
       FontWeight->"Plain"], "\[IndentingNewLine]", "   ", 
      RowBox[{
       StyleBox["algorithm",
        FontSlant->"Italic"], ":", " ", 
       StyleBox[
        RowBox[{
         RowBox[{"defines", " ", "the", " ", "method", " ", 
          RowBox[{"(", "algorithm", ")"}], " ", "used", " ", "to", " ", 
          "calculate", " ", "the", " ", "pairwise"}], "\[IndentingNewLine]", 
         "   ", 
         RowBox[{
          RowBox[{"distances", ".", " ", "The"}], " ", "options", " ", "are", 
          " ", "\"\<DistanceMatrix\>\"", " ", "and", " ", 
          "\"\<Nearest\>\""}]}],
        FontWeight->"Plain"]}], 
      StyleBox[";",
       FontWeight->"Plain"], "\[IndentingNewLine]", "   ", 
      RowBox[{
       RowBox[{
        StyleBox["seed",
         FontSlant->"Italic"], ":", " ", 
        StyleBox[
         RowBox[{
          RowBox[{
          "integer", " ", "number", " ", "used", " ", "to", " ", "reproduce", 
           " ", "random", " ", "sequence", " ", 
           RowBox[{"generation", ".", " ", "If"}]}], " ", 
          "\[IndentingNewLine]", "  ", "seed"}],
         FontWeight->"Plain"]}], 
       StyleBox["=",
        FontWeight->"Plain"], 
       StyleBox[
        RowBox[{
        "0", " ", "a", " ", "sequence", " ", "based", " ", "on", " ", 
         "current", " ", "is", " ", "constructed"}],
        FontWeight->"Plain"]}], 
      StyleBox[";",
       FontWeight->"Plain"]}], "\[IndentingNewLine]", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"declare", " ", "local", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "j", ",", "k", ",", "X", ",", "G", ",", "D", ",", "N", ",", 
        "E", ",", "dij"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"X", "=", 
        RowBox[{"GenerateRandom3DBackbone", "[", 
         RowBox[{
         "numberOfAtoms", ",", "\"\<HomogeneousCoords\>\"", ",", "seed"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"D", "=", 
        RowBox[{"DistanceMatrix", "[", 
         RowBox[{"X", "[", "\"\<Points\>\"", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"G", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"And", "[", 
             RowBox[{
              RowBox[{"0", "<", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], "\[LessEqual]", "dijMax"}]}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", "Infinity"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "numberOfAtoms"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"G", "=", 
        RowBox[{"WeightedAdjacencyGraph", "[", "G", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "distance", " ", "bounds"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"E", "=", 
        RowBox[{"EdgeList", "[", "G", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "\[LessEqual]", 
          RowBox[{"Length", "[", "E", "]"}]}], ",", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"i", "=", 
             RowBox[{
              RowBox[{"E", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{"j", "=", 
             RowBox[{
              RowBox[{"E", "[", 
               RowBox[{"[", "k", "]"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"dij", "=", 
           RowBox[{"GetEdgeWeight", "[", 
            RowBox[{"G", ",", 
             RowBox[{"E", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"i", "-", "j"}], "]"}], ">", "2"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"imprecise", " ", "distance"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"PropertyValue", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"G", ",", 
                 RowBox[{"i", "\[UndirectedEdge]", "j"}]}], "}"}], ",", 
               "\"\<DistanceBounds\>\""}], "]"}], "=", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "dijPrec"}], ")"}], ",", 
                RowBox[{"(", 
                 RowBox[{"1", "+", "dijPrec"}], ")"}]}], "}"}], "*", 
              "dij"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"exact", " ", "distance"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"PropertyValue", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"G", ",", 
                 RowBox[{"i", "\[UndirectedEdge]", "j"}]}], "}"}], ",", 
               "\"\<DistanceBounds\>\""}], "]"}], "=", 
             RowBox[{"{", 
              RowBox[{"dij", ",", "dij"}], "}"}]}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<X\>\"", "->", "X"}], ",", 
          RowBox[{"\"\<G\>\"", "->", "G"}]}], "|>"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalculateProteinAngles", "[", 
     RowBox[{"A_", ",", "B_", ",", "C_", ",", "D_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Calculates", " ", "the", " ", "protein", " ", "angles", " ", 
       RowBox[{"(", 
        RowBox[{"plane", " ", "and", " ", "torsion"}], ")"}], " ", "for", " ",
        "3", "D", " ", "points", " ", "A"}], ",", " ", "B", ",", " ", 
      RowBox[{"C", " ", "and", " ", "D", " ", "in", " ", "that", " ", 
       RowBox[{"order", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Calculate", " ", "the", " ", "plane", " ", "and", " ", "torsion", " ", 
       "angles", " ", "for", " ", "X4"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nabc", ",", " ", "nbcd", ",", "\[Theta]", ",", "\[Omega]"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"centered", " ", "at", " ", "C"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Theta]", "=", 
        RowBox[{"VectorAngle", "[", 
         RowBox[{
          RowBox[{"B", "-", "C"}], ",", 
          RowBox[{"D", "-", "C"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<(\[Theta]):Angle[BCD]  =\>\"", ",", "\[Theta]"}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"centered", " ", "at", " ", "B", " ", "and", " ", "C"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nabc", ",", "nbcd"}], "}"}], " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{"A", "-", "B"}], ",", 
            RowBox[{"C", "-", "B"}]}], "]"}], ",", 
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{"B", "-", "C"}], ",", 
            RowBox[{"D", "-", "C"}]}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[Omega]", "=", 
        RowBox[{"VectorAngle", "[", 
         RowBox[{"nabc", ",", "nbcd"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<(\[Omega]):Angle[ABCD] =\>\"", ",", "\[Omega]"}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "\[Omega]"}], "}"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalculateProteinAnglesForAtomAtPosition", "[", 
     RowBox[{"X_", ",", "i_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Calculates", " ", "the", " ", "protein", " ", "angles", " ", 
       RowBox[{"(", 
        RowBox[{"plane", " ", "and", " ", "torsion"}], ")"}], " ", "to", " ", 
       "i"}], "-", 
      RowBox[{"th", " ", 
       RowBox[{"atom", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"CalculateProteinAngles", "[", 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"[", 
        RowBox[{"i", "-", "3"}], "]"}], "]"}], ",", 
      RowBox[{"X", "[", 
       RowBox[{"[", 
        RowBox[{"i", "-", "2"}], "]"}], "]"}], ",", 
      RowBox[{"X", "[", 
       RowBox[{"[", 
        RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", 
      RowBox[{"X", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalculateTorsionAngles", "[", "X_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Theta]", ",", "\[Omega]", ",", "i"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Omega]", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "X", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "4"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "X", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Theta]", ",", 
            RowBox[{"\[Omega]", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "=", 
          RowBox[{"CalculateProteinAnglesForAtomAtPosition", "[", 
           RowBox[{"X", ",", "i"}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "\[Omega]", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsNaturalOrderValid", "[", "G_", "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Checks", " ", "if", " ", "the", " ", "ordering", " ", "assumption", " ",
       "of", " ", "DMDGP", " ", "is", " ", "satisfied", " ", "by", " ", "G", 
      " ", "edges"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"local", " ", "variables"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "4"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", 
           RowBox[{"VertexList", "[", "G", "]"}], "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", "3"}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"FailureQ", "[", 
               RowBox[{"GetEdgeWeight", "[", 
                RowBox[{"G", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"i", "-", "j"}], ")"}], "\[UndirectedEdge]", 
                  "i"}]}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<The edge \>\"", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"i", "-", "j"}], ")"}], "\[UndirectedEdge]", "i"}],
                  ",", "\"\< is missing\>\""}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"Return", "[", "False", "]"}]}]}], "]"}]}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "True", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalculatePartialSolutionError", "[", 
     RowBox[{"G_", ",", "X_", ",", "i_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Calculates", " ", "the", " ", "error", " ", 
      RowBox[{"(", 
       RowBox[{"constraints", " ", "violation"}], ")"}], " ", "on", " ", 
      "the", " ", "substructure", " ", 
      RowBox[{"X", "[", 
       RowBox[{"[", 
        RowBox[{"1", ":", "i"}], "]"}], "]"}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"local", " ", "variables"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "eij", ",", "j", ",", "k", ",", "V", ",", "Xi", ",", "Xj", ",", "Dij", 
        ",", "Lij", ",", "Uij", ",", "errorDij"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"current", " ", "position"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Xi", "=", 
        RowBox[{"X", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "considering", " ", "only", " ", "the", " ", "precedent", " ", 
         "atoms"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"V", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"AdjacencyList", "[", 
           RowBox[{"G", ",", "i"}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", "<", "i"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<V=\>\"", ",", "V"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"errorDij", "=", "0.0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "\[LessEqual]", 
          RowBox[{"Length", "[", "V", "]"}]}], ",", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"neighbor", " ", "index"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"V", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"neighbor", " ", "coordinate"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Xj", "=", 
           RowBox[{"X", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"actual", " ", "distance"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Dij", "=", 
           RowBox[{"EuclideanDistance", "[", 
            RowBox[{"Xi", ",", "Xj"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"distance", " ", "bounds"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Lij", ",", "Uij"}], "}"}], "=", 
           RowBox[{"GetEdgeDistanceBounds", "[", 
            RowBox[{"G", ",", 
             RowBox[{"i", "\[UndirectedEdge]", "j"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"error", " ", "Dij"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"eij", "=", 
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Lij", "-", "Dij"}], ")"}], "/", "Lij"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Dij", "-", "Uij"}], ")"}], "/", "Uij"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"update", " ", "error"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"eij", ">", "errorDij"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"errorDij", "=", "eij"}], ";"}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<i=\>\"", ",", "i", ",", "\"\< j=\>\"", ",", "j", ",", 
               "\"\< Lij=\>\"", ",", "Lij", ",", " ", "\"\< Uij=\>\"", ",", 
               "Uij", ",", " ", "\"\< Dij=\>\"", ",", "Dij", ",", 
               "\"\< eij=\>\"", ",", "errorDij"}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "errorDij", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApplyRotors", "[", 
     RowBox[{"X_", ",", "\[Omega]_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "Y"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Y", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "X", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "4"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "X", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "i"}], ",", 
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"Length", "[", "X", "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Y", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "=", 
             RowBox[{
              RowBox[{"RotationTransform", "[", 
               RowBox[{
                RowBox[{"\[Omega]", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"Y", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "-", "1"}], "]"}], "]"}], "-", 
                 RowBox[{"Y", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", "-", "2"}], "]"}], "]"}]}], ",", 
                RowBox[{"Y", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "]"}], "[", 
              RowBox[{"Y", "[", 
               RowBox[{"[", "j", "]"}], "]"}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Y", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"WriteMDGP", "[", 
     RowBox[{"M_", ",", "fname_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Create", " ", "the", " ", "files", " ", 
       StyleBox[
        RowBox[{"fname", ".", "csv"}],
        FontSlant->"Italic"], 
       StyleBox[" ",
        FontSlant->"Italic"], 
       StyleBox["and",
        FontSlant->"Italic"], 
       StyleBox[" ",
        FontSlant->"Italic"], 
       StyleBox[
        RowBox[{"fname_xsol", ".", "csv"}],
        FontSlant->"Italic"], " ", "with"}], ",", " ", "respectively", ",", 
      " ", 
      RowBox[{
      "the", " ", "MDGP", " ", "constraints", " ", "given", " ", "by", " ", 
       RowBox[{"M", "[", "\"\<G\>\"", "]"}], " ", "and", " ", "the", " ", 
       "associated", " ", "solution", " ", 
       RowBox[{"M", "[", "\"\<X\>\"", "]"}]}]}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "edges", ",", "fid", ",", "table", ",", "eij", ",", "i", ",", "j", ",",
         "k", ",", "X", ",", "G", ",", "Lij", ",", "Uij"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"X", "=", 
        RowBox[{
         RowBox[{"M", "[", "\"\<X\>\"", "]"}], "[", "\"\<Points\>\"", "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"table", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "[", 
           RowBox[{"[", "j", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "X", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"fid", "=", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
         "\"\<C:\\\\Users\\\\Michael\\\\gitrepos\\\\github\\\\bioinfo\\\\\
instances\\\\\>\"", ",", "fname", ",", "\"\<_xsol.csv\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"fid", ",", "table", ",", 
         RowBox[{"TableHeadings", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
           "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"G", "=", 
        RowBox[{"M", "[", "\"\<G\>\"", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"edges", "=", 
        RowBox[{"EdgeList", "[", "G", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"table", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "edges", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "\[LessEqual]", 
          RowBox[{"Length", "[", "edges", "]"}]}], ",", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eij", "=", 
           RowBox[{"edges", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i", ",", "j"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"eij", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"eij", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Lij", ",", "Uij"}], "}"}], "=", 
           RowBox[{"GetEdgeDistanceBounds", "[", 
            RowBox[{"G", ",", "eij"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"table", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "=", 
           RowBox[{"{", 
            RowBox[{"i", ",", "j", ",", "Lij", ",", "Uij"}], "}"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"fid", "=", 
        RowBox[{"StringJoin", "[", 
         RowBox[{
         "\"\<C:\\\\Users\\\\Michael\\\\gitrepos\\\\github\\\\bioinfo\\\\\
instances\\\\\>\"", ",", "fname", ",", "\"\<.csv\>\""}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"fid", ",", "table", ",", 
         RowBox[{"TableHeadings", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<I\>\"", ",", "\"\<J\>\"", ",", "\"\<L\>\"", ",", 
            "\"\<U\>\""}], "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Plot3DBackbone", "[", "X_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Plots", " ", "the", " ", "points", " ", "using", " ", "the", " ", 
     "coordinates", " ", "of", " ", 
     RowBox[{"X", "[", "\"\<Points\>\"", "]"}], " ", "property"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Red", ",", 
         RowBox[{"Tube", "[", "X", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PointSize", "[", "Large", "]"}], ",", "Blue", ",", 
         RowBox[{"Point", "[", 
          RowBox[{"Rest", "[", "X", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PointSize", "[", "Large", "]"}], ",", "Green", ",", 
         RowBox[{"Point", "[", 
          RowBox[{"First", "[", "X", "]"}], "]"}]}], "}"}]}], "}"}], ",", " ", 
     RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotAdjacencyMatrix", "[", 
    RowBox[{"G_", ",", 
     RowBox[{"DiagonalCovering_:", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "j", ",", "n", ",", "ei", ",", "ej", ",", "edges", ",", 
       "primitives", ",", "add"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"VertexList", "[", "G", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"edges", "=", 
       RowBox[{"EdgeList", "[", "G", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"inverting", " ", "edges", " ", "position"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"edges", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"edges", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], ",", 
           RowBox[{"n", "-", 
            RowBox[{
             RowBox[{"edges", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "edges", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"primitives", "=", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "[", "Medium", "]"}], ",", 
           RowBox[{"Point", "[", "edges", "]"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"Red", ",", "Dashed", ",", 
           RowBox[{"Line", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", "n"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"n", ",", "1"}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
        "\[IndentingNewLine]", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Plot", " ", "diagonal", " ", "covering"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{"DiagonalCovering", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Length", "[", "edges", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"add", "=", "True"}], ";", "\[IndentingNewLine]", 
            RowBox[{"ei", "=", 
             RowBox[{"edges", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"j", "=", "1"}], ",", 
              RowBox[{"j", "\[LessEqual]", 
               RowBox[{"Length", "[", "edges", "]"}]}], ",", 
              RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"ej", "=", 
                RowBox[{"edges", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ej", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "==", 
                    RowBox[{"ei", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "&&", 
                   RowBox[{
                    RowBox[{"ej", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ">", 
                    RowBox[{"ei", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], ",", 
                 RowBox[{"add", "=", "False"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"ej", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "==", 
                    RowBox[{"ei", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "&&", 
                   RowBox[{
                    RowBox[{"ej", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ">", 
                    RowBox[{"ei", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], ",", 
                 RowBox[{"add", "=", "False"}]}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"add", ",", "\[IndentingNewLine]", 
              RowBox[{"PrependTo", "[", 
               RowBox[{"primitives", ",", "\[IndentingNewLine]", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Opacity", "[", "0.2", "]"}], ",", "Red", ",", 
                  RowBox[{"Triangle", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"ei", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"n", "+", "1", "-", 
                    RowBox[{"ei", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], ",", "ei", ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"n", "+", "1", "-", 
                    RowBox[{"ei", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                    RowBox[{"ei", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], "]"}]}],
                  "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{"primitives", ",", "\[IndentingNewLine]", 
        RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"GridLines", "\[Rule]", "Automatic"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Ticks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"n", "+", "1", "-", "i"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"AxesOrigin", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.679334396696954*^9, 3.6793344197378874`*^9}, {
   3.679334459021727*^9, 3.6793344614910192`*^9}, {3.679334506573509*^9, 
   3.67933450744427*^9}, 3.679334554859289*^9, {3.6793347748775415`*^9, 
   3.6793348146727505`*^9}, {3.6793348683176303`*^9, 
   3.6793349148147354`*^9}, {3.679335216182414*^9, 3.679335270449379*^9}, {
   3.679335358320606*^9, 3.6793353855927134`*^9}, {3.679335422113183*^9, 
   3.679335422860292*^9}, {3.679335467322652*^9, 3.6793354718670073`*^9}, {
   3.679335502941807*^9, 3.6793355176517873`*^9}, {3.6793359308181715`*^9, 
   3.6793359602458916`*^9}, {3.6793359984610925`*^9, 3.679336011029911*^9}, {
   3.679336355941925*^9, 3.679336390681263*^9}, {3.679336436703087*^9, 
   3.679336440913059*^9}, {3.6793364973777227`*^9, 3.679336508943397*^9}, {
   3.679337482798051*^9, 3.6793374878195066`*^9}, {3.679337531710136*^9, 
   3.679337679993342*^9}, {3.679337711180924*^9, 3.6793377943636985`*^9}, {
   3.679337830273183*^9, 3.6793379235522385`*^9}, {3.6793380600889235`*^9, 
   3.679338107718841*^9}, {3.679338168311281*^9, 3.6793381690922422`*^9}, {
   3.679338254307039*^9, 3.679338327393572*^9}, {3.6793384127916727`*^9, 
   3.679338418720523*^9}, {3.6793384657072325`*^9, 3.679338788372825*^9}, {
   3.679338898441475*^9, 3.6793389990638256`*^9}, {3.6793390477861385`*^9, 
   3.679339051499843*^9}, {3.6793391446277075`*^9, 3.6793392599804153`*^9}, 
   3.6793393742092657`*^9, {3.6793395780321927`*^9, 3.6793398587893867`*^9}, {
   3.6793398957561593`*^9, 3.6793399605794096`*^9}, {3.67934000207397*^9, 
   3.6793400630782733`*^9}, {3.6793401514655437`*^9, 
   3.6793403347497687`*^9}, {3.6793403699550896`*^9, 3.67934037140318*^9}, {
   3.679340563130898*^9, 3.6793405841237473`*^9}, {3.6793406189939303`*^9, 
   3.6793406823092556`*^9}, {3.6793413087872534`*^9, 
   3.6793413117913976`*^9}, {3.6793414144409704`*^9, 
   3.6793414780425982`*^9}, {3.6793415857352*^9, 3.679341749056054*^9}, {
   3.6793418327409945`*^9, 3.6793418417524166`*^9}, {3.679341876481241*^9, 
   3.6793418824052687`*^9}, {3.679341997125859*^9, 3.6793420172739105`*^9}, {
   3.67934205563032*^9, 3.6793420821291895`*^9}, {3.679342117275077*^9, 
   3.6793421196924405`*^9}, {3.6793421834981775`*^9, 3.679342183855644*^9}, {
   3.6793422500684495`*^9, 3.6793422840007253`*^9}, {3.6793424043195424`*^9, 
   3.6793424350150757`*^9}, {3.679342585125659*^9, 3.679342801705634*^9}, {
   3.679342833323803*^9, 3.6793428396110015`*^9}, {3.6793429405557547`*^9, 
   3.6793429972575336`*^9}, {3.679343068573412*^9, 3.6793430980621653`*^9}, 
   3.6793431423230133`*^9, {3.6793431858227177`*^9, 3.6793432209529057`*^9}, {
   3.6793432860551014`*^9, 3.6793433042354126`*^9}, {3.6793433545087633`*^9, 
   3.6793433652364955`*^9}, {3.6793452969963503`*^9, 3.6793453088097954`*^9}, 
   3.6793461153501606`*^9, {3.6793473536334457`*^9, 3.6793473954665585`*^9}, {
   3.6793477301073675`*^9, 3.679347763333604*^9}, {3.6793478591437263`*^9, 
   3.6793478625984306`*^9}, {3.6793480121537013`*^9, 
   3.6793482720333853`*^9}, {3.67934834772797*^9, 3.6793483523074236`*^9}, {
   3.6793484687244396`*^9, 3.679348489631818*^9}, {3.679348535732118*^9, 
   3.6793485836744003`*^9}, {3.679348656480409*^9, 3.6793486600900903`*^9}, 
   3.6793492489231615`*^9, {3.6793494190708942`*^9, 3.679349419296319*^9}, 
   3.6793494823993444`*^9, {3.6793500975888023`*^9, 3.6793501010398235`*^9}, {
   3.6793503502988024`*^9, 3.679350357442238*^9}, {3.679350388693789*^9, 
   3.6793504609919558`*^9}, {3.679350512381988*^9, 3.6793505224916997`*^9}, {
   3.6793505658690414`*^9, 3.679350573203977*^9}, {3.6793920543569756`*^9, 
   3.6793923209393916`*^9}, {3.679392352626535*^9, 3.6793925381168537`*^9}, {
   3.6793926280473437`*^9, 3.679392661685611*^9}, {3.679392696383786*^9, 
   3.679392699025669*^9}, {3.6793928383564887`*^9, 3.6793934549091573`*^9}, {
   3.679393586505351*^9, 3.679393616703784*^9}, {3.6793939133345203`*^9, 
   3.6793939143222685`*^9}, 3.6793940696010857`*^9, {3.679394099668668*^9, 
   3.6793944506348133`*^9}, {3.679394784056423*^9, 3.67939534176003*^9}, {
   3.679395381425836*^9, 3.679395503566868*^9}, {3.6793955684350924`*^9, 
   3.6793955734567842`*^9}, {3.6793957804079714`*^9, 
   3.6793958367041416`*^9}, {3.6793960807594223`*^9, 3.679396100513118*^9}, {
   3.67939616157646*^9, 3.679396197364892*^9}, {3.6793962497184567`*^9, 
   3.679396282906206*^9}, {3.679396609090597*^9, 3.6793966167836933`*^9}, {
   3.679396648625914*^9, 3.6793966543985653`*^9}, {3.679396740943916*^9, 
   3.679396768582145*^9}, {3.679396857866257*^9, 3.6793968963813653`*^9}, {
   3.6793969336171*^9, 3.6793970905785065`*^9}, {3.6793971251566105`*^9, 
   3.6793971298515577`*^9}, {3.679397221304947*^9, 3.67939722410863*^9}, {
   3.6793972641763353`*^9, 3.679397266225936*^9}, {3.6793983203128195`*^9, 
   3.6793983706649785`*^9}, {3.679398435449253*^9, 3.6793984477299423`*^9}, {
   3.6793984907409554`*^9, 3.6793985421648207`*^9}, {3.679398593771634*^9, 
   3.6793986705180993`*^9}, {3.6793989235435977`*^9, 3.67939893434542*^9}, {
   3.679403394164427*^9, 3.6794034018166647`*^9}, {3.679403783825127*^9, 
   3.6794037864835734`*^9}, {3.6794038759602175`*^9, 
   3.6794040830475106`*^9}, {3.679404119305796*^9, 3.679404298238202*^9}, 
   3.679404382036023*^9, {3.679404653274694*^9, 3.6794046842305584`*^9}, {
   3.6794050293859835`*^9, 3.6794050557043276`*^9}, {3.6794051146048007`*^9, 
   3.679405116722584*^9}, {3.679405184367193*^9, 3.6794052171029243`*^9}, {
   3.679405498432304*^9, 3.679405569807764*^9}, {3.679405690984426*^9, 
   3.6794056940269375`*^9}, {3.679405754352635*^9, 3.6794057624882355`*^9}, 
   3.679405828952403*^9, {3.6794059773823776`*^9, 3.679406037058329*^9}, {
   3.679406078458248*^9, 3.6794061638320656`*^9}, {3.6794064355972614`*^9, 
   3.679406619068183*^9}, {3.67940666239577*^9, 3.679406687383835*^9}, {
   3.679406724763648*^9, 3.6794067251687045`*^9}, 3.6794068172515316`*^9, {
   3.679406863506428*^9, 3.679406872901106*^9}, {3.679406930446825*^9, 
   3.679406948401491*^9}, {3.6794070040861063`*^9, 3.6794070065561094`*^9}, {
   3.679407312344544*^9, 3.679407314713808*^9}, {3.679407430180848*^9, 
   3.679407458271701*^9}, 3.6794078238766403`*^9, {3.679407878354503*^9, 
   3.6794082035777364`*^9}, {3.679566685353998*^9, 3.67956669759547*^9}, 
   3.679568153295287*^9, {3.6795682979748397`*^9, 3.679568399913588*^9}, {
   3.679568451510522*^9, 3.679568495166552*^9}, {3.6795691795206947`*^9, 
   3.679569250499019*^9}, {3.679569280716798*^9, 3.6795693785712852`*^9}, {
   3.6795925633128986`*^9, 3.679592673970081*^9}, {3.679592721867278*^9, 
   3.6795927229374475`*^9}, {3.679594988131906*^9, 3.679595118982105*^9}, {
   3.679738892130002*^9, 3.679738904422254*^9}, {3.6797389527800984`*^9, 
   3.6797389661620564`*^9}, {3.6797390238401327`*^9, 
   3.6797390636940556`*^9}, {3.6797391569629755`*^9, 3.679739218024413*^9}, {
   3.679739321633385*^9, 3.6797393341911097`*^9}, {3.6797394358016376`*^9, 
   3.679739498369319*^9}, {3.679739592363925*^9, 3.6797396087330103`*^9}, {
   3.6797405277538753`*^9, 3.6797405906735935`*^9}, {3.679741837482974*^9, 
   3.679741856061937*^9}, {3.6797530753347263`*^9, 3.679753080740266*^9}, {
   3.679822610411623*^9, 3.6798226951736937`*^9}, {3.6798262757554946`*^9, 
   3.6798262950500765`*^9}, {3.6798304972475395`*^9, 3.679830500587058*^9}, {
   3.6798305863580213`*^9, 3.6798306115801296`*^9}, {3.679830653827534*^9, 
   3.679830659160823*^9}, {3.679830750679475*^9, 3.679830778729604*^9}, {
   3.6798309380103083`*^9, 3.679831207376337*^9}, {3.6798312397643733`*^9, 
   3.6798313536889253`*^9}, {3.6798313849934535`*^9, 3.679831403721264*^9}, {
   3.6798314534696703`*^9, 3.6798315710288057`*^9}, {3.6798316592417555`*^9, 
   3.6798317372267046`*^9}, 3.679831789061343*^9, {3.679831822090675*^9, 
   3.679831828828328*^9}, {3.6798318972804823`*^9, 3.6798319051885147`*^9}, {
   3.679831945915737*^9, 3.6798319534838204`*^9}, {3.679831984167186*^9, 
   3.679831996593215*^9}, {3.6798321399538794`*^9, 3.6798321522301235`*^9}, {
   3.6798322802409973`*^9, 3.6798322901002426`*^9}, {3.679832475527353*^9, 
   3.6798324791745257`*^9}, {3.679832515937626*^9, 3.6798325272304134`*^9}, {
   3.6798328341287575`*^9, 3.6798328453074446`*^9}, {3.679832936913255*^9, 
   3.6798329499211493`*^9}, 3.6798329836635427`*^9, 3.6799120745739098`*^9, {
   3.68096946640281*^9, 3.680969506471238*^9}, {3.6809695943663626`*^9, 
   3.6809695983006277`*^9}, {3.680971291386725*^9, 3.680971292487916*^9}, {
   3.6810483453596783`*^9, 3.6810483658374515`*^9}, {3.681049666557871*^9, 
   3.681049672721483*^9}, {3.681049746015087*^9, 3.6810497473331203`*^9}, {
   3.681050036116782*^9, 3.6810503893437195`*^9}, {3.681050439415736*^9, 
   3.681050443570201*^9}, {3.6810508388119097`*^9, 3.681050853163069*^9}, {
   3.6810508894027395`*^9, 3.681050893808611*^9}, {3.681050960791823*^9, 
   3.6810510981120815`*^9}, {3.68105113216866*^9, 3.6810511668364615`*^9}, {
   3.681051291204856*^9, 3.6810512973216534`*^9}, {3.681051343040867*^9, 
   3.6810513458639803`*^9}, {3.6810514354795513`*^9, 
   3.6810514424265547`*^9}, {3.6810515295113626`*^9, 3.681051567230074*^9}, 
   3.681051692501606*^9, {3.681051791144629*^9, 3.681051837795389*^9}, {
   3.6810519974251823`*^9, 3.6810521036048183`*^9}, {3.681052180564599*^9, 
   3.6810521932444377`*^9}, {3.681052498724401*^9, 3.6810525317013626`*^9}, {
   3.681052601514738*^9, 3.6810526020129356`*^9}, {3.681130097135313*^9, 
   3.6811301355329266`*^9}, {3.6811306071661057`*^9, 
   3.6811306080939198`*^9}, {3.681569293340601*^9, 3.681569317434729*^9}, 
   3.681569384549055*^9, {3.6815694300305977`*^9, 3.6815694757801313`*^9}, {
   3.681569563306698*^9, 3.681569588540775*^9}, {3.6827030876800084`*^9, 
   3.682703262424608*^9}, {3.6827033351522703`*^9, 3.682703415951787*^9}, {
   3.6827036928979535`*^9, 3.6827037232224236`*^9}, {3.682751730525303*^9, 
   3.6827517963283806`*^9}, {3.6827518694423895`*^9, 3.682751938368969*^9}, {
   3.682752027328513*^9, 3.682752222908455*^9}, {3.6827522575518446`*^9, 
   3.682752305498808*^9}, {3.682752343269593*^9, 3.682752354684014*^9}, {
   3.682755918271523*^9, 3.6827559318206263`*^9}, {3.6827559727179627`*^9, 
   3.682756087687999*^9}, {3.682756145721592*^9, 3.682756179708579*^9}, {
   3.6827562427576885`*^9, 3.682756246343544*^9}, {3.6827562838961797`*^9, 
   3.682756361155776*^9}, {3.6827564050716653`*^9, 3.682756407820393*^9}, {
   3.6827568065792284`*^9, 3.682756817610793*^9}, {3.6827569799864893`*^9, 
   3.682757046769945*^9}, {3.6827571010926585`*^9, 3.68275714115174*^9}, 
   3.6827572933922772`*^9, {3.682757377968191*^9, 3.6827573780054502`*^9}, {
   3.682757430656029*^9, 3.682757430938339*^9}, {3.682757538765318*^9, 
   3.6827575688045273`*^9}, {3.6827576062534266`*^9, 
   3.6827577481318636`*^9}, {3.6827581645482197`*^9, 
   3.6827581925304317`*^9}, {3.6827582367544127`*^9, 
   3.6827582371612177`*^9}, {3.682758608097464*^9, 3.682758623028547*^9}, {
   3.6827587073678665`*^9, 3.682758772728657*^9}, {3.682758834124054*^9, 
   3.682758836456462*^9}, {3.682782233662289*^9, 3.6827822447829604`*^9}, {
   3.682782320018792*^9, 3.682782487834862*^9}, {3.682782529947446*^9, 
   3.6827825314122334`*^9}, {3.682782623878173*^9, 3.6827826814501777`*^9}, {
   3.6827827337311916`*^9, 3.682782750069191*^9}, {3.682782896362369*^9, 
   3.6827828993756037`*^9}, {3.6827829353820267`*^9, 3.682782936614396*^9}, {
   3.6827852963565493`*^9, 3.6827852984977875`*^9}, {3.6827871345324674`*^9, 
   3.6827871372960124`*^9}, {3.6827873158456683`*^9, 3.682787318082534*^9}, 
   3.6860539435781755`*^9, {3.689601466774104*^9, 3.6896015532256894`*^9}, {
   3.6896016488772197`*^9, 3.6896017962777505`*^9}, {3.689601830847403*^9, 
   3.689601843970112*^9}, {3.689601972787878*^9, 3.689601987554659*^9}, {
   3.6896020823447723`*^9, 3.689602177412902*^9}, {3.689602219625367*^9, 
   3.6896025123406606`*^9}, {3.689602553886554*^9, 3.689602618506301*^9}, {
   3.6896026500310593`*^9, 3.6896026586156025`*^9}, {3.6896026945036297`*^9, 
   3.6896028712580557`*^9}, {3.6896029047014227`*^9, 
   3.6896029083520837`*^9}, {3.689602966711435*^9, 3.689603058571074*^9}, {
   3.6896030932120867`*^9, 3.689603098139574*^9}, {3.6896031601944327`*^9, 
   3.6896031778706956`*^9}, {3.692621083267871*^9, 3.692621091669281*^9}, {
   3.6926212289569902`*^9, 3.6926212863157787`*^9}, {3.6926213497820015`*^9, 
   3.692621425637977*^9}, {3.6926214644408817`*^9, 3.6926214670573387`*^9}, {
   3.692621527200048*^9, 3.6926216897906265`*^9}, {3.692627410197031*^9, 
   3.6926275455290575`*^9}, {3.692627745145838*^9, 3.6926277852211*^9}, {
   3.692627821712092*^9, 3.692627853727536*^9}, {3.693051401128996*^9, 
   3.693051427295449*^9}, {3.6930549156980915`*^9, 3.6930551127231016`*^9}, {
   3.6930552622573557`*^9, 3.693055266815773*^9}, {3.693055339369998*^9, 
   3.693055342949571*^9}, {3.6930554341310496`*^9, 3.693055503513935*^9}, {
   3.6930556414092984`*^9, 3.693055671403966*^9}, {3.6930558447268047`*^9, 
   3.693055926052605*^9}, {3.69305610697759*^9, 3.693056188778535*^9}, {
   3.6930563054950542`*^9, 3.6930563090177827`*^9}, {3.693056360765195*^9, 
   3.693056364987186*^9}, {3.693056410841975*^9, 3.6930564674928303`*^9}, {
   3.693056544238221*^9, 3.6930565494853306`*^9}, {3.6930566103966265`*^9, 
   3.6930566475710416`*^9}, {3.693056687192659*^9, 3.6930566953123307`*^9}, {
   3.6930567877264233`*^9, 3.6930568950334253`*^9}, {3.6930570764514155`*^9, 
   3.693057081922228*^9}, {3.6930571431816697`*^9, 3.6930572655759053`*^9}, {
   3.693057312085458*^9, 3.6930573768320684`*^9}, {3.6930574682013035`*^9, 
   3.693057478075393*^9}, {3.6932296110918107`*^9, 3.6932296491465197`*^9}, {
   3.6932296904250884`*^9, 3.6932297134186444`*^9}, {3.693229748263383*^9, 
   3.6932297809611044`*^9}, {3.6932308110630655`*^9, 3.693230887986189*^9}, 
   3.693231311160925*^9, {3.6932313870086255`*^9, 3.693231387261767*^9}, {
   3.693300257298705*^9, 3.693300990881487*^9}, {3.6933010948551283`*^9, 
   3.6933011038372164`*^9}, {3.6933011352536983`*^9, 3.693301291501009*^9}, {
   3.693301360678998*^9, 3.693301846650869*^9}, {3.6933018835332117`*^9, 
   3.6933019831666975`*^9}, {3.6933020216715317`*^9, 3.693302099051983*^9}, {
   3.6933021369545527`*^9, 3.6933023594457426`*^9}, {3.693315004372259*^9, 
   3.693315011074277*^9}, {3.6944413361908827`*^9, 3.694441336907129*^9}, {
   3.6950542188467774`*^9, 3.695054222592431*^9}, {3.6950542990197506`*^9, 
   3.695054307656605*^9}, {3.695055223340433*^9, 3.695055253120858*^9}, {
   3.695055384838611*^9, 3.6950553878557982`*^9}, {3.6950554421005893`*^9, 
   3.6950555642412815`*^9}, {3.695055732966177*^9, 3.6950557465022993`*^9}, {
   3.6950558046684055`*^9, 3.695055961220101*^9}, {3.695055998668761*^9, 
   3.6950560162157063`*^9}, {3.695056048840163*^9, 3.695056146211532*^9}, {
   3.6950561862654486`*^9, 3.695056188190776*^9}, {3.6950562373677807`*^9, 
   3.6950562879516363`*^9}, {3.6950563517744646`*^9, 3.695056360712323*^9}, {
   3.69505860651243*^9, 3.695058635588434*^9}, {3.695058684806075*^9, 
   3.6950588940516233`*^9}, {3.6957164552525945`*^9, 
   3.6957164560312014`*^9}, {3.6957168591079035`*^9, 
   3.6957169851976123`*^9}, {3.695717024315192*^9, 3.695717055967568*^9}, {
   3.695717541243352*^9, 3.695717560925682*^9}, 3.6957176038835087`*^9, {
   3.6957178788805103`*^9, 3.6957178831140776`*^9}, {3.6957179221867228`*^9, 
   3.6957179708748155`*^9}, 3.695718071534438*^9, {3.69571902099082*^9, 
   3.695719034182557*^9}, {3.695719110436449*^9, 3.69571912465912*^9}, {
   3.6959981424530063`*^9, 3.695998143402657*^9}, {3.695998201800911*^9, 
   3.6959982211236086`*^9}, 3.696161679540288*^9, {3.696332885830512*^9, 
   3.69633291986983*^9}, {3.6963330735158176`*^9, 3.6963330774044304`*^9}, {
   3.6963331566111712`*^9, 3.6963331767939215`*^9}, {3.696592128005638*^9, 
   3.696592200325493*^9}, {3.696592280079686*^9, 3.696592300895893*^9}, {
   3.696592360614642*^9, 3.6965924391532173`*^9}, {3.696592549000717*^9, 
   3.6965926737509665`*^9}, {3.6965927230303907`*^9, 3.696592776632204*^9}, {
   3.696592858783024*^9, 3.6965928838162374`*^9}, {3.6965929149072313`*^9, 
   3.696592957987955*^9}, {3.6965930011830645`*^9, 3.696593001767194*^9}, {
   3.6965931015144644`*^9, 3.6965931654384584`*^9}, 3.6965931976879473`*^9, {
   3.6965932301462927`*^9, 3.6965932334864273`*^9}, {3.6965933569359655`*^9, 
   3.6965933577742367`*^9}, {3.696593390597328*^9, 3.6965934361026325`*^9}, {
   3.69659349189392*^9, 3.696593496582985*^9}, {3.6965935305307894`*^9, 
   3.696593532985401*^9}, {3.6965936048453135`*^9, 3.6965936500412455`*^9}, {
   3.696593703183982*^9, 3.6965937451325016`*^9}, {3.6965938330555153`*^9, 
   3.696593888009883*^9}, {3.696593996396145*^9, 3.6965943945158587`*^9}, {
   3.696594455320829*^9, 3.6965947103520412`*^9}, 3.696594768684037*^9, {
   3.696594815028183*^9, 3.696594823298046*^9}, {3.6965948702502565`*^9, 
   3.696595114616662*^9}, {3.6965951697312756`*^9, 3.6965953069777794`*^9}, {
   3.6965953500124445`*^9, 3.696595353751785*^9}, {3.6965953948831806`*^9, 
   3.6965954213916507`*^9}, {3.696595542553995*^9, 3.6965955448754787`*^9}, {
   3.6965956361847277`*^9, 3.69659568404626*^9}, {3.696595734352703*^9, 
   3.6965957496578636`*^9}, {3.696595795766102*^9, 3.6965958031733503`*^9}, {
   3.696595870299922*^9, 3.6965959033890886`*^9}, {3.69659594497962*^9, 
   3.6965960170554657`*^9}, {3.696596069740856*^9, 3.6965960719006443`*^9}, {
   3.696596115793432*^9, 3.6965961457518997`*^9}, {3.6965962116946173`*^9, 
   3.6965962545251417`*^9}, {3.696596513453669*^9, 3.696596515787285*^9}, 
   3.696596667129428*^9, {3.696596717699503*^9, 3.696596905098714*^9}, {
   3.6965969520835447`*^9, 3.696597023631856*^9}, {3.6965971034463863`*^9, 
   3.696597122891425*^9}, {3.6965975434946456`*^9, 3.696597546602838*^9}, {
   3.696597678096383*^9, 3.696597688330096*^9}, {3.6965978572829094`*^9, 
   3.6965979026996202`*^9}, {3.6965980212576485`*^9, 3.6965980251793203`*^9}, 
   3.6966112031725936`*^9, {3.696611352492113*^9, 3.6966113711786222`*^9}, {
   3.6966114660470867`*^9, 3.6966114941486444`*^9}, {3.696611603631793*^9, 
   3.6966117017799177`*^9}, {3.696700266768712*^9, 3.696700288898875*^9}, {
   3.6967004337486825`*^9, 3.6967004344970875`*^9}, {3.696700470331721*^9, 
   3.696700811186071*^9}, 3.6967008770696635`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Source Code: LDME", "Subsection",
 CellChangeTimes->{
  3.6957165113004923`*^9, {3.695718438817669*^9, 3.695718442017226*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"LDME", "[", 
    RowBox[{"G_", ",", "X_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "k", ",", "E", ",", 
       RowBox[{"ldme", "=", "0"}], ",", "lij", ",", "uij", ",", "dij"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"E", "=", 
       RowBox[{"EdgeList", "[", "G", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", 
         RowBox[{"Length", "[", "E", "]"}]}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"lij", ",", "uij"}], "}"}], "=", 
          RowBox[{"GetEdgeDistanceBounds", "[", 
           RowBox[{"G", ",", 
            RowBox[{"E", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"i", "=", 
          RowBox[{
           RowBox[{"E", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"j", "=", 
          RowBox[{
           RowBox[{"E", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"dij", "=", 
          RowBox[{"Norm", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "-", 
             RowBox[{"X", "[", 
              RowBox[{"[", "j", "]"}], "]"}]}], ",", "2"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ldme", "+=", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{
             RowBox[{"lij", "-", "dij"}], ",", 
             RowBox[{"dij", "-", "uij"}], ",", "0"}], "]"}], "^", "2"}]}]}]}],
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"ldme", "/", 
         RowBox[{"Length", "[", "E", "]"}]}], "]"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6896810892288747`*^9, 3.6896810978201275`*^9}, {
   3.689681142990118*^9, 3.689681143529414*^9}, 3.6957164327594814`*^9, {
   3.695716488803309*^9, 3.695716504074519*^9}, {3.696334865906912*^9, 
   3.69633486603813*^9}, {3.6963349484139853`*^9, 3.6963349546419973`*^9}, {
   3.6963349860142603`*^9, 3.696334998735281*^9}, {3.6963350842585297`*^9, 
   3.6963350847740297`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Source Code: RMSD", "Subsection",
 CellChangeTimes->{{3.689682027125469*^9, 3.6896820352433434`*^9}, {
  3.695718425376396*^9, 3.6957184283294954`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RMSD", "[", 
   RowBox[{"X_", ",", "Y_"}], "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "xc", ",", "yc", ",", "x", ",", "y", ",", "U", ",", "D", ",", "V", ",", 
      "rmsd"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"calculating", " ", "centers"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"xc", "=", 
      RowBox[{"Mean", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"yc", "=", 
      RowBox[{"Mean", "[", "Y", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "translation", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "-", "xc"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "X", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Y", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "-", "yc"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "Y", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "svd", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"V", "=", 
      RowBox[{
       RowBox[{"Transpose", "[", "x", "]"}], ".", "y"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"U", ",", "D", ",", "V"}], "}"}], "=", 
      RowBox[{"SingularValueDecomposition", "[", "V", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"V", "=", 
      RowBox[{"U", ".", 
       RowBox[{"Transpose", "[", "V", "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{"x", ".", "V"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"rmsd", "=", 
      RowBox[{
       RowBox[{"Norm", "[", 
        RowBox[{
         RowBox[{"x", "-", "y"}], ",", "\"\<Frobenius\>\""}], "]"}], "/", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"Length", "[", "x", "]"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"rmsd", ",", "V", ",", "x", ",", "y"}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.689681165022363*^9, 3.6896811662349663`*^9}, {
  3.6896813441371255`*^9, 3.689681369335636*^9}, {3.689681427015995*^9, 
  3.6896814755897827`*^9}, {3.689681529767209*^9, 3.689681774416483*^9}, {
  3.689681818743713*^9, 3.6896818994958954`*^9}, {3.6896819662256985`*^9, 
  3.6896819784205647`*^9}, {3.6896820243186946`*^9, 3.6896820253405523`*^9}, {
  3.689682564324164*^9, 3.6896825730307393`*^9}, {3.695718935776682*^9, 
  3.6957189367299128`*^9}, {3.695719065344159*^9, 3.6957190758356524`*^9}, {
  3.6957192352883806`*^9, 3.695719237819716*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Example", ":", " ", 
    RowBox[{
    "X", " ", "and", " ", "Y", " ", "are", " ", "5", " ", "x", " ", "3", " ", 
     "matrix"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"X", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.814700", ",", "0.097500", ",", "0.157600"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.905800", ",", "0.278500", ",", "0.970600"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.127000", ",", "0.546900", ",", "0.957200"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.913400", ",", "0.957500", ",", "0.485400"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.632400", ",", "0.964900", ",", "0.800300"}], "}"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Y", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"6.167723", ",", "5.509229", ",", "5.376972"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.921716", ",", "5.625914", ",", "6.161379"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.265461", ",", "5.705450", ",", "6.339958"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.936486", ",", "6.432611", ",", "5.883000"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"5.680966", ",", "5.982123", ",", "5.893736"}], "}"}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"MatrixForm", "[", "X", "]"}], ",", 
     RowBox[{"MatrixForm", "[", "Y", "]"}]}], "}"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"rmsd", ",", "Q", ",", "x", ",", "y"}], "}"}], "=", 
    RowBox[{"RMSD", "[", 
     RowBox[{"X", ",", "Y"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"rmsd", ",", 
     RowBox[{"MatrixForm", "[", "Q", "]"}], ",", 
     RowBox[{"MatrixForm", "[", "x", "]"}], ",", 
     RowBox[{"MatrixForm", "[", "y", "]"}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.689682103881856*^9, 3.6896821384454165`*^9}, {
   3.6896823794183764`*^9, 3.689682395337614*^9}, {3.6896824609333143`*^9, 
   3.689682552842789*^9}, {3.6896827092797194`*^9, 3.6896828651155767`*^9}, {
   3.6896832311079135`*^9, 3.6896832331398354`*^9}, {3.6896833363228045`*^9, 
   3.6896833697906275`*^9}, {3.6896835189907684`*^9, 3.689683536835864*^9}, 
   3.695719257673167*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Source Code: Check MDGP Solution Quality", "Subsection",
 CellChangeTimes->{
  3.6896820831181965`*^9, {3.6957184087362404`*^9, 3.695718419041832*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CheckMDGPSolutionQuality", "[", 
    RowBox[{"G_", ",", "X_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "j", ",", "k", ",", "dij", ",", " ", "Dij", ",", 
       "numberOfEdges", ",", "E", ",", "error"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"E", "=", 
       RowBox[{"EdgeList", "[", "G", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"numberOfEdges", "=", 
       RowBox[{"Length", "[", "E", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"error", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "numberOfEdges"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", "numberOfEdges"}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "=", 
            RowBox[{
             RowBox[{"E", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"j", "=", 
            RowBox[{
             RowBox[{"E", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dij", "=", 
          RowBox[{"GetEdgeWeight", "[", 
           RowBox[{"G", ",", 
            RowBox[{"i", "\[UndirectedEdge]", "j"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Dij", "=", 
          RowBox[{"Norm", "[", 
           RowBox[{
            RowBox[{"X", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", 
            RowBox[{"X", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"error", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "=", 
          RowBox[{"Abs", "[", 
           RowBox[{"Dij", "-", "dij"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<max(error) = \>\"", ",", 
        RowBox[{"Max", "[", "error", "]"}], ",", " ", 
        "\"\< mean(error) = \>\"", ",", " ", 
        RowBox[{"Mean", "[", "error", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.694502972960245*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples", "Subsection",
 CellChangeTimes->{{3.679350148964155*^9, 3.679350152549901*^9}}],

Cell[CellGroupData[{

Cell["Generating Random Backbone", "Subsubsection",
 CellChangeTimes->{{3.6794062471789994`*^9, 3.6794062544567323`*^9}, 
   3.6860538715090094`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"GenerateRandom3DBackbone", "[", 
    RowBox[{"8", ",", 
     RowBox[{"algorithm", "=", "\"\<HomogeneousCoords\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<X=\>\"", ",", "X"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot3DBackbone", "[", 
  RowBox[{"X", "[", "\"\<Points\>\"", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.679350157857408*^9, 3.679350165349809*^9}, {
  3.6793502625517855`*^9, 3.679350272500025*^9}, {3.679396602457681*^9, 
  3.679396602655339*^9}, {3.6793984596979012`*^9, 3.679398481302373*^9}, {
  3.679398558121312*^9, 3.679398568806862*^9}, {3.6793987232327337`*^9, 
  3.6793987324597783`*^9}, {3.6794062058056207`*^9, 3.6794062060104556`*^9}, {
  3.679739893222548*^9, 3.6797398937194076`*^9}, {3.681050559273715*^9, 
  3.6810505666590476`*^9}, {3.681050654496676*^9, 3.6810506562786503`*^9}, {
  3.681050712877989*^9, 3.6810507449910135`*^9}, {3.681050801548744*^9, 
  3.681050813086647*^9}, {3.681050922084615*^9, 3.6810509231624775`*^9}, {
  3.6810511804399896`*^9, 3.6810511998720293`*^9}, {3.6810515964300175`*^9, 
  3.6810515965511436`*^9}, {3.681052116460451*^9, 3.6810521260369215`*^9}, {
  3.6930336296589675`*^9, 3.693033630777521*^9}, {3.6957213788988323`*^9, 
  3.695721381623725*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Set Position Using Different Coordinate Systems", "Subsubsection",
 CellChangeTimes->{{3.6794062953388*^9, 3.6794063086951036`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"X", "[", "\"\<CovalentBondLengths\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"X", "[", "\"\<PlaneRotationAngles\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"X", "[", "\"\<TorsionAngles\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{"SetPositionUsingCartesianSystem", "[", 
    RowBox[{"d", ",", "t", ",", "w"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"SetPositionUsingHomogeneousCoords", "[", 
    RowBox[{"d", ",", "t", ",", "w"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<S=\>\"", ",", "S"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<P=\>\"", ",", "P"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CalculateProteinAnglesForAtomAtPosition", "[", 
   RowBox[{"S", ",", "7"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CalculateProteinAnglesForAtomAtPosition", "[", 
   RowBox[{"P", ",", "7"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6793987045695095`*^9, 3.6793987140824037`*^9}, {
   3.6793988077473593`*^9, 3.679398910820831*^9}, 3.679403365459792*^9, {
   3.6794037427752213`*^9, 3.679403761930681*^9}, {3.6794038004309072`*^9, 
   3.679403807167263*^9}, {3.6794043087374773`*^9, 3.679404323245549*^9}, {
   3.6794043551722713`*^9, 3.6794043700379753`*^9}, {3.6794044728356934`*^9, 
   3.679404492302487*^9}, {3.6794045994142947`*^9, 3.67940460493628*^9}, {
   3.679404874108617*^9, 3.679404951631407*^9}, {3.6794052537841816`*^9, 
   3.679405308631333*^9}, 3.6794053456443725`*^9, {3.67940564264299*^9, 
   3.6794056486049147`*^9}, {3.679405741699015*^9, 3.679405742392773*^9}, {
   3.679406182549927*^9, 3.679406196506175*^9}, {3.6794063253031263`*^9, 
   3.6794064123489637`*^9}, {3.679406634125557*^9, 3.67940663702704*^9}, {
   3.6794067069580584`*^9, 3.679406732888578*^9}, {3.6794068473309193`*^9, 
   3.6794068484966364`*^9}, {3.6794070513742027`*^9, 3.679407100491548*^9}, {
   3.679407141288206*^9, 3.6794071715629845`*^9}, {3.679407250161986*^9, 
   3.679407252676136*^9}, {3.6794073278153877`*^9, 3.6794073829957857`*^9}, {
   3.679739870868251*^9, 3.679739871727892*^9}, {3.6797531093519835`*^9, 
   3.6797531194817133`*^9}, {3.6810525540653863`*^9, 
   3.6810525729632235`*^9}, {3.6896003995676084`*^9, 3.6896004041944876`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Generate Random DMDGP Instance", "Subsubsection",
 CellChangeTimes->{{3.679407510769739*^9, 3.679407522115453*^9}, 
   3.6798319122161026`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "M", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"natoms", " ", "=", "8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dijMax", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dijPrec", "=", "0.1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"GenerateRandomMDGP", "[", 
    RowBox[{"natoms", ",", "dijMax", ",", "dijPrec", ",", 
     RowBox[{"seed", "=", "False"}]}], "]"}]}], ";", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"G", "=", 
     RowBox[{"M", "[", "\"\<G\>\"", "]"}]}], ",", 
    RowBox[{"X", "=", 
     RowBox[{"M", "[", "\"\<X\>\"", "]"}]}]}], "}"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"G", ",", 
   RowBox[{"PlotAdjacencyMatrix", "[", 
    RowBox[{"G", ",", "True"}], "]"}], ",", " ", 
   RowBox[{"Plot3DBackbone", "[", 
    RowBox[{"X", "[", "\"\<Points\>\"", "]"}], "]"}]}], 
  "}"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"WriteMDGP", "[", 
    RowBox[{"M", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"{", 
       RowBox[{"\"\<dmdgp_N\>\"", ",", 
        RowBox[{"ToString", "[", "natoms", "]"}], ",", "\"\<_D\>\"", ",", 
        RowBox[{"ToString", "[", "dijMax", "]"}], ",", "\"\<_P\>\"", ",", 
        RowBox[{"ToString", "[", "dijPrec", "]"}], ",", "\"\<_S\>\"", ",", 
        RowBox[{"ToString", "[", "seed", "]"}]}], "}"}], "]"}]}], "]"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{
  3.679350281568641*^9, {3.6793503418859043`*^9, 3.6793503720521092`*^9}, {
   3.679350466576418*^9, 3.6793504789596534`*^9}, {3.6793505316493063`*^9, 
   3.679350533144163*^9}, {3.679392586310916*^9, 3.6793925872193985`*^9}, {
   3.67939730521247*^9, 3.6793973055760155`*^9}, {3.6794074757601814`*^9, 
   3.679407479794337*^9}, {3.679407534659811*^9, 3.6794075684004955`*^9}, {
   3.6795694018983793`*^9, 3.6795695468110123`*^9}, {3.679735147182562*^9, 
   3.679735162738102*^9}, {3.6798315901620045`*^9, 3.6798315955643563`*^9}, 
   3.6798319165363736`*^9, {3.679831960388562*^9, 3.6798319664981513`*^9}, {
   3.6798320290465565`*^9, 3.6798320405548406`*^9}, {3.6798320749511194`*^9, 
   3.679832079322584*^9}, {3.679832112464017*^9, 3.6798321175544796`*^9}, 
   3.679832159448175*^9, {3.679832378489052*^9, 3.6798324125404615`*^9}, {
   3.679832556647768*^9, 3.6798326872337575`*^9}, {3.679832755296446*^9, 
   3.679832786136928*^9}, {3.6798330083383417`*^9, 3.679833016907524*^9}, {
   3.6810526429808593`*^9, 3.6810526572953067`*^9}, 3.6827523547010245`*^9, {
   3.6827557525635543`*^9, 3.6827558063523703`*^9}, 3.682757225792551*^9, {
   3.6827572617081375`*^9, 3.68275726550815*^9}, 3.6827573780054502`*^9, {
   3.6930336713517265`*^9, 3.693033671825253*^9}, 3.693051347602092*^9, {
   3.6930551181284657`*^9, 3.6930552029339905`*^9}, {3.6930552761121798`*^9, 
   3.6930552775470905`*^9}, {3.69322980187673*^9, 3.6932298314308147`*^9}, {
   3.693230285399508*^9, 3.693230292307497*^9}, {3.6932307668652735`*^9, 
   3.6932307846304913`*^9}, {3.693230908039854*^9, 3.6932310394412007`*^9}, {
   3.693231108862516*^9, 3.6932311098432875`*^9}, 3.6932312073089123`*^9, {
   3.6932314187173014`*^9, 3.6932314503480115`*^9}, 3.6933108342848983`*^9, 
   3.6957180800832815`*^9, {3.695721402872883*^9, 3.6957214076924973`*^9}, {
   3.69659234228594*^9, 3.69659235105511*^9}, {3.6965969985947456`*^9, 
   3.696597001207911*^9}, {3.696611140253625*^9, 3.6966111492103467`*^9}, {
   3.6966113795650296`*^9, 3.6966113838621473`*^9}, {3.696611434184836*^9, 
   3.6966114369005604`*^9}, {3.6967008211718793`*^9, 3.696700823704874*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"ylabel=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "7"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"3", ",", "6"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "4"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"7", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"8", ",", "1"}], "}"}]}], "}"}]}],
  SequenceForm[
  "ylabel=", {{1, 8}, {2, 7}, {3, 6}, {4, 5}, {5, 4}, {6, 3}, {7, 2}, {8, 1}}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6967005991238995`*^9, 3.6967006310398893`*^9}, {
  3.696700664464468*^9, 3.696700712542642*^9}, {3.696700774091941*^9, 
  3.6967008293058906`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["NetworkGraphics",
     DynamicModuleBox[{Typeset`graph = HoldComplete[
       Graph[{1, 2, 3, 4, 5, 6, 7, 8}, {Null, 
         SparseArray[
         Automatic, {8, 8}, 0, {
          1, {{0, 4, 10, 17, 24, 31, 37, 43, 48}, {{2}, {3}, {4}, {5}, {1}, {
            3}, {4}, {5}, {6}, {7}, {1}, {2}, {4}, {5}, {6}, {7}, {8}, {1}, {
            2}, {3}, {5}, {6}, {7}, {8}, {1}, {2}, {3}, {4}, {6}, {7}, {8}, {
            2}, {3}, {4}, {5}, {7}, {8}, {2}, {3}, {4}, {5}, {6}, {8}, {3}, {
            4}, {5}, {6}, {7}}}, Pattern}]}, {
        Properties -> {
          UndirectedEdge[4, 7] -> {
            "DistanceBounds" -> {2.697027442991294, 3.2963668747671377`}}, 
           UndirectedEdge[5, 6] -> {"DistanceBounds" -> {1.526, 1.526}}, 
           UndirectedEdge[6, 8] -> {
            "DistanceBounds" -> {2.4913895358402267`, 2.4913895358402267`}}, 
           UndirectedEdge[2, 4] -> {
            "DistanceBounds" -> {2.491389535840226, 2.491389535840226}}, 
           UndirectedEdge[5, 8] -> {
            "DistanceBounds" -> {3.453526268972831, 4.220976550966794}}, 
           UndirectedEdge[2, 6] -> {
            "DistanceBounds" -> {3.848624412068484, 4.703874281417036}}, 
           UndirectedEdge[6, 7] -> {
            "DistanceBounds" -> {1.5260000000000002`, 1.5260000000000002`}}, 
           UndirectedEdge[3, 7] -> {
            "DistanceBounds" -> {3.2545671231702338`, 3.977804261652508}}, 
           UndirectedEdge[2, 3] -> {"DistanceBounds" -> {1.526, 1.526}}, 
           UndirectedEdge[7, 8] -> {
            "DistanceBounds" -> {1.5260000000000007`, 1.5260000000000007`}}, 
           UndirectedEdge[3, 6] -> {
            "DistanceBounds" -> {2.6131465485774625`, 3.1938457815946766`}}, 
           UndirectedEdge[2, 5] -> {
            "DistanceBounds" -> {3.4547388613504406`, 4.222458608317205}}, 
           UndirectedEdge[1, 4] -> {
            "DistanceBounds" -> {2.6378026604275897`, 3.2239810294114988`}}, 
           UndirectedEdge[2, 7] -> {
            "DistanceBounds" -> {4.18350870246659, 5.11317730301472}}, 
           UndirectedEdge[3, 5] -> {
            "DistanceBounds" -> {2.491389535840226, 2.491389535840226}}, 
           UndirectedEdge[4, 6] -> {
            "DistanceBounds" -> {2.491389535840226, 2.491389535840226}}, 
           UndirectedEdge[1, 5] -> {
            "DistanceBounds" -> {3.9113216566199123`, 4.780504246979893}}, 
           UndirectedEdge[1, 2] -> {"DistanceBounds" -> {1.526, 1.526}}, 
           UndirectedEdge[3, 8] -> {
            "DistanceBounds" -> {4.106888827622729, 5.019530789316669}}, 
           UndirectedEdge[1, 3] -> {
            "DistanceBounds" -> {2.491389535840226, 2.491389535840226}}, 
           UndirectedEdge[4, 8] -> {
            "DistanceBounds" -> {3.890018124150176, 4.754466596183549}}, 
           UndirectedEdge[4, 5] -> {"DistanceBounds" -> {1.526, 1.526}}, 
           UndirectedEdge[3, 4] -> {
            "DistanceBounds" -> {1.5260000000000002`, 1.5260000000000002`}}, 
           UndirectedEdge[5, 7] -> {
            "DistanceBounds" -> {2.4913895358402263`, 2.4913895358402263`}}}, 
         EdgeWeight -> {1.526, 2.491389535840226, 2.930891844919544, 
          4.345912951799902, 1.526, 2.491389535840226, 3.838598734833823, 
          4.27624934674276, 4.6483430027406545`, 1.5260000000000002`, 
          2.491389535840226, 2.9034961650860693`, 3.6161856924113707`, 
          4.563209808469699, 1.526, 2.491389535840226, 2.9966971588792157`, 
          4.322242360166862, 1.526, 2.4913895358402263`, 3.8372514099698125`, 
          1.5260000000000002`, 2.4913895358402267`, 1.5260000000000007`}}]]}, 
      TagBox[
       GraphicsGroupBox[
        GraphicsComplexBox[{{0., 0.4030171270759158}, {0.5838554343749516, 
         0.971684421592623}, {1.1953939529627216`, 1.0703055873117888`}, {
         1.0927739648680208`, 0.49952523771503904`}, {1.0568265983651854`, 
         0.}, {1.8219195638063799`, 1.0810498438808733`}, {
         1.7218673013882526`, 0.16051115054104947`}, {2.285456241738147, 
         0.43862761606106554`}}, {
          {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
           {Arrowheads[0.], ArrowBox[{1, 2}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{1, 3}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{1, 4}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{1, 5}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{2, 3}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{2, 4}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{2, 5}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{2, 6}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{2, 7}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{3, 4}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{3, 5}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{3, 6}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{3, 7}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{3, 8}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{4, 5}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{4, 6}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{4, 7}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{4, 8}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{5, 6}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{5, 7}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{5, 8}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{6, 7}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{6, 8}, 0.024886273512920776`]}, 
           {Arrowheads[0.], ArrowBox[{7, 8}, 0.024886273512920776`]}}, 
          {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
           DiskBox[1, 0.024886273512920776`], 
           DiskBox[2, 0.024886273512920776`], 
           DiskBox[3, 0.024886273512920776`], 
           DiskBox[4, 0.024886273512920776`], 
           DiskBox[5, 0.024886273512920776`], 
           DiskBox[6, 0.024886273512920776`], 
           DiskBox[7, 0.024886273512920776`], 
           DiskBox[8, 0.024886273512920776`]}}]],
       MouseAppearanceTag["NetworkGraphics"]],
      AllowKernelInitialization->False]],
    DefaultBaseStyle->{
     "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
    FormatType->TraditionalForm,
    FrameTicks->None], ",", 
   GraphicsBox[{
     {RGBColor[1, 0, 0], Opacity[0.2], 
      TagBox[PolygonBox[{{8, 1}, {8, 6}, {3, 6}}],
       "Triangle"]}, 
     {RGBColor[1, 0, 0], Opacity[0.2], 
      TagBox[PolygonBox[{{7, 2}, {7, 7}, {2, 7}}],
       "Triangle"]}, 
     {RGBColor[1, 0, 0], Opacity[0.2], 
      TagBox[PolygonBox[{{5, 4}, {5, 8}, {1, 8}}],
       "Triangle"]}, 
     {PointSize[Medium], 
      PointBox[{{2, 8}, {3, 8}, {4, 8}, {5, 8}, {3, 7}, {4, 7}, {5, 7}, {6, 
       7}, {7, 7}, {4, 6}, {5, 6}, {6, 6}, {7, 6}, {8, 6}, {5, 5}, {6, 5}, {7,
        5}, {8, 5}, {6, 4}, {7, 4}, {8, 4}, {7, 3}, {8, 3}, {8, 2}}]}, 
     {RGBColor[1, 0, 0], Dashing[{Small, Small}], LineBox[{{1, 8}, {8, 1}}]}},
    Axes->True,
    AxesOrigin->{1, 1},
    GridLines->Automatic,
    Ticks->{Automatic, {{1, 
        FormBox["8", TraditionalForm]}, {2, 
        FormBox["7", TraditionalForm]}, {3, 
        FormBox["6", TraditionalForm]}, {4, 
        FormBox["5", TraditionalForm]}, {5, 
        FormBox["4", TraditionalForm]}, {6, 
        FormBox["3", TraditionalForm]}, {7, 
        FormBox["2", TraditionalForm]}, {8, 
        FormBox["1", TraditionalForm]}}}], ",", 
   Graphics3DBox[{
     {RGBColor[1, 0, 0], 
      TubeBox[{{0, 0, 
        0}, {-1.526, 0, 0}, {-2.0337555109089696`, 1.4390484151485563`, 
         0}, {-1.5438339408000368`, 
        2.1503485187502864`, -1.2580560471450255`}, {-2.1234584330125545`, 
        3.5613008902529595`, -1.3019291981415457`}, {-3.647405625635291, 
        3.4850751353051903`, -1.2807021309884377`}, {-4.1421305671574835`, 
        2.8498903154753576`, -2.577029048433882}, {-5.653202236450708, 
        2.6511239737211567`, -2.500672309078135}}]}, 
     {RGBColor[0, 0, 1], PointSize[Large], 
      Point3DBox[{{-1.526, 0, 0}, {-2.0337555109089696`, 1.4390484151485563`, 
         0}, {-1.5438339408000368`, 
        2.1503485187502864`, -1.2580560471450255`}, {-2.1234584330125545`, 
        3.5613008902529595`, -1.3019291981415457`}, {-3.647405625635291, 
        3.4850751353051903`, -1.2807021309884377`}, {-4.1421305671574835`, 
        2.8498903154753576`, -2.577029048433882}, {-5.653202236450708, 
        2.6511239737211567`, -2.500672309078135}}]}, 
     {RGBColor[0, 1, 0], PointSize[Large], Point3DBox[{0, 0, 0}]}},
    Axes->True]}], "}"}]], "Output",
 CellChangeTimes->{{3.6967005915401506`*^9, 3.6967006311557956`*^9}, {
  3.696700664579993*^9, 3.6967007126268015`*^9}, {3.69670077419193*^9, 
  3.696700829453038*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate Random IMDGP Instance", "Subsubsection",
 CellChangeTimes->{{3.6827556825832863`*^9, 3.682755698879756*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "M", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"GenerateRandomMDGP", "[", 
    RowBox[{"7", ",", 
     RowBox[{"dtol", "=", "5"}], ",", 
     RowBox[{"dprec", "=", "0.0"}], ",", 
     RowBox[{"seed", "=", "1"}]}], "]"}]}], ";", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"G", "=", 
     RowBox[{"M", "[", "\"\<G\>\"", "]"}]}], ",", 
    RowBox[{"X", "=", 
     RowBox[{"M", "[", "\"\<X\>\"", "]"}]}]}], "}"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"G", ",", " ", 
   RowBox[{"Plot3DBackbone", "[", 
    RowBox[{"X", "[", "\"\<Points\>\"", "]"}], "]"}]}], 
  "}"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"Lij", ",", "Uij"}], "}"}], "=", 
  RowBox[{"GetEdgeDistanceBounds", "[", 
   RowBox[{"G", ",", 
    RowBox[{"1", "\[UndirectedEdge]", "4"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6827557151306763`*^9, 3.682755731225336*^9}, {
   3.6827558125873003`*^9, 3.682755899807398*^9}, {3.682756099177696*^9, 
   3.6827561323547773`*^9}, {3.682756547657323*^9, 3.6827565670121346`*^9}, {
   3.6827573427512226`*^9, 3.682757343004439*^9}, 3.6827573778519526`*^9, {
   3.6827574095891695`*^9, 3.682757409826308*^9}, 3.6957181176298323`*^9, {
   3.6959980499867764`*^9, 3.6959980566530547`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Creating Sample", "Subsubsection",
 CellChangeTimes->{{3.6797384400638847`*^9, 3.679738449164445*^9}, {
  3.6797531924783444`*^9, 3.6797531931477766`*^9}, {3.6896010407449894`*^9, 
  3.6896010520540876`*^9}, {3.689680851404976*^9, 3.689680863409527*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GenerateSample3DBackbone", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateSample3DBackbone", "[", 
    RowBox[{"numberOfAtoms_", ",", "\[Omega]_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "k", ",", "d", ",", "w", ",", "\[Theta]", ",", "X", ",", 
       "nvals", ",", "nsample", ",", "angle", ",", "scod", ",", "aid"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"length", " ", "of", " ", "covalent", " ", "bonds"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"1.526", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"planar", " ", "angles"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"\[Theta]", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"1.91", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"torsion", " ", "angles"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"w", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nvals", "=", 
       RowBox[{"Length", "[", "\[Omega]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"nsample", "=", 
       RowBox[{"nvals", "^", 
        RowBox[{"(", 
         RowBox[{"numberOfAtoms", "-", "3"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"X", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nsample"}], "}"}]}], "]"}]}], ";", 
      RowBox[{"(*", " ", "coordinates", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "0"}], ",", 
        RowBox[{"k", "<", "nsample"}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"scod", "=", "k"}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{"sample", " ", "code"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "0"}], ",", 
           RowBox[{"i", "<", 
            RowBox[{"(", 
             RowBox[{"numberOfAtoms", "-", "3"}], ")"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"aid", "=", 
             RowBox[{"Mod", "[", 
              RowBox[{"scod", ",", "nvals"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"scod", "=", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"scod", "-", "aid"}], ")"}], "/", "nvals"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"w", "[", 
              RowBox[{"[", 
               RowBox[{"4", "+", "i"}], "]"}], "]"}], "=", 
             RowBox[{"\[Omega]", "[", 
              RowBox[{"[", 
               RowBox[{"aid", "+", "1"}], "]"}], "]"}]}]}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"[", 
            RowBox[{"k", "+", "1"}], "]"}], "]"}], "=", 
          RowBox[{"SetPositionUsingHomogeneousCoords", "[", 
           RowBox[{"d", ",", "\[Theta]", ",", "w"}], "]"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "X", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.689601064885418*^9, 3.689601095789114*^9}, {
   3.6896031136018124`*^9, 3.6896031203156595`*^9}, {3.689603186131939*^9, 
   3.68960318740943*^9}, 3.689603218088925*^9, {3.6896032531701193`*^9, 
   3.6896032580193195`*^9}, 3.689603309803233*^9, {3.689603446356722*^9, 
   3.6896034795149183`*^9}, {3.689603541838892*^9, 3.689603597213151*^9}, {
   3.6896036678392954`*^9, 3.689603671421669*^9}, {3.6896037345488253`*^9, 
   3.689603770773517*^9}, {3.689603938760366*^9, 3.6896039577114477`*^9}, {
   3.68960417645967*^9, 3.6896041938323493`*^9}, {3.6896042358241997`*^9, 
   3.689604279961645*^9}, 3.6896808379551783`*^9, {3.6896808695204782`*^9, 
   3.6896808780595784`*^9}, {3.6896809290107346`*^9, 3.689681006618471*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Attention", ":", " ", 
     RowBox[{"It", " ", "takes", " ", "a", " ", "lot", " ", "of", " ", 
      RowBox[{
       RowBox[{"time", "!!"}], "!"}]}]}],
    FontColor->RGBColor[1, 0, 0]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"X", "=", 
     RowBox[{"GenerateSample3DBackbone", "[", 
      RowBox[{"8", ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"i", "*", 
          RowBox[{"Pi", "/", "6"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "11"}], "}"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Length", "[", "X", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.689680985242551*^9, 3.689680985245551*^9}, {
  3.6933108989111023`*^9, 3.6933109420015745`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"saving", " ", "structures"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{
    "\"\<C:\\\\Users\\\\Michael\\\\gitrepos\\\\github\\\\bioinfo\\\\XCOORDS8.\
dat\>\"", ",", "X", ",", "\"\<Table\>\""}], "]"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.689604415100661*^9, 3.689604450456601*^9}, {
  3.6896045355765567`*^9, 3.6896045541707053`*^9}, {3.6896049745787773`*^9, 
  3.689604996921856*^9}, {3.689680900484391*^9, 3.689680914446966*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Profiling (Timing)", "Subsubsection",
 CellChangeTimes->{{3.6797384400638847`*^9, 3.679738449164445*^9}, {
  3.6797531924783444`*^9, 3.6797531931477766`*^9}, {3.695718305258661*^9, 
  3.6957183085579033`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Comparison", " ", "between", " ", "HomogeneousCoords", " ", "and", " ", 
    "CartesianSystem", " ", "algorithms"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Time(HomogeneousCoords)=\>\"", ",", 
      RowBox[{"First", "[", 
       RowBox[{"Timing", "[", 
        RowBox[{"Timing", "[", 
         RowBox[{"GenerateRandom3DBackbone", "[", 
          RowBox[{"1000", ",", "\"\<HomogeneousCoords\>\""}], "]"}], "]"}], 
        "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Time(CartesianSystem)=\>\"", ",", 
      RowBox[{"First", "[", 
       RowBox[{"Timing", "[", 
        RowBox[{"Timing", "[", 
         RowBox[{"GenerateRandom3DBackbone", "[", 
          RowBox[{"1000", ",", "\"\<CartesianSystem\>\""}], "]"}], "]"}], 
        "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.679736995861993*^9, 3.679737108374234*^9}, {
   3.679737170416292*^9, 3.6797371881758313`*^9}, {3.6797374175247035`*^9, 
   3.6797374296543937`*^9}, {3.6797375077969713`*^9, 
   3.6797375083972406`*^9}, {3.679737567606184*^9, 3.679737587564953*^9}, 
   3.679737618559945*^9, {3.679737756677066*^9, 3.679737876465124*^9}, {
   3.679737921117589*^9, 3.679737947602236*^9}, {3.6797379783729334`*^9, 
   3.6797380132961597`*^9}, 3.679738215629839*^9, 3.679738272251295*^9, {
   3.6797383083382792`*^9, 3.6797383371093683`*^9}, {3.679738408861701*^9, 
   3.6797384185301433`*^9}, {3.67973875610773*^9, 3.6797387587133164`*^9}, {
   3.679739228813849*^9, 3.679739228937063*^9}, {3.6797395758387523`*^9, 
   3.6797395858278775`*^9}, {3.6797396623072777`*^9, 3.67973969363463*^9}, {
   3.679739994261594*^9, 3.67974008736335*^9}, {3.679740123268535*^9, 
   3.67974013272523*^9}, {3.6797401744831133`*^9, 3.6797403252268763`*^9}, {
   3.6797403613964577`*^9, 3.6797403727872944`*^9}, {3.6797404135477304`*^9, 
   3.6797404208132915`*^9}, {3.679740456195278*^9, 3.6797404762483387`*^9}, {
   3.6797406069977407`*^9, 3.6797406453138895`*^9}, {3.6797406838694105`*^9, 
   3.6797406923179336`*^9}, {3.6797528762915554`*^9, 3.679753003347789*^9}, {
   3.6797532038724775`*^9, 3.679753210593068*^9}, {3.6896009159837847`*^9, 
   3.689600946069008*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Estimating", " ", "complexity", " ", "of", " ", "random", " ", "backbone",
     " ", "generation"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "x", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"tp", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", 
         RowBox[{"First", "[", 
          RowBox[{"Timing", "[", 
           RowBox[{"GenerateRandom3DBackbone", "[", 
            RowBox[{"n", ",", "\"\<HomogeneousCoords\>\""}], "]"}], "]"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "100", ",", "10000", ",", "100"}], "}"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"fp", "=", 
     RowBox[{"Fit", "[", 
      RowBox[{"tp", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "x"}], "}"}], ",", "x"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"ListPlot", "[", "tp", "]"}], ",", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", "fp", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "100", ",", "10000"}], "}"}]}], "]"}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"HoldForm", "[", 
          RowBox[{"Problem", " ", "Size"}], "]"}], ",", 
         RowBox[{"HoldForm", "[", 
          RowBox[{"Time", " ", "in", " ", "Seconds"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"HoldForm", "[", "GenerateRandom3DBackbone", "]"}]}], ",", 
      RowBox[{"LabelStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"GrayLevel", "[", "0", "]"}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "*)"}]}]], "Input",
 CellChangeTimes->{{3.6797384729463034`*^9, 3.679738475425184*^9}, {
   3.679738516700796*^9, 3.679738544680171*^9}, {3.6797385852697315`*^9, 
   3.6797387966542225`*^9}, {3.6797388310657253`*^9, 3.679738847322424*^9}, {
   3.679740708910391*^9, 3.679740892171446*^9}, {3.6797527150228705`*^9, 
   3.6797527942870846`*^9}, {3.67975284721195*^9, 3.679752868802577*^9}, 
   3.6797532155000467`*^9, 3.6799177101688576`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Estimating", " ", "complexity", " ", "of", " ", "distance", " ", 
    "calculation", " ", "algorithms", " ", "in", " ", "GenerateRandomMDGP", 
    " ", "function"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"numberOfAtoms", "=", 
    RowBox[{"50", "\[IndentingNewLine]", 
     RowBox[{"First", "[", 
      RowBox[{"Timing", "[", 
       RowBox[{"M", "=", 
        RowBox[{"GenerateRandomMDGP", "[", 
         RowBox[{"numberOfAtoms", ",", 
          RowBox[{"Dtol", "=", "5.0"}]}], "]"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "*)"}]}]], "Input",
 CellChangeTimes->{{3.679917720141371*^9, 3.6799177515681624`*^9}, {
  3.6827523547220454`*^9, 3.68275235472404*^9}, {3.6827573778675776`*^9, 
  3.6827573778832026`*^9}, {3.6957182798825636`*^9, 3.6957182856526337`*^9}}]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Applying General Methods", "Section",
 CellChangeTimes->{{3.6944402487750998`*^9, 3.694440261776547*^9}, {
  3.6950520111428094`*^9, 3.695052013723016*^9}}],

Cell[CellGroupData[{

Cell["Source Code: Create MDGP instance from solution and pairs", "Subsection",
 CellChangeTimes->{{3.6945083222051*^9, 3.6945083435008144`*^9}, {
  3.694508619511842*^9, 3.694508622837978*^9}, {3.694509504736498*^9, 
  3.6945095094703307`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"MDGPAllPairs", "[", "n_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", 
       RowBox[{"k", "=", "0"}], ",", "pij"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pij", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"n", 
              RowBox[{"(", 
               RowBox[{"n", "-", "1"}], ")"}]}], ")"}], "/", "2"}]}], "}"}]}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "n"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", 
            RowBox[{"(", 
             RowBox[{"i", "+", "1"}], ")"}]}], ",", 
           RowBox[{"j", "\[LessEqual]", "n"}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"k", "++"}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"pij", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "=", 
             RowBox[{"{", 
              RowBox[{"i", ",", "j"}], "}"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "pij", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MDGPCreateInstanceFromSolutionAndPairs", "[", 
   RowBox[{"x_", ",", "eij_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"i", ",", "j", ",", "d", ",", "G"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"i", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"eij", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"Length", "[", "eij", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"j", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"eij", "[", 
          RowBox[{"[", "k", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"Length", "[", "eij", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"d", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Norm", "[", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"i", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "-", 
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"j", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"k", ",", 
          RowBox[{"Length", "[", "eij", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "d"}], "}"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.69450830220056*^9, 3.694508304668111*^9}, 
   3.6945100623786*^9, {3.695718751234719*^9, 3.6957187824512143`*^9}, {
   3.695721601024436*^9, 3.6957216488865795`*^9}, {3.6957217040246744`*^9, 
   3.6957217085297194`*^9}, {3.695721833663398*^9, 3.695721834174912*^9}, {
   3.6957218669001355`*^9, 3.695721867089517*^9}, {3.6959935498746166`*^9, 
   3.6959935507675786`*^9}, {3.6959984567278323`*^9, 3.695998518958846*^9}, {
   3.6959985503889723`*^9, 3.69599855815926*^9}, {3.6959986006196413`*^9, 
   3.695998603566064*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Source Code : Check MDGP solution", "Subsection",
 CellChangeTimes->{{3.694508635966399*^9, 3.6945086558564653`*^9}, 
   3.6945095018102756`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckMDGPSolution", "[", 
   RowBox[{"i_", ",", "j_", ",", "d_", ",", "x_", ",", 
    RowBox[{"verbose_:", "True"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"k", ",", "f", ",", "G"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"f", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", 
       RowBox[{"k", "\[LessEqual]", 
        RowBox[{"Length", "[", "i", "]"}]}], ",", 
       RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"sum", " ", "of", " ", "errors"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", "+=", 
         RowBox[{"Abs", "[", 
          RowBox[{"N", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "-", 
             RowBox[{"Norm", "[", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{"i", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "-", 
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{"j", "[", 
                  RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}]}], "]"}]}], 
            ")"}], "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"verbose", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"G", "=", 
         RowBox[{"SparseArray", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"i", "[", 
                RowBox[{"[", "k", "]"}], "]"}], ",", 
               RowBox[{"j", "[", 
                RowBox[{"[", "k", "]"}], "]"}]}], "}"}], "\[Rule]", "1"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"k", ",", 
              RowBox[{"Length", "[", "i", "]"}]}], "}"}]}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"MatrixPlot", "[", 
            RowBox[{"G", ",", 
             RowBox[{
             "ColorFunction", "\[Rule]", "\"\<LightTemperatureMap\>\""}], ",", 
             RowBox[{"ImageSize", "->", "Small"}], ",", 
             RowBox[{"Mesh", "\[Rule]", "All"}], ",", 
             RowBox[{"MeshStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Black", ",", "Dashed"}], "}"}]}]}], "]"}], "]"}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"MatrixForm", "[", 
          RowBox[{"G", ",", 
           RowBox[{"TableHeadings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"DeleteDuplicates", "[", "i", "]"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{"k", ",", 
                RowBox[{"{", 
                 RowBox[{"k", ",", 
                  RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}], 
             "}"}]}]}], "]"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "\"\<Checking solution:\>\"", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<   Number of equations = \>\"", ",", " ", 
          RowBox[{"Length", "[", "d", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<   Number of points    = \>\"", ",", " ", 
          RowBox[{"Length", "[", "x", "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<   Solution abs(error) = \>\"", ",", " ", "f"}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "f", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.694508659450159*^9, 3.6945086651945753`*^9}, {
   3.6945087161394696`*^9, 3.694508841097706*^9}, {3.6945088851085415`*^9, 
   3.694508902277628*^9}, {3.694509067435524*^9, 3.69450915855735*^9}, {
   3.6945092113206577`*^9, 3.694509248133011*^9}, {3.694511486540577*^9, 
   3.6945114958869553`*^9}, {3.6945115872039857`*^9, 
   3.6945115995443196`*^9}, {3.69572184106794*^9, 3.6957218712357283`*^9}, {
   3.6957219277672586`*^9, 3.6957219496908646`*^9}, {3.6957221409859514`*^9, 
   3.695722202290151*^9}, {3.695982143396659*^9, 3.6959821438540244`*^9}, {
   3.695999444715166*^9, 3.695999472577078*^9}, {3.695999533902027*^9, 
   3.6959995342378845`*^9}, 3.695999651257599*^9, {3.6959997112734327`*^9, 
   3.695999830925364*^9}, {3.6959998640267406`*^9, 3.695999871452301*^9}, {
   3.6960001995317717`*^9, 3.696000204605756*^9}, {3.696000313627251*^9, 
   3.696000374036637*^9}, 3.69600046630764*^9, {3.6960005106670237`*^9, 
   3.69600055154105*^9}, {3.6960005910742188`*^9, 3.6960005926643553`*^9}, {
   3.6963379016384754`*^9, 3.6963379224443455`*^9}, {3.6963380157259183`*^9, 
   3.696338094044306*^9}, {3.6963381557991943`*^9, 3.6963381627288723`*^9}, {
   3.6963381962307315`*^9, 3.6963382539260073`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Source Code: Nonlinear equations", "Subsection",
 CellChangeTimes->{{3.695980774599187*^9, 3.6959807890422645`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MDGPNSolve", "[", 
    RowBox[{"i_", ",", "j_", ",", "d_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k", ",", "eqs", ",", "xi", ",", "xj", ",", "x", ",", "n"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"eqs", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"Length", "[", "i", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"n", "=", 
       RowBox[{"Max", "[", 
        RowBox[{"i", ",", "j"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Symbol", "[", 
          RowBox[{"StringJoin", "[", 
           RowBox[{"\"\<x\>\"", ",", 
            RowBox[{"ToString", "[", "xi", "]"}], ",", 
            RowBox[{"ToString", "[", "xj", "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"xi", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"xj", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", 
         RowBox[{"Length", "[", "i", "]"}]}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"xi", "=", 
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"i", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"xj", "=", 
          RowBox[{"x", "[", 
           RowBox[{"[", 
            RowBox[{"j", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"eqs", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xi", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", 
              RowBox[{"xj", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xi", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "-", 
              RowBox[{"xj", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"xi", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "-", 
              RowBox[{"xj", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"d", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "^", "2"}]}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"eqs", "=", 
       RowBox[{"Join", "[", 
        RowBox[{"eqs", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}]}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<eqs=\>\"", ",", "eqs"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<x=\>\"", ",", "x"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{"Flatten", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"x", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "k", "]"}], "]"}], ",", 
             RowBox[{"RandomReal", "[", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"x", "=", 
         RowBox[{"FindRoot", "[", 
          RowBox[{"eqs", ",", "x"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Quiet", "[", 
       RowBox[{"x", "=", 
        RowBox[{"NSolve", "[", 
         RowBox[{"eqs", ",", "x", ",", "Reals"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{"ArrayReshape", "[", 
        RowBox[{"x", ",", 
         RowBox[{"{", 
          RowBox[{"n", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<x=\>\"", ",", "x"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "x", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6959807931988735`*^9, 3.6959808651195087`*^9}, {
   3.695981319470448*^9, 3.6959816654278154`*^9}, {3.695981696802899*^9, 
   3.69598193790523*^9}, {3.6959820413830986`*^9, 3.695982084209268*^9}, {
   3.695982167030732*^9, 3.6959821710191383`*^9}, {3.6959822184038534`*^9, 
   3.695982247628214*^9}, {3.695982304465785*^9, 3.6959823353580503`*^9}, {
   3.695982376103098*^9, 3.6959823800191355`*^9}, {3.695982800673107*^9, 
   3.695982828060028*^9}, {3.6959828702427034`*^9, 3.695982871401049*^9}, {
   3.6959829164454274`*^9, 3.6959830004868164`*^9}, {3.6959888042983994`*^9, 
   3.695988828501298*^9}, {3.695988895041767*^9, 3.695988955372898*^9}, {
   3.6959890712644*^9, 3.695989072049646*^9}, {3.695989103696677*^9, 
   3.6959891990099096`*^9}, {3.695989270528079*^9, 3.695989273022993*^9}, {
   3.6959893888410683`*^9, 3.695989444627164*^9}, {3.695989528041983*^9, 
   3.695989547018861*^9}, {3.695989592844425*^9, 3.6959896880344257`*^9}, {
   3.695989726077453*^9, 3.695989755804819*^9}, {3.695989869082122*^9, 
   3.6959899107177277`*^9}, {3.695989946606575*^9, 3.695989951887924*^9}, {
   3.695989995530915*^9, 3.6959901298385134`*^9}, {3.6959901809553523`*^9, 
   3.695990198460229*^9}, {3.6959902513619356`*^9, 3.695990370372473*^9}, {
   3.6959904207088675`*^9, 3.695990423239892*^9}, {3.6959904662502933`*^9, 
   3.6959905066632338`*^9}, {3.6959905389614973`*^9, 3.695990555189827*^9}, {
   3.695990592406352*^9, 3.6959905969143476`*^9}, {3.695990862448014*^9, 
   3.6959908807504*^9}, {3.696000226158333*^9, 3.6960002763225875`*^9}, 
   3.696000556861759*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Example", ":", " ", 
    RowBox[{"5", " ", "points"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"eij", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"x", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{"5", ",", "3"}], "}"}]}], "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "d"}], "}"}], "=", 
     RowBox[{"MDGPCreateInstanceFromSolutionAndPairs", "[", 
      RowBox[{"x", ",", "eij"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x", "=", 
     RowBox[{"MDGPNSolve", "[", 
      RowBox[{"i", ",", "j", ",", "d"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"x", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "[", 
         RowBox[{"[", "j", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "x", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", "x", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CheckMDGPSolution", "[", 
     RowBox[{"i", ",", "j", ",", "d", ",", "x", ",", "True"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6959821725045357`*^9, 3.6959822057965155`*^9}, {
   3.695982268679414*^9, 3.6959823441443806`*^9}, {3.695982920850732*^9, 
   3.6959829209352903`*^9}, {3.6959889733898363`*^9, 
   3.6959890309626265`*^9}, {3.6959890820892334`*^9, 
   3.6959890852169228`*^9}, {3.6959894614439697`*^9, 
   3.6959894618659773`*^9}, {3.695990141312871*^9, 3.6959901626141343`*^9}, {
   3.6959902092902546`*^9, 3.695990213653076*^9}, {3.6959906056694627`*^9, 
   3.6959907132884865`*^9}, {3.69599074403419*^9, 3.6959908171476326`*^9}, {
   3.695990848691627*^9, 3.695990848783781*^9}, {3.6959909472498837`*^9, 
   3.695990958030756*^9}, {3.6959909990686064`*^9, 3.6959911014281673`*^9}, {
   3.6959913603925343`*^9, 3.695991378520133*^9}, {3.695991433093545*^9, 
   3.6959914428903313`*^9}, 3.695991528666456*^9, {3.69599293111237*^9, 
   3.6959929457414904`*^9}, {3.6959998819368143`*^9, 3.6959998966497583`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckMDGPSolution", "[", 
   RowBox[{"i", ",", "j", ",", "d", ",", "x", ",", "True"}], "]"}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CheckMDGPSolution", "[", 
   RowBox[{"i", ",", "j", ",", "d", ",", "x", ",", "True"}], "]"}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Example", ":", " ", 
    RowBox[{"10", " ", "points"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"n", "=", "5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eij", "=", 
     RowBox[{"MDGPAllPairs", "[", "n", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "d"}], "}"}], "=", 
     RowBox[{"MDGPCreateInstanceFromSolutionAndPairs", "[", 
      RowBox[{"x", ",", "eij"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x", "=", 
     RowBox[{"MDGPNSolve", "[", 
      RowBox[{"i", ",", "j", ",", "d"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CheckMDGPSolution", "[", 
     RowBox[{"i", ",", "j", ",", "d", ",", "x"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6959914809267282`*^9, 3.6959914981254253`*^9}, {
  3.695991562961543*^9, 3.6959916431277523`*^9}, {3.6959920787623296`*^9, 
  3.695992087048052*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Source Code: Solver for complete distance matrices", "Subsection",
 CellChangeTimes->{{3.694440270104432*^9, 3.6944402903355665`*^9}, {
  3.694508362021762*^9, 3.6945083745408287`*^9}, {3.6945086248727016`*^9, 
  3.694508627838993*^9}, {3.6945094785730658`*^9, 3.6945094800751905`*^9}, {
  3.6945095153284197`*^9, 3.6945095197760963`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MDGPAllInstancesSolver", "[", 
   RowBox[{"i_", ",", "j_", ",", "d_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "numberOfAtoms", ",", "k", ",", "m", ",", "\[Lambda]", ",", "v", ",", 
      "x"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"numberOfAtoms", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"creates", " ", "distance", " ", "matrix"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"iloc", ",", "numberOfAtoms"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"jloc", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", 
       RowBox[{"k", "\[LessEqual]", 
        RowBox[{"Length", "[", "i", "]"}]}], ",", 
       RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"m", "[", 
           RowBox[{"[", 
            RowBox[{"i", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"j", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "=", 
         RowBox[{"d", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"m", "[", 
           RowBox[{"[", 
            RowBox[{"j", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "=", 
         RowBox[{"d", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"\[Lambda]", ":", 
       RowBox[{"eigenvalues", " ", "and", " ", "v"}], ":", "eigenvectors"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"m", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "iloc", "]"}], "]"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"m", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "jloc", "]"}], "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{
             RowBox[{"m", "[", 
              RowBox[{"[", "iloc", "]"}], "]"}], "[", 
             RowBox[{"[", "jloc", "]"}], "]"}], "^", "2"}]}], ")"}], "/", 
         "2"}], ",", 
        RowBox[{"{", 
         RowBox[{"iloc", ",", "numberOfAtoms"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"jloc", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Lambda]", ",", "v"}], "}"}], "=", 
      RowBox[{"Eigensystem", "[", 
       RowBox[{"m", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"getting", " ", "solution"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Sqrt", "[", 
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"[", "jloc", "]"}], "]"}], "]"}], 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "jloc", "]"}], "]"}], "[", 
          RowBox[{"[", "iloc", "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"iloc", ",", "numberOfAtoms"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"jloc", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "x", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6945071563672113`*^9, 3.694507320236541*^9}, {
  3.694507374181988*^9, 3.6945074899994063`*^9}, {3.694508412302476*^9, 
  3.694508475668783*^9}, {3.694508530004429*^9, 3.694508561182579*^9}, {
  3.6959987033856926`*^9, 3.695998723358347*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Source Code: Solver based on optimization methods", "Subsection",
 CellChangeTimes->{{3.6945082211811686`*^9, 3.6945082350165057`*^9}, {
  3.694508353277437*^9, 3.694508357986554*^9}, {3.694509485037609*^9, 
  3.6945095303971586`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MDGPOptSolverFobj", "[", 
   RowBox[{"i_", ",", "j_", ",", "d_", ",", "x_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"f", "=", "0"}], ",", "numberOfAtoms", ",", "ncols", ",", 
      "nrows", ",", "k", ",", "y"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"y", "=", 
      RowBox[{"ArrayReshape", "[", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "x", "]"}], "/", "3"}], ",", "3"}], "}"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", 
       RowBox[{"k", "\[LessEqual]", 
        RowBox[{"Length", "[", "d", "]"}]}], ",", 
       RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"f", "+=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"d", "[", 
             RowBox[{"[", "k", "]"}], "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"Norm", "[", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"[", 
                RowBox[{"i", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}], "-", 
              RowBox[{"y", "[", 
               RowBox[{"[", 
                RowBox[{"j", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "]"}], "]"}]}], "]"}], "^", 
            "2"}]}], ")"}], "^", "2"}]}]}], "\[IndentingNewLine]", "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "f", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MDGPOptSolver", "[", 
   RowBox[{"i_", ",", "j_", ",", "d_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"numberOfAtoms", ",", "f", ",", "y", ",", "v", ",", "w"}], "}"}],
     ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"numberOfAtoms", "=", 
      RowBox[{"Max", "[", 
       RowBox[{"{", 
        RowBox[{"i", ",", "j"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ClearAll", "[", "z", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"Array", "[", 
       RowBox[{"z", ",", 
        RowBox[{"3", "*", "numberOfAtoms"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"f", ":=", 
      RowBox[{
       RowBox[{"MDGPOptSolverFobj", "[", 
        RowBox[{"i", ",", "j", ",", "d", ",", "#"}], "]"}], "&"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"v", ",", "y"}], "}"}], "=", 
      RowBox[{"NMinimize", "[", 
       RowBox[{
        RowBox[{"f", "[", "y", "]"}], ",", "y"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"ArrayReshape", "[", 
       RowBox[{"y", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "y", "]"}], "/", "3"}], ",", "3"}], "}"}]}],
        "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"y", "[", 
           RowBox[{"[", "iloc", "]"}], "]"}], "[", 
          RowBox[{"[", "jloc", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"iloc", ",", 
          RowBox[{"Length", "[", "y", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"jloc", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "y", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwd0GtIk3EUx/G10AqKkJCMUrYEccySsh5hSbAu4Axk2NNF0VJDbRoUJJEh
lCgmdiFqW5fp49IXRRBDXD6RL8RFRCoyc2E3TdaGmLIsadA0aN//i8MHDj/O
4Rx95fmiKq1GozHEC1e6POUPW+fNbb7uCrSGmq+gw7ggnDj14CpKnqEmVKbT
29FuOHBb5AskN/7c5HqJWdc/+7B0NuEN2pSysJjvGBGOqpv/YFrGfqF165oY
dg1HhSX1G9c+Yk9gcR3mt8868ftCRGgP6VX8WLhzCP9mjn/oi3vr8vwkLo43
zGCjcjGMJx//sHrjypbTRRjs+VKMY9m9Ffg+WlKDz982nMP1h5yvcHTJJwwo
w6/xrHFyAlNr/VPoLdDPoXZ1whLuzuleRv3Td1tecIe/MRV7OrdlYoZnRzZe
2rMqByul/L34Vec14c3BvH14V8o1Y2lf4hE0HjOVYc0zexWu5DbbsDPpRh3+
M32qR1mOtWDs13Qb6lyt93HXCbUDA1GXR+ScB/sxpa5YxQ3KXBjvadJ+Y4tF
Xka/fEY4ZXZr++N+O2xJwgtKcjLO9B5NwdprER0mBgvTRf/OcQMOuMuF9oBL
wlDWE2F1cHseRmzVwo4Rx5jKX5xNfvwP9thtYQ==
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "Subsection",
 CellChangeTimes->{{3.694443377092915*^9, 3.69444339110975*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Example", " ", 
    RowBox[{"A", ":", " ", 
     RowBox[{
     "Solving", " ", "an", " ", "instance", " ", "with", " ", "4", " ", 
      "points", " ", "and", " ", "complete", " ", "distance", " ", 
      "matrix"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eij", "=", 
     RowBox[{"MDGPAllPairs", "[", 
      RowBox[{"Length", "[", "x", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "d"}], "}"}], "=", 
     RowBox[{"MDGPCreateInstanceFromSolutionAndPairs", "[", 
      RowBox[{"x", ",", "eij"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"y", "=", 
    RowBox[{"MDGPAllInstancesSolver", "[", 
     RowBox[{"i", ",", "j", ",", "d"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CheckMDGPSolution", "[", 
     RowBox[{"i", ",", "j", ",", "d", ",", "y"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6945020765303698`*^9, 3.694502077113967*^9}, {
   3.694502115287328*^9, 3.6945021440628996`*^9}, {3.694506485492285*^9, 
   3.694506491486862*^9}, {3.6945070759600315`*^9, 3.694507149649458*^9}, {
   3.694507500584446*^9, 3.694507506956316*^9}, {3.694507647754163*^9, 
   3.6945076617990155`*^9}, {3.694507837024714*^9, 3.694507925270578*^9}, {
   3.6945080036471977`*^9, 3.694508196459286*^9}, {3.694508392717325*^9, 
   3.694508395482465*^9}, {3.6945085186130676`*^9, 3.6945085192555704`*^9}, {
   3.694508858600624*^9, 3.694508873149227*^9}, {3.694508910762434*^9, 
   3.6945089378632455`*^9}, {3.6945089907969933`*^9, 3.694509052030225*^9}, {
   3.694509171250592*^9, 3.6945091805639834`*^9}, {3.6945092635475707`*^9, 
   3.694509295549534*^9}, {3.694509945218164*^9, 3.694509979519533*^9}, 
   3.694510051968624*^9, {3.6945242557251606`*^9, 3.6945242875564613`*^9}, {
   3.6945243287663155`*^9, 3.694524369935794*^9}, {3.6945244025925083`*^9, 
   3.694524402805767*^9}, {3.694524470686516*^9, 3.694524494306158*^9}, {
   3.695718848064787*^9, 3.695718852927106*^9}, {3.695721428565131*^9, 
   3.6957214393257666`*^9}, {3.695721551859558*^9, 3.6957215846888027`*^9}, {
   3.6957216643615556`*^9, 3.695721689322463*^9}, 3.695721733060641*^9, {
   3.6957218235847464`*^9, 3.6957218239785795`*^9}, {3.695721859194803*^9, 
   3.6957218596517277`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6959985778101215`*^9, 3.6959985780125904`*^9}, {
  3.695998636293251*^9, 3.6959986528418593`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Example", " ", 
    RowBox[{"B", ":", " ", 
     RowBox[{
     "Solving", " ", "an", " ", "instance", " ", "with", " ", "100", " ", 
      "points", " ", "and", " ", "complete", " ", "distance", " ", 
      "matrix"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"100", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eij", "=", 
     RowBox[{"MDGPAllPairs", "[", 
      RowBox[{"Length", "[", "x", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "d"}], "}"}], "=", 
     RowBox[{"MDGPCreateInstanceFromSolutionAndPairs", "[", 
      RowBox[{"x", ",", "eij"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"y", "=", 
     RowBox[{"MDGPAllInstancesSolver", "[", 
      RowBox[{"i", ",", "j", ",", "d"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CheckMDGPSolution", "[", 
     RowBox[{"i", ",", "j", ",", "d", ",", "y"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.694509305260522*^9, 3.694509350649474*^9}, {
   3.6945093819251947`*^9, 3.6945093939038277`*^9}, 3.6945095474937687`*^9, {
   3.694510005755019*^9, 3.6945100418064027`*^9}, {3.6957188588805037`*^9, 
   3.695718861495637*^9}, {3.6957217902286267`*^9, 3.6957217910585375`*^9}, {
   3.695722192648009*^9, 3.6957221927706413`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Example", " ", 
    RowBox[{"C", ":", " ", 
     RowBox[{
     "Solving", " ", "an", " ", "instance", " ", "with", " ", "5", " ", 
      "points", " ", "using", " ", "optimization", " ", "based", " ", 
      "method"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "=", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"5", ",", "3"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"eij", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "5"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "d"}], "}"}], "=", 
     RowBox[{"MDGPCreateInstanceFromSolutionAndPairs", "[", 
      RowBox[{"x", ",", "eij"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"y", "=", 
     RowBox[{"MDGPOptSolver", "[", 
      RowBox[{"i", ",", "j", ",", "d"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"CheckMDGPSolution", "[", 
     RowBox[{"i", ",", "j", ",", "d", ",", "y"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6945095630562625`*^9, 3.6945096527068567`*^9}, {
   3.694509721595458*^9, 3.6945097801643176`*^9}, {3.694509816997955*^9, 
   3.69450983564351*^9}, 3.694510041821412*^9, {3.6957188663643827`*^9, 
   3.695718869680483*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Example", " ", 
    RowBox[{"D", ":", " ", 
     RowBox[{
     "Solving", " ", "an", " ", "instance", " ", "with", " ", "100", " ", 
      "points", " ", "using", " ", "optimization", " ", "based", " ", 
      "method"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "It", " ", "can", " ", "take", " ", "a", " ", "lot", " ", "of", " ", 
    RowBox[{
     RowBox[{"time", "!!"}], "!"}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"k", "=", "1"}], ",", 
     RowBox[{"k", "\[LessEqual]", "100"}], ",", 
     RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SeedRandom", "[", "k", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{"RandomReal", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"7", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eij", "=", 
       RowBox[{"MDGPAllPairs", "[", 
        RowBox[{"Length", "[", "x", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"eij", "=", 
       RowBox[{"RandomSample", "[", 
        RowBox[{"eij", ",", 
         RowBox[{"Round", "[", 
          RowBox[{"0.50", 
           RowBox[{"Length", "[", "eij", "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"i", ",", "j", ",", "d"}], "}"}], "=", 
       RowBox[{"MDGPCreateInstanceFromSolutionAndPairs", "[", 
        RowBox[{"x", ",", "eij"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"y", "=", 
       RowBox[{"MDGPOptSolver", "[", 
        RowBox[{"i", ",", "j", ",", "d"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"f", "=", 
       RowBox[{"CheckMDGPSolution", "[", 
        RowBox[{"i", ",", "j", ",", "d", ",", "y", ",", "False"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Or", "[", 
         RowBox[{
          RowBox[{"f", ">", "0.01"}], ",", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{"k", ",", "10"}], "]"}], "\[Equal]", "0"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<{Seed,Error}=\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "f"}], "}"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", "*)"}]}]], "Input",
 CellChangeTimes->{{3.694509866767895*^9, 3.6945098916890173`*^9}, {
   3.694510093362407*^9, 3.6945101089935975`*^9}, {3.694510169324609*^9, 
   3.6945101956066246`*^9}, {3.69451025730608*^9, 3.6945103028323336`*^9}, {
   3.694510333348612*^9, 3.6945103372228565`*^9}, {3.694510375701194*^9, 
   3.6945103983735256`*^9}, {3.6945104397134395`*^9, 
   3.6945105412985134`*^9}, {3.6945116235631905`*^9, 
   3.6945117051807966`*^9}, {3.694511748936102*^9, 3.694511751267356*^9}, {
   3.694511828015873*^9, 3.69451182813148*^9}, {3.6945118732869487`*^9, 
   3.6945119184429393`*^9}, {3.694512052222779*^9, 3.694512063708476*^9}, {
   3.694512108959667*^9, 3.694512122482854*^9}, {3.6945122224563627`*^9, 
   3.6945122549831843`*^9}, {3.6945122929003396`*^9, 3.6945123044169874`*^9}, 
   3.6945123946710157`*^9, {3.6945124631794453`*^9, 3.6945125052038*^9}, {
   3.6945126788009663`*^9, 3.6945126790627346`*^9}, {3.6945130547371454`*^9, 
   3.6945130548839865`*^9}, {3.6945135081915073`*^9, 3.694513508353938*^9}, {
   3.694519946259391*^9, 3.6945199465126286`*^9}, {3.6945256242761097`*^9, 
   3.6945256246907053`*^9}, {3.694525800598526*^9, 3.6945258010835543`*^9}, {
   3.6957188810695877`*^9, 3.695718892192297*^9}, {3.6959992062308846`*^9, 
   3.695999250403311*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Solving Manually: Continuos Problem", "Section",
 CellChangeTimes->{{3.6957228443800993`*^9, 3.695722871251212*^9}, {
  3.696000820192024*^9, 3.6960008204222765`*^9}, {3.6960009494192247`*^9, 
  3.696000958663651*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetEuclideanCoords", "[", "\[Theta]_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", 
       RowBox[{"d", "=", "1.526"}], ",", 
       RowBox[{"\[Phi]", "=", "1.91"}], ",", "a", ",", "b", ",", "c", ",", 
       "i", ",", "p", ",", "u", ",", "v", ",", "x"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{"Length", "[", "\[Theta]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"x", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "d"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "d"}], "+", 
            RowBox[{"d", "*", 
             RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ",", 
           RowBox[{"d", "*", 
            RowBox[{"Sin", "[", "\[Phi]", "]"}]}], " ", ",", "0"}], "}"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "4"}], ",", 
        RowBox[{"i", "\[LessEqual]", "n"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"dihedral", " ", "rotation", " ", "axis"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "3"}], "]"}], "]"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "2"}], "]"}], "]"}], ",", 
            RowBox[{"x", "[", 
             RowBox[{"[", 
              RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"u", "=", 
          RowBox[{"Normalize", "[", 
           RowBox[{"b", "-", "c"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"p", "=", " ", 
          RowBox[{"c", "+", 
           RowBox[{"d", "*", " ", "u"}]}]}], ";", " ", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"normal", " ", "to", " ", "the", " ", "plane", " ", "abc"}],
           " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"v", "=", 
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{"b", "-", "c"}], ",", 
            RowBox[{"a", "-", "c"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"plane", " ", "rotation"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"p", "=", 
          RowBox[{
           RowBox[{"RotationTransform", "[", 
            RowBox[{"\[Phi]", ",", "v", ",", "c"}], "]"}], "[", "p", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"dihedral", " ", "rotation"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"p", "=", 
          RowBox[{
           RowBox[{"RotationTransform", "[", 
            RowBox[{
             RowBox[{"\[Theta]", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "u", ",", "c"}], "]"}], 
           "[", "p", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"set", " ", "i"}], "-", 
           RowBox[{"th", " ", "coordinate"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"x", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", "p"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "x", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.695733919862407*^9, 3.695733942463207*^9}, 
   3.695734059452997*^9, {3.6957402346282554`*^9, 3.6957402347815647`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MDGPErrorMatrix", "[", 
    RowBox[{"i_", ",", "j_", ",", "d_", ",", "X_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k", ",", "ei", ",", "ej", ",", "M"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"M", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"xi", ",", 
           RowBox[{"Length", "[", "x", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"xj", ",", 
           RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", 
         RowBox[{"Length", "[", "i", "]"}]}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ei", "=", 
          RowBox[{"i", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ej", "=", 
          RowBox[{"j", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"[", "ei", "]"}], "]"}], "[", 
           RowBox[{"[", "ej", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"Norm", "[", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"[", "ei", "]"}], "]"}], "-", 
             RowBox[{"X", "[", 
              RowBox[{"[", "ej", "]"}], "]"}]}], "]"}], "-", 
           RowBox[{"d", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"[", "ej", "]"}], "]"}], "[", 
           RowBox[{"[", "ei", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"[", "ei", "]"}], "]"}], "[", 
           RowBox[{"[", "ej", "]"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "M", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.695739079107868*^9, 3.695739275016298*^9}, {
  3.6957393115810227`*^9, 3.6957394078349295`*^9}, {3.6957396215194592`*^9, 
  3.695739673900056*^9}, {3.6957397597321463`*^9, 3.695739800552556*^9}, {
  3.6957398636083293`*^9, 3.6957398641083183`*^9}, {3.6959932232184725`*^9, 
  3.6959932234928007`*^9}, {3.6959992780124493`*^9, 3.695999305410774*^9}}],

Cell[BoxData[{
 RowBox[{"\[Omega]", "=", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", 
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}], ",", 
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}], ",", 
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}], ",", 
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}], ",", 
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}], ",", 
    RowBox[{"RandomReal", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], "]"}]}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x", "=", 
   RowBox[{"GetEuclideanCoords", "[", "\[Omega]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eij", "=", 
   RowBox[{"MDGPAllPairs", "[", 
    RowBox[{"Length", "[", "x", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"i", ",", "j", ",", "d"}], "}"}], "=", 
   RowBox[{"MDGPCreateInstanceFromSolutionAndPairs", "[", 
    RowBox[{"x", ",", "eij"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"MDGPErrorMatrix", "[", 
   RowBox[{"i", ",", "j", ",", "d", ",", "x"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6957395463988876`*^9, 3.695739592721032*^9}, {
  3.69573969316702*^9, 3.695739737210102*^9}, {3.695739813370964*^9, 
  3.695739872644418*^9}, {3.695740830391247*^9, 3.695740879885598*^9}}],

Cell[BoxData[
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Graphics3D", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Red", ",", 
             RowBox[{"Tube", "[", 
              RowBox[{"GetEuclideanCoords", "[", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "\[Omega]4", ",", "\[Omega]5", 
                 ",", "\[Omega]6", ",", "\[Omega]7", ",", "\[Omega]8", ",", 
                 "\[Omega]9"}], "}"}], "]"}], "]"}]}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"PointSize", "[", "Large", "]"}], ",", "Blue", ",", 
             RowBox[{"Point", "[", 
              RowBox[{"GetEuclideanCoords", "[", 
               RowBox[{"{", 
                RowBox[{
                "0", ",", "0", ",", "0", ",", "\[Omega]4", ",", "\[Omega]5", 
                 ",", "\[Omega]6", ",", "\[Omega]7", ",", "\[Omega]8", ",", 
                 "\[Omega]9"}], "}"}], "]"}], "]"}]}], "}"}]}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"xrange", ",", "yrange", ",", "zrange"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RotationAction", "\[Rule]", "\"\<Clip\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Axes", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], "}"}]}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"BoxStyle", "\[Rule]", 
          RowBox[{"Directive", "[", "Dashed", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "Medium"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MatrixPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MDGPErrorMatrix", "[", 
          RowBox[{"i", ",", "j", ",", "d", ",", 
           RowBox[{"GetEuclideanCoords", "[", 
            RowBox[{"{", 
             RowBox[{
             "0", ",", "0", ",", "0", ",", "\[Omega]4", ",", "\[Omega]5", ",",
               "\[Omega]6", ",", "\[Omega]7", ",", "\[Omega]8", ",", 
              "\[Omega]9"}], "}"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "Small"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ColorFunction", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"ColorData", "[", "\"\<TemperatureMap\>\"", "]"}], "[", 
             RowBox[{"Rescale", "[", 
              RowBox[{"#", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "]"}], "]"}], "&"}],
            ")"}]}], ",", 
         RowBox[{"ColorFunctionScaling", "\[Rule]", "False"}]}], "]"}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Torsion", " ", "angles"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Torsion Angles\>\"", ",", "Bold", ",", "Medium"}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Omega]4", ",", "0"}], "}"}], ",", 
       RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Omega]5", ",", "0"}], "}"}], ",", 
       RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Omega]6", ",", "0"}], "}"}], ",", 
       RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Omega]7", ",", "0"}], "}"}], ",", 
       RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Omega]8", ",", "0"}], "}"}], ",", 
       RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Omega]9", ",", "0"}], "}"}], ",", 
       RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Bounding", " ", "boxes"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Bounding Limits\>\"", ",", "Bold", ",", "Medium"}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xrange", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"-", "10"}], ",", "10", ",", 
       RowBox[{"ControlType", " ", "\[Rule]", " ", "IntervalSlider"}], ",", 
       RowBox[{"Method", " ", "\[Rule]", " ", "\"\<Push\>\""}], ",", 
       RowBox[{"MinIntervalSize", "\[Rule]", "0.1"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"yrange", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"-", "10"}], ",", "10", ",", 
       RowBox[{"ControlType", " ", "\[Rule]", " ", "IntervalSlider"}], ",", 
       RowBox[{"Method", " ", "\[Rule]", " ", "\"\<Push\>\""}], ",", 
       RowBox[{"MinIntervalSize", "\[Rule]", "0.1"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"zrange", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "3"}], ",", "3"}], "}"}]}], "}"}], ",", 
       RowBox[{"-", "10"}], ",", "10", ",", 
       RowBox[{"ControlType", " ", "\[Rule]", " ", "IntervalSlider"}], ",", 
       RowBox[{"Method", " ", "\[Rule]", " ", "\"\<Push\>\""}], ",", 
       RowBox[{"MinIntervalSize", "\[Rule]", "0.1"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"OpenerView", "[", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Solution\>\"", ",", "Bold", ",", " ", "Medium"}], "]"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"Column", "[", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<\[Omega]4  \>\"", ",", 
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"\[Omega]", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
                RowBox[{"Enabled", "\[Rule]", "False"}]}], "]"}]}], "}"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<\[Omega]5  \>\"", ",", 
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"\[Omega]", "[", 
                 RowBox[{"[", "5", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
                RowBox[{"Enabled", "\[Rule]", "False"}]}], "]"}]}], "}"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<\[Omega]6  \>\"", ",", 
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"\[Omega]", "[", 
                 RowBox[{"[", "6", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
                RowBox[{"Enabled", "\[Rule]", "False"}]}], "]"}]}], "}"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<\[Omega]7  \>\"", ",", 
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"\[Omega]", "[", 
                 RowBox[{"[", "7", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
                RowBox[{"Enabled", "\[Rule]", "False"}]}], "]"}]}], "}"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<\[Omega]8  \>\"", ",", 
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"\[Omega]", "[", 
                 RowBox[{"[", "8", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
                RowBox[{"Enabled", "\[Rule]", "False"}]}], "]"}]}], "}"}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<\[Omega]9  \>\"", ",", 
              RowBox[{"Slider", "[", 
               RowBox[{
                RowBox[{"\[Omega]", "[", 
                 RowBox[{"[", "9", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"-", "Pi"}], ",", "Pi"}], "}"}], ",", 
                RowBox[{"Enabled", "\[Rule]", "False"}]}], "]"}]}], "}"}], 
            "]"}]}], "}"}], "]"}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.695723321371716*^9, 3.6957233477244525`*^9}, {
   3.6957234760533085`*^9, 3.6957235098336396`*^9}, {3.695723735715779*^9, 
   3.6957237877536187`*^9}, {3.695723850173235*^9, 3.6957239031129613`*^9}, {
   3.695728140234626*^9, 3.695728170469324*^9}, {3.695728206912562*^9, 
   3.6957283189207373`*^9}, {3.6957302430448112`*^9, 3.695730251925662*^9}, {
   3.695730284192649*^9, 3.6957303072451687`*^9}, 3.6957303419698424`*^9, {
   3.6957303818606863`*^9, 3.695730385876433*^9}, {3.695730776871158*^9, 
   3.6957307799432144`*^9}, {3.695730913909477*^9, 3.695731056625264*^9}, {
   3.6957319251514997`*^9, 3.6957319315696564`*^9}, {3.6957321042594004`*^9, 
   3.6957321106365647`*^9}, {3.6957322295983095`*^9, 
   3.6957322502411985`*^9}, {3.695732413433252*^9, 3.695732417498835*^9}, {
   3.6957325188132176`*^9, 3.6957326476413317`*^9}, {3.6957327030329676`*^9, 
   3.6957327379451895`*^9}, {3.6957328580897083`*^9, 3.695732908861949*^9}, {
   3.695732976478773*^9, 3.695732988297332*^9}, {3.6957330608395104`*^9, 
   3.6957331084110994`*^9}, {3.6957331512650113`*^9, 3.6957331875252066`*^9}, 
   3.695733451581834*^9, {3.6957335101968355`*^9, 3.6957335723975716`*^9}, {
   3.695733630567013*^9, 3.6957336843221555`*^9}, {3.6957337403604355`*^9, 
   3.6957338169156723`*^9}, {3.695733865807949*^9, 3.695733871196596*^9}, {
   3.6957339622950974`*^9, 3.695733976453291*^9}, {3.695734172561076*^9, 
   3.6957341961862507`*^9}, {3.6957343224310236`*^9, 3.695734490364665*^9}, {
   3.6957345316085634`*^9, 3.6957345401498027`*^9}, {3.6957345864160423`*^9, 
   3.695734631603385*^9}, {3.6957347012036605`*^9, 3.6957347215090895`*^9}, {
   3.69573479380623*^9, 3.695734822739337*^9}, {3.695734874725807*^9, 
   3.695734922835139*^9}, {3.6957349678751855`*^9, 3.6957350309412208`*^9}, {
   3.6957350745613704`*^9, 3.695735083754054*^9}, {3.6957351324046464`*^9, 
   3.6957351801778193`*^9}, {3.695735237659878*^9, 3.6957352843844495`*^9}, 
   3.6957353270579834`*^9, {3.695735465755406*^9, 3.6957354886370554`*^9}, {
   3.6957355946776204`*^9, 3.695735604012744*^9}, {3.6957356352356386`*^9, 
   3.6957357853389974`*^9}, {3.695736023894952*^9, 3.695736029581028*^9}, {
   3.6957361614117217`*^9, 3.6957361738382483`*^9}, {3.6957362038644595`*^9, 
   3.695736210350934*^9}, {3.6957363377798505`*^9, 3.695736339913566*^9}, {
   3.695736388787493*^9, 3.695736395158078*^9}, {3.695736466272395*^9, 
   3.6957364681925907`*^9}, {3.6957365737824*^9, 3.6957367221996307`*^9}, {
   3.695736804774605*^9, 3.695736824849099*^9}, {3.695736870426489*^9, 
   3.6957368746607704`*^9}, {3.695737066994382*^9, 3.6957370745685244`*^9}, {
   3.695737180725799*^9, 3.6957373546184263`*^9}, {3.6957375699866943`*^9, 
   3.6957375998386583`*^9}, {3.6957377143178205`*^9, 3.695737742205675*^9}, {
   3.6957378110143795`*^9, 3.6957378850992956`*^9}, {3.6957379340609617`*^9, 
   3.695737934462038*^9}, {3.695738259762306*^9, 3.695738367274972*^9}, {
   3.695738409500598*^9, 3.6957384421132274`*^9}, {3.6957385706618986`*^9, 
   3.695738572694256*^9}, {3.695738612038187*^9, 3.69573864960015*^9}, 
   3.6957388507380824`*^9, {3.6957394459987955`*^9, 3.695739542795068*^9}, {
   3.6957396054892187`*^9, 3.6957396122208004`*^9}, {3.6957398838947153`*^9, 
   3.6957398874824905`*^9}, {3.6957406530594573`*^9, 3.695740661880864*^9}, {
   3.6957408944610014`*^9, 3.6957410066013136`*^9}, {3.6957410861236067`*^9, 
   3.6957411096802387`*^9}, {3.6957411462041087`*^9, 3.695741146320501*^9}, {
   3.6957411825985527`*^9, 3.69574118828378*^9}, {3.6957412376215544`*^9, 
   3.6957412475596485`*^9}, {3.695741432878501*^9, 3.695741446835599*^9}, {
   3.6957415063069725`*^9, 3.6957415325437765`*^9}, {3.6957416929362893`*^9, 
   3.6957418450245347`*^9}, 3.695741894746039*^9, {3.6957419279122915`*^9, 
   3.695741993636595*^9}, 3.6957420446016536`*^9, {3.695742091680943*^9, 
   3.6957421855837917`*^9}, {3.6957422226389103`*^9, 3.695742266516306*^9}, {
   3.69574234306454*^9, 3.695742385774511*^9}, {3.6957424775536404`*^9, 
   3.695742506889844*^9}, {3.6957425514568357`*^9, 3.695742633174608*^9}, {
   3.6957428115295515`*^9, 3.695742880306145*^9}, 3.6957491344650517`*^9, {
   3.6957493282972527`*^9, 3.6957493520816793`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["BPSolver", "Section",
 CellChangeTimes->{{3.6795571036686206`*^9, 3.679557113728629*^9}, {
  3.6811328435634823`*^9, 3.681132843691572*^9}, {3.6827019504120245`*^9, 
  3.6827019615548773`*^9}},
 Background->RGBColor[1, 1, 0.85]],

Cell[CellGroupData[{

Cell["Source Code", "Subsection",
 CellChangeTimes->{{3.679557165643343*^9, 3.6795571685082006`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\[IndentingNewLine]", 
    RowBox[{
    "BPGetNodePosition", ",", "\[IndentingNewLine]", "BPSolver", ",", 
     "\[IndentingNewLine]", "BPPlotEstimatedComplexity", ",", 
     "\[IndentingNewLine]", "BPSetXinit"}], "\[IndentingNewLine]", "]"}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BPSetXinit", "[", "G_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "numberOfAtoms", ",", "dAB", ",", "dAC", ",", "dBC", ",", "tABC"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numberOfAtoms", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"VertexList", "[", "G", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"X", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dAB", ",", "dAC", ",", "dBC"}], "}"}], "=", 
       RowBox[{"GetEdgeWeight", "[", 
        RowBox[{"G", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "\[UndirectedEdge]", "2"}], ",", 
           RowBox[{"1", "\[UndirectedEdge]", "3"}], ",", 
           RowBox[{"2", "\[UndirectedEdge]", "3"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "planar", " ", "rotation", " ", "angle", " ", "for", " ", "third", " ",
         "atom"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"tABC", "=", 
       RowBox[{"ArcCos", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"dAB", "^", "2"}], "+", 
           RowBox[{"dBC", "^", "2"}], "-", 
           RowBox[{"dAC", "^", "2"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", "dAB", "*", "dBC"}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "set", " ", "the", " ", "position", " ", "of", " ", "the", " ", 
        "three", " ", "first", " ", "points"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"X", "[", 
        RowBox[{"[", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "dAB"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "dAB"}], "+", 
            RowBox[{"dBC", "*", 
             RowBox[{"Cos", "[", "tABC", "]"}]}]}], ",", 
           RowBox[{"dBC", "*", 
            RowBox[{"Sin", "[", "tABC", "]"}]}], " ", ",", "0"}], "}"}]}], 
        "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "X", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BPGetNodePosition", "[", 
     RowBox[{"G_", ",", "X_", ",", "i_", ",", "branch_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Sets", " ", 
       RowBox[{"X", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "considering", " ", "the", " ", 
       "graph", " ", "G"}], ",", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"positions", " ", 
         RowBox[{"X", "[", 
          RowBox[{"[", "j", "]"}], "]"}], " ", "for", " ", "j"}], 
        "\[Element]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "-", "1"}], ",", 
           RowBox[{"i", "-", "2"}], ",", 
           RowBox[{"i", "-", "3"}]}], "}"}], " ", "and", " ", "branch", " ", 
         RowBox[{"(", 
          RowBox[{"0", " ", "or", " ", "1"}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", "   ", 
       RowBox[{
        StyleBox["G",
         FontSlant->"Italic"], ":", " ", 
        StyleBox[
         RowBox[{"graph", " ", "with", " ", "edges", " ", "information"}],
         FontWeight->"Plain"]}], ";", "\[IndentingNewLine]", "   ", 
       RowBox[{
        StyleBox["X",
         FontSlant->"Italic"], ":", " ", 
        StyleBox[
         RowBox[{"list", " ", "of", " ", "3", "D", " ", "coordinates"}],
         FontWeight->"Plain"]}], ";", "\[IndentingNewLine]", "   ", 
       RowBox[{
        StyleBox["i",
         FontSlant->"Italic"], ":", " ", 
        StyleBox[
         RowBox[{
         "index", " ", "of", " ", "the", " ", "coordinates", " ", "to", " ", 
          "be", " ", "calculated"}],
         FontWeight->"Plain"]}], ";", "\[IndentingNewLine]", "   ", 
       RowBox[{
        StyleBox["branch",
         FontSlant->"Italic"], ":", " ", 
        StyleBox[
         RowBox[{
         "specifies", " ", "which", " ", "of", " ", "the", " ", "two", " ", 
          "branches", " ", "should", " ", "be", " ", "considered"}],
         FontWeight->"Plain"]}], 
       StyleBox[";",
        FontWeight->"Plain"]}]}], "\[IndentingNewLine]", " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "j", ",", "u", ",", "v", ",", "a", ",", "b", ",", "c", ",", "delta", 
        ",", "dy", ",", "dz", ",", "dw", ",", "ky", ",", "kz", ",", "kw", ",",
         "A", ",", "x3", ",", "x", ",", "y", ",", "z", ",", "w"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"y", ",", "z", ",", "w"}], "}"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "j"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dy", ",", "dz", ",", "dw"}], "}"}], "=", 
        RowBox[{"GetEdgeWeight", "[", 
         RowBox[{"G", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "\[UndirectedEdge]", 
             RowBox[{"(", 
              RowBox[{"i", "-", "j"}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<dy=\>\"", ",", "dy", ",", "\"\< dz=\>\"", ",", "dz", ",", 
           "\"\< dw=\>\"", ",", "dw"}], "]"}], ";"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ky", ",", "kz", ",", "kw"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"dy", "^", "2"}], "-", 
           RowBox[{"y", ".", "y"}]}], ",", 
          RowBox[{
           RowBox[{"dz", "^", "2"}], "-", 
           RowBox[{"z", ".", "z"}]}], ",", 
          RowBox[{
           RowBox[{"dw", "^", "2"}], "-", 
           RowBox[{"w", ".", "w"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"set", " ", 
          RowBox[{"x", "[", 
           RowBox[{"1", ":", "2"}], "]"}]}], "=", 
         RowBox[{
          RowBox[{"u", "*", 
           RowBox[{"x", "[", "3", "]"}]}], "+", "v"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"A", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], "-", 
           RowBox[{"w", "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"u", "=", 
        RowBox[{"LinearSolve", "[", 
         RowBox[{"A", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"z", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "-", 
             RowBox[{"y", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"w", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "-", 
             RowBox[{"y", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{"LinearSolve", "[", 
         RowBox[{"A", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"kz", "-", "ky"}], ")"}], "/", "2"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"kw", "-", "ky"}], ")"}], "/", "2"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"set", "/", "solve"}], " ", "the", " ", "quadratic", " ", 
         "equation"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"u", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"u", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}]}], ";", 
       RowBox[{"v", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"v", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a", "=", 
        RowBox[{"u", ".", "u"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b", "=", 
        RowBox[{"2", "*", 
         RowBox[{"(", 
          RowBox[{"u", ".", 
           RowBox[{"(", 
            RowBox[{"v", "-", "y"}], ")"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{
         RowBox[{"v", ".", 
          RowBox[{"(", 
           RowBox[{"v", "-", 
            RowBox[{"2", "*", "y"}]}], ")"}]}], "-", "ky"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"delta", "=", 
        RowBox[{
         RowBox[{"b", "^", "2"}], "-", 
         RowBox[{"4", "*", "a", "*", "c"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"delta", "<", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"{", 
           RowBox[{"Infinity", ",", "Infinity", ",", "Infinity"}], "}"}], 
          "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "set", " ", "the", " ", "free", " ", "coordinate", " ", "avoiding", 
         " ", "canceling"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"b", ">", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"x3", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "b"}], "-", 
             RowBox[{"Sqrt", "[", "delta", "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "a"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"x3", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "b"}], "+", 
             RowBox[{"Sqrt", "[", "delta", "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", "a"}], ")"}]}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"branch", "\[Equal]", "1"}], ",", 
         RowBox[{"x3", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "b"}], "/", "a"}], ")"}], "-", "x3"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "output"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"x", "=", 
        RowBox[{
         RowBox[{"u", "*", "x3"}], "+", "v"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"y", ",", "z", ",", "w"}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<u=\>\"", ",", "u", ",", "\"\<x3=\>\"", ",", "x3"}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<a=\>\"", ",", "a", ",", "\"\< b=\>\"", ",", "b", ",", 
           "\"\< c=\>\"", ",", "c"}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<dy=\>\"", ",", 
           RowBox[{"Norm", "[", 
            RowBox[{"x", "-", "y"}], "]"}], ",", "\"\< dz=\>\"", ",", 
           RowBox[{"Norm", "[", 
            RowBox[{"x", "-", "z"}], "]"}], ",", "\"\< dw=\>\"", ",", 
           RowBox[{"Norm", "[", 
            RowBox[{"x", "-", "w"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<branch=\>\"", ",", "branch"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "x", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BPSolver", "[", "G_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Calculate", " ", "all", " ", "solutions", " ", "of", " ", "the", " ", 
      "DMDGP", " ", "instance", " ", "defined", " ", "by", " ", "the", " ", 
      "graph", " ", 
      RowBox[{"G", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"local", " ", "variables"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "j", ",", "tABC", ",", "dAB", ",", "dAC", ",", "dBC", ",", 
        "numberOfAtoms", ",", "prune", ",", "node", ",", "branch", ",", "X", 
        ",", "S", ",", "work", ",", 
        RowBox[{"tol", "=", "0.001"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"numberOfAtoms", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"VertexList", "[", "G", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "check", " ", "if", " ", "natural", " ", "order", " ", "is", " ", 
         "valid"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"IsNaturalOrderValid", "[", "G", "]"}], "]"}], ",", 
         RowBox[{"Throw", "[", "\"\<InvalidOrdering\>\"", "]"}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "init", " ", "atoms", " ", "positions", " ", "on", " ", "Euclidean", 
         " ", "3", "d", " ", "space"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"X", "=", 
        RowBox[{"BPSetXinit", "[", "G", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"init", " ", "BPTree"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"branch", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"branch", "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}], "=", 
          "1"}]}], "}"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"node", "=", "3"}], ",", 
         RowBox[{"prune", "=", "False"}]}], "}"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"work", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"work", "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}], "=", 
          "1"}]}], "}"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"BP", " ", "core"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<Points\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Branches\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}]}], "|>"}]}], ";", " ", 
       RowBox[{"(*", " ", "solutions", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{"True", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"go", " ", "to", " ", "next", " ", "node"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"prune", "||", " ", 
             RowBox[{"node", "\[Equal]", "numberOfAtoms"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "if", " ", "pruned", " ", "or", " ", "last", " ", "node"}], ",",
               " ", 
              RowBox[{
              "search", " ", "for", " ", "a", " ", "node", " ", "to", " ", 
               "branch"}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"i", "=", "node"}], ";", " ", 
             RowBox[{"prune", "=", "False"}], ";", "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{"i", ">", "0"}], ",", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"branch", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"branch", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", "1"}], ";", 
                   RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
                RowBox[{"i", "--"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"stop", " ", "criterion", " ", 
               RowBox[{"(", 
                RowBox[{
                "there", " ", "is", " ", "no", " ", "next", " ", "node"}], 
                ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[Equal]", "0"}], ",", 
               RowBox[{"Break", "[", "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"reset", " ", "lower", " ", 
               RowBox[{"(", 
                RowBox[{"until", " ", "k"}], ")"}], " ", "tree", " ", 
               "levels"}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", 
                RowBox[{"i", "+", "1"}]}], ",", 
               RowBox[{"j", "\[LessEqual]", "node"}], ",", 
               RowBox[{"j", "++"}], ",", 
               RowBox[{
                RowBox[{"branch", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "=", "0"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"node", "=", "i"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "if", " ", "not", " ", "pruned", " ", "nor", " ", "last", " ", 
               "node"}], ",", " ", 
              RowBox[{
              "just", " ", "go", " ", "to", " ", "the", " ", "child", " ", 
               "node"}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"node", "++"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"calculate", " ", "position", " ", "of", " ", "i"}], "-", 
            RowBox[{"th", " ", "node"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"work", "[", 
            RowBox[{"[", "node", "]"}], "]"}], "++"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{"[", "node", "]"}], "]"}], "=", 
           RowBox[{"BPGetNodePosition", "[", 
            RowBox[{"G", ",", "X", ",", "node", ",", 
             RowBox[{"branch", "[", 
              RowBox[{"[", "node", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "prune", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"CalculatePartialSolutionError", "[", 
              RowBox[{"G", ",", "X", ",", "node"}], "]"}], ">", "tol"}], ",", 
            RowBox[{
             RowBox[{"prune", "=", "True"}], ";", 
             RowBox[{"Continue", "[", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"new", " ", "solution", " ", "found"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"node", "\[Equal]", "numberOfAtoms"}], ",", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{
               RowBox[{"S", "[", "\"\<Points\>\"", "]"}], ",", "X"}], "]"}], 
             ";", 
             RowBox[{"AppendTo", "[", 
              RowBox[{
               RowBox[{"S", "[", "\"\<Branches\>\"", "]"}], ",", "branch"}], 
              "]"}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{"\"\<A total of \>\"", ",", " ", 
           RowBox[{"Length", "[", 
            RowBox[{"S", "[", "\"\<Points\>\"", "]"}], "]"}], ",", 
           "\"\< solutions has been found.\>\""}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"S", ",", "work"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BPPlotEstimatedComplexity", "[", "G_", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Estimates", " ", "a", " ", "tight", " ", "upper", " ", "bound", " ", 
     "to", " ", "the", " ", "number", " ", "of", " ", "solutions", " ", 
     "given", " ", "by", " ", "the", " ", "connectivity", " ", "graph", " ", 
     "G"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"local", " ", "variables"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "numberOfAtoms", ",", "i", ",", "j", ",", "k", ",", "work", ",", 
       "choices", ",", "V", ",", "R", ",", "reduced"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"IsNaturalOrderValid", "[", "G", "]"}], "]"}], ",", 
        RowBox[{"Throw", "[", "\"\<InvalidOrdering\>\"", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"numberOfAtoms", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"VertexList", "[", "G", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"work", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"work", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "=", "2"}]}], "}"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"choices", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"Infinity", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"choices", "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}], "]"}], 
         "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "}"}]}]}], "}"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "5"}], ",", 
        RowBox[{"i", "\[LessEqual]", "numberOfAtoms"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "only", " ", "edges", " ", "with", " ", "precedent", " ", 
          "vertices"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"V", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"AdjacencyList", "[", 
             RowBox[{"G", ",", "i"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#", "<", "i"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"work", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"2", "*", 
           RowBox[{"choices", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "V", "]"}], "<", "4"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "there", " ", "is", " ", "no", " ", "additional", " ", 
             "constraint"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"choices", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"work", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "take", " ", "the", " ", "four", " ", "most", " ", "restrictive", 
             " ", "constraints"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"R", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"choices", "[", 
                RowBox[{"[", 
                 RowBox[{"V", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", "V", "]"}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"minimal", " ", "number", " ", "of", " ", "choices"}], 
             " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"k", "=", 
             RowBox[{"RankedMin", "[", 
              RowBox[{"R", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "minimal", " ", "index", " ", "with", " ", "minimal", " ", 
              "number", " ", "of", " ", "choices"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"k", "=", 
             RowBox[{"Min", "[", 
              RowBox[{"Select", "[", 
               RowBox[{"V", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"choices", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "\[Equal]", "k"}], ")"}], 
                 "&"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "update", " ", "intermediate", " ", "number", " ", "of", " ", 
              "choices"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"j", "=", 
               RowBox[{"(", 
                RowBox[{"k", "+", "1"}], ")"}]}], ",", 
              RowBox[{"j", "\[LessEqual]", "i"}], ",", 
              RowBox[{"j", "++"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"choices", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ">", 
                 RowBox[{"choices", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"choices", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "=", 
                 RowBox[{"choices", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}]}], "]"}]}], "]"}], ";"}]}],
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Estimated number of Solutions \>\"", ",", 
        RowBox[{"choices", "[", 
         RowBox[{"[", "numberOfAtoms", "]"}], "]"}], ",", "\"\<.\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{"work", ",", 
        RowBox[{"Filling", "\[Rule]", "Axis"}], ",", " ", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", "\"\<Estimated\>\"", "}"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.679558175961939*^9, 3.6795582465756893`*^9}, {
   3.6795582826425705`*^9, 3.6795582839429235`*^9}, {3.6795657231676226`*^9, 
   3.6795657791530952`*^9}, {3.6795658130773067`*^9, 3.679565871544673*^9}, {
   3.6795861090630603`*^9, 3.679586268296414*^9}, {3.6795863005452967`*^9, 
   3.679586495840868*^9}, {3.6795865460918303`*^9, 3.6795865970915422`*^9}, {
   3.6795868432394185`*^9, 3.6795869018284483`*^9}, {3.679586939131709*^9, 
   3.679586976913601*^9}, {3.6795870626458464`*^9, 3.6795871011073523`*^9}, {
   3.6795871633176947`*^9, 3.679587758105817*^9}, {3.679587804838523*^9, 
   3.6795878406799817`*^9}, {3.6795881298229246`*^9, 3.679588139590253*^9}, {
   3.679588432141921*^9, 3.679588820678732*^9}, {3.67958885218464*^9, 
   3.679588859454245*^9}, {3.679591543221243*^9, 3.6795916551338434`*^9}, {
   3.679591702248043*^9, 3.679591773731745*^9}, {3.6795919722830153`*^9, 
   3.6795919729205785`*^9}, {3.6795920143454957`*^9, 
   3.6795920373721275`*^9}, {3.6795920942295294`*^9, 3.679592111174794*^9}, {
   3.6795921457433033`*^9, 3.6795921895011177`*^9}, {3.6795922813103876`*^9, 
   3.6795922980595803`*^9}, {3.679592407947278*^9, 3.6795924086627626`*^9}, {
   3.6795924498624945`*^9, 3.679592466754154*^9}, {3.679592757750784*^9, 
   3.679592801039822*^9}, {3.679592909747943*^9, 3.6795929608876143`*^9}, {
   3.679593939143162*^9, 3.6795940165402756`*^9}, {3.679594087903904*^9, 
   3.6795941883419476`*^9}, {3.679594287225954*^9, 3.6795943875196476`*^9}, {
   3.679594448595685*^9, 3.679594478828597*^9}, {3.6795945652724648`*^9, 
   3.6795946280032177`*^9}, {3.6795946789134407`*^9, 
   3.6795947026597376`*^9}, {3.679594776154107*^9, 3.6795948130815954`*^9}, {
   3.679594874794201*^9, 3.6795948828190813`*^9}, {3.6795949534488997`*^9, 
   3.6795949725060587`*^9}, {3.6795953069724016`*^9, 3.679595386091648*^9}, {
   3.6795955639765224`*^9, 3.6795956274997435`*^9}, {3.679595702271488*^9, 
   3.6795959233026123`*^9}, {3.679595965972151*^9, 3.6795959811159763`*^9}, {
   3.679596019161744*^9, 3.6795961007578773`*^9}, {3.679596138153123*^9, 
   3.679596343165894*^9}, {3.6795963808982925`*^9, 3.679596485412173*^9}, {
   3.679596522566841*^9, 3.6795965922679443`*^9}, {3.6795966325388813`*^9, 
   3.6795966980857244`*^9}, {3.679596732170254*^9, 3.679596952279262*^9}, {
   3.6795970019970694`*^9, 3.6795970768712177`*^9}, {3.679597120771289*^9, 
   3.679597123641965*^9}, {3.679597504661482*^9, 3.67959752405188*^9}, {
   3.6795977558745494`*^9, 3.679597791424835*^9}, 3.6795987087156878`*^9, {
   3.6795988192242517`*^9, 3.67959883584793*^9}, {3.679598870164411*^9, 
   3.6795991011240025`*^9}, {3.679599318938053*^9, 3.679599340969948*^9}, {
   3.6795993740469303`*^9, 3.679599392408225*^9}, {3.679599446418444*^9, 
   3.6795994936803236`*^9}, {3.6795995268675137`*^9, 3.6795995571197987`*^9}, 
   3.679599593529305*^9, {3.6795996462842827`*^9, 3.679599664667951*^9}, 
   3.6796000535012045`*^9, {3.6796005685888577`*^9, 3.6796006406104794`*^9}, {
   3.679600696928871*^9, 3.6796007267160053`*^9}, {3.6796008413370132`*^9, 
   3.6796008545284967`*^9}, {3.6796009031430583`*^9, 
   3.6796009310933266`*^9}, {3.6796010302991343`*^9, 3.67960105103058*^9}, {
   3.679601123591203*^9, 3.6796011690061445`*^9}, {3.6796012042311897`*^9, 
   3.6796012284117613`*^9}, {3.6796013171753454`*^9, 
   3.6796013538183103`*^9}, {3.679678803727684*^9, 3.6796788489988422`*^9}, {
   3.6796789029728556`*^9, 3.679678973714923*^9}, {3.679679007940275*^9, 
   3.6796790171013775`*^9}, {3.6796791140754843`*^9, 3.679679297244875*^9}, {
   3.679679330413969*^9, 3.6796793579806814`*^9}, {3.6796794551957006`*^9, 
   3.6796794760541725`*^9}, {3.679679575327817*^9, 3.6796796729758596`*^9}, {
   3.679679868010354*^9, 3.6796800326147842`*^9}, {3.6796800872006283`*^9, 
   3.679680109202219*^9}, {3.6796801598977137`*^9, 3.679680170399706*^9}, {
   3.679680211818449*^9, 3.6796804482737713`*^9}, {3.6796805112298536`*^9, 
   3.6796805744565773`*^9}, {3.6796806218580914`*^9, 3.679680757892975*^9}, {
   3.679680811495949*^9, 3.6796808818651915`*^9}, {3.6796809144827785`*^9, 
   3.6796809666833677`*^9}, {3.6796810029485235`*^9, 
   3.6796810081740055`*^9}, {3.6796810575156417`*^9, 
   3.6796811033995237`*^9}, {3.679681332527998*^9, 3.6796813333625546`*^9}, {
   3.6796813807917876`*^9, 3.67968147752941*^9}, {3.679681563739986*^9, 
   3.6796815769607897`*^9}, {3.6796817221757703`*^9, 3.679681763490862*^9}, {
   3.679681838781067*^9, 3.6796818408804646`*^9}, {3.6796818894447145`*^9, 
   3.679682079969407*^9}, {3.679682121825989*^9, 3.6796821248530035`*^9}, {
   3.679682265526948*^9, 3.679682306277526*^9}, {3.6796823673326397`*^9, 
   3.679682384445038*^9}, {3.6796824443186035`*^9, 3.679682475464719*^9}, {
   3.6796825288595295`*^9, 3.6796825637327585`*^9}, {3.67968278119676*^9, 
   3.679682782882883*^9}, {3.6797345890383964`*^9, 3.6797346061187067`*^9}, {
   3.679734645268098*^9, 3.679734678069255*^9}, {3.679734719550336*^9, 
   3.679734728336152*^9}, {3.679734851985812*^9, 3.6797348613539844`*^9}, {
   3.6797349632167463`*^9, 3.6797349754570136`*^9}, {3.679735010318187*^9, 
   3.679735089425761*^9}, {3.6797352029473877`*^9, 3.6797352174003067`*^9}, {
   3.679735334219095*^9, 3.6797353520668097`*^9}, {3.6797354127852964`*^9, 
   3.6797354225972743`*^9}, {3.6797356146960435`*^9, 3.6797356233076*^9}, {
   3.679735670171296*^9, 3.679735748032075*^9}, {3.679735818469843*^9, 
   3.679735848457308*^9}, {3.67973596027987*^9, 3.679735975920292*^9}, {
   3.6797360359884872`*^9, 3.679736087721181*^9}, {3.6797362491591873`*^9, 
   3.679736251571519*^9}, {3.6797363112665663`*^9, 3.67973638863768*^9}, {
   3.6797365176603727`*^9, 3.679736520301809*^9}, {3.679736670119876*^9, 
   3.6797367431527596`*^9}, {3.679756482791448*^9, 3.679756557876812*^9}, {
   3.6797567570184045`*^9, 3.6797567594612527`*^9}, {3.6797567906860046`*^9, 
   3.679756802275606*^9}, {3.6797568773893633`*^9, 3.679756886271783*^9}, {
   3.679757001405609*^9, 3.6797570054216137`*^9}, {3.679757180744531*^9, 
   3.6797572214769106`*^9}, {3.6797572539267645`*^9, 
   3.6797572552707305`*^9}, {3.679757302135573*^9, 3.679757309602027*^9}, {
   3.6797576159368067`*^9, 3.679757640960533*^9}, {3.6797577488837395`*^9, 
   3.6797577653388815`*^9}, {3.6797577958104706`*^9, 3.679757803108025*^9}, {
   3.6797578760871897`*^9, 3.6797578901608458`*^9}, {3.679758056388175*^9, 
   3.679758057856022*^9}, {3.679758116808442*^9, 3.679758142175377*^9}, {
   3.6797583149135833`*^9, 3.679758607202947*^9}, {3.679758663127587*^9, 
   3.6797586884288898`*^9}, {3.679759119373311*^9, 3.679759252843992*^9}, {
   3.679760070123723*^9, 3.679760141715478*^9}, {3.6797601874366446`*^9, 
   3.67976021978776*^9}, {3.679761268846787*^9, 3.6797613467221656`*^9}, {
   3.6797613820967917`*^9, 3.679761404174221*^9}, {3.6797614488257165`*^9, 
   3.6797615135316324`*^9}, {3.6797616958144684`*^9, 3.679761727076391*^9}, {
   3.6797629611339755`*^9, 3.6797630599393997`*^9}, {3.6797632969326744`*^9, 
   3.6797633450875072`*^9}, {3.6797633864858117`*^9, 3.679763417622408*^9}, {
   3.679763454154428*^9, 3.679763458232932*^9}, {3.679763559460507*^9, 
   3.679763559766924*^9}, {3.67976360142772*^9, 3.679763602011773*^9}, {
   3.679763652514624*^9, 3.6797636554635086`*^9}, {3.6797636883303623`*^9, 
   3.6797636933229237`*^9}, {3.679763739648059*^9, 3.6797637500153637`*^9}, {
   3.6797638017358065`*^9, 3.679763821403262*^9}, {3.6797639540004077`*^9, 
   3.679763967875004*^9}, {3.679764012996402*^9, 3.679764053151238*^9}, {
   3.679764105585392*^9, 3.6797641333006964`*^9}, {3.679764241169329*^9, 
   3.6797642550419507`*^9}, {3.6797642965486746`*^9, 
   3.6797642974911604`*^9}, {3.679766312258819*^9, 3.6797663400081835`*^9}, {
   3.6797665204820805`*^9, 3.6797666179276123`*^9}, {3.6797666878843207`*^9, 
   3.679766700259632*^9}, 3.679766730824309*^9, {3.67976678431518*^9, 
   3.6797667911152844`*^9}, {3.679766899700026*^9, 3.6797669126934752`*^9}, {
   3.6797669454005632`*^9, 3.679766965008849*^9}, {3.6797670469007864`*^9, 
   3.6797670576985207`*^9}, {3.679767112514214*^9, 3.6797671303351617`*^9}, {
   3.6797675537044563`*^9, 3.6797676224830623`*^9}, {3.679767976648643*^9, 
   3.6797680158816223`*^9}, {3.679768074496215*^9, 3.6797680775963783`*^9}, {
   3.6797683593332515`*^9, 3.6797683759920163`*^9}, {3.6797689343634205`*^9, 
   3.67976894926108*^9}, {3.679769294256039*^9, 3.679769332344527*^9}, {
   3.6798191469974074`*^9, 3.679819160356634*^9}, 3.6798192106398354`*^9, {
   3.67981926129202*^9, 3.679819264210451*^9}, {3.6798201118432903`*^9, 
   3.6798201155779047`*^9}, {3.679820335384288*^9, 3.679820377209854*^9}, {
   3.679820499748266*^9, 3.679820500648081*^9}, {3.6798205849449463`*^9, 
   3.679820599020897*^9}, {3.679820651543778*^9, 3.679820717123869*^9}, 
   3.6798208645536685`*^9, {3.679820946173946*^9, 3.6798209585549765`*^9}, {
   3.6798211650566034`*^9, 3.679821179641118*^9}, {3.6798212774784584`*^9, 
   3.6798212833238792`*^9}, {3.6798215653792295`*^9, 3.67982157108221*^9}, {
   3.679821616893424*^9, 3.679821653145285*^9}, {3.6798222987882447`*^9, 
   3.6798223432753534`*^9}, 3.679822416580861*^9, {3.679822823372448*^9, 
   3.6798228417201242`*^9}, {3.679823267991959*^9, 3.6798232844684114`*^9}, {
   3.679826381840706*^9, 3.67982643359863*^9}, 3.6798265156658287`*^9, {
   3.6798266225012636`*^9, 3.679826673734756*^9}, {3.679826743782586*^9, 
   3.679826770138029*^9}, {3.6798288730382085`*^9, 3.6798288749212675`*^9}, 
   3.679830925818262*^9, {3.6799122356862607`*^9, 3.679912420141233*^9}, 
   3.679912621838517*^9, {3.679912660005648*^9, 3.6799127645180964`*^9}, {
   3.679912796764311*^9, 3.679912833673414*^9}, {3.679912923419185*^9, 
   3.6799130110394573`*^9}, {3.6799132053019743`*^9, 
   3.6799132383140087`*^9}, {3.6799132802516465`*^9, 3.67991331943956*^9}, {
   3.679913510472663*^9, 3.6799136126746993`*^9}, {3.6799143039934287`*^9, 
   3.679914498499134*^9}, {3.6799146006025815`*^9, 3.679914665572703*^9}, {
   3.6799147788339305`*^9, 3.6799147832198434`*^9}, {3.679915529268517*^9, 
   3.6799155521864934`*^9}, {3.6799163694288054`*^9, 
   3.6799163759577293`*^9}, {3.679916633719616*^9, 3.6799166874558907`*^9}, {
   3.6799167701444783`*^9, 3.6799167738622227`*^9}, {3.6799168079043493`*^9, 
   3.6799168533126335`*^9}, {3.679916959985268*^9, 3.6799169731612396`*^9}, 
   3.6799170200748706`*^9, {3.6799171302212915`*^9, 3.679917141185356*^9}, {
   3.679917187615794*^9, 3.6799171931360073`*^9}, {3.679917338879426*^9, 
   3.679917349384443*^9}, {3.6799174136620827`*^9, 3.6799174401714363`*^9}, {
   3.6799175166104527`*^9, 3.6799175282932596`*^9}, 3.6799178373631587`*^9, {
   3.6799179537059784`*^9, 3.6799179803577185`*^9}, {3.67991866146945*^9, 
   3.6799187062925053`*^9}, {3.679918827393654*^9, 3.6799189074639287`*^9}, {
   3.6799189626153173`*^9, 3.6799189686805744`*^9}, {3.6799190280052376`*^9, 
   3.6799190455061207`*^9}, {3.6799190972022314`*^9, 3.679919125280387*^9}, {
   3.679924566119967*^9, 3.679924604385762*^9}, {3.6799246642790704`*^9, 
   3.6799246956132803`*^9}, {3.6799247527275844`*^9, 
   3.6799247930164156`*^9}, {3.679924951195854*^9, 3.6799249803781705`*^9}, {
   3.679925022623218*^9, 3.6799250488316956`*^9}, {3.6799253861656322`*^9, 
   3.6799254381888103`*^9}, {3.6799255434641275`*^9, 3.679925616718331*^9}, {
   3.679925661348341*^9, 3.679925698259054*^9}, {3.67992573602477*^9, 
   3.6799257478959365`*^9}, {3.6799258174994507`*^9, 
   3.6799259665814676`*^9}, {3.679926003783972*^9, 3.679926024748337*^9}, {
   3.679926069235965*^9, 3.6799260902291036`*^9}, {3.6799261736068425`*^9, 
   3.679926196432872*^9}, {3.679926255248601*^9, 3.6799262580962477`*^9}, {
   3.679926293552193*^9, 3.679926293751954*^9}, {3.6799263246875305`*^9, 
   3.67992632905294*^9}, {3.6799263775010214`*^9, 3.6799264110418615`*^9}, {
   3.6799264515895023`*^9, 3.679926470697673*^9}, {3.6799267773032274`*^9, 
   3.6799268074427676`*^9}, {3.6799273312718644`*^9, 
   3.6799273548658895`*^9}, {3.6799274096231394`*^9, 
   3.6799274791310563`*^9}, {3.6802492252310677`*^9, 
   3.6802494747564917`*^9}, {3.680249508550872*^9, 3.6802495430476055`*^9}, {
   3.680249675725598*^9, 3.6802497003809333`*^9}, 3.68024975508574*^9, {
   3.680256236853915*^9, 3.6802562600900726`*^9}, {3.68025634441387*^9, 
   3.680256365234165*^9}, {3.6802567065770197`*^9, 3.6802567081447225`*^9}, {
   3.68025976930814*^9, 3.6802597702248554`*^9}, {3.6802649405067997`*^9, 
   3.6802650359517117`*^9}, {3.680265067363373*^9, 3.6802650674600096`*^9}, {
   3.6802651867038527`*^9, 3.680265190137226*^9}, {3.680265223704136*^9, 
   3.680265238230487*^9}, {3.680265490528492*^9, 3.6802655052228985`*^9}, {
   3.680265558508396*^9, 3.680265561709672*^9}, {3.6808879559628687`*^9, 
   3.680888011732835*^9}, {3.6809606117806787`*^9, 3.6809606203078012`*^9}, 
   3.6809606847064285`*^9, {3.6809675539292154`*^9, 3.6809675860694647`*^9}, {
   3.6809692430036077`*^9, 3.680969426149309*^9}, {3.680969611597622*^9, 
   3.680969678171399*^9}, {3.6809717051663656`*^9, 3.680971757266692*^9}, {
   3.681049731545925*^9, 3.6810497326806526`*^9}, {3.6815751098190413`*^9, 
   3.6815752193084803`*^9}, {3.681575314417507*^9, 3.6815753681505737`*^9}, 
   3.6815761221030645`*^9, {3.6827804798722897`*^9, 3.682780494816037*^9}, 
   3.682780604217006*^9, {3.682781704192978*^9, 3.682781710459713*^9}, {
   3.682781876637768*^9, 3.682781904072253*^9}, {3.6827830443626947`*^9, 
   3.6827830549350944`*^9}, {3.682783127758354*^9, 3.6827832541087*^9}, {
   3.682783660581412*^9, 3.6827836734256077`*^9}, {3.682783792501422*^9, 
   3.682783800043203*^9}, {3.682783844406822*^9, 3.682783854282976*^9}, {
   3.6827840511165624`*^9, 3.682784068157834*^9}, {3.68278424789962*^9, 
   3.682784265851144*^9}, {3.6827844475525365`*^9, 3.6827845018196874`*^9}, {
   3.682784564540927*^9, 3.682784585555146*^9}, {3.682784632517503*^9, 
   3.6827846755811577`*^9}, {3.6827849678890543`*^9, 
   3.6827849698689795`*^9}, {3.6827850127031283`*^9, 3.682785092085968*^9}, {
   3.6827851570326347`*^9, 3.682785214146377*^9}, {3.6827852794649224`*^9, 
   3.6827852820630054`*^9}, {3.682785312889785*^9, 3.682785314900358*^9}, {
   3.682874358256663*^9, 3.682874360903284*^9}, {3.682934839631378*^9, 
   3.682934847817806*^9}, 3.682935758206027*^9, {3.6830328654542093`*^9, 
   3.683032867551629*^9}, 3.683032898094671*^9, {3.693310963628379*^9, 
   3.6933111790311046`*^9}, {3.693311218561573*^9, 3.6933112303168716`*^9}, {
   3.693311272066084*^9, 3.6933113625963125`*^9}, {3.6950523845124087`*^9, 
   3.6950523866515436`*^9}, {3.695052424890731*^9, 3.6950524370506387`*^9}, {
   3.6961619545602474`*^9, 3.6961620702824574`*^9}, {3.696338889049758*^9, 
   3.6963338496056805`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples and Applications", "Subsection",
 CellChangeTimes->{{3.6797567333782396`*^9, 3.6797567347311673`*^9}, {
  3.696335502893475*^9, 3.6963355050803843`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Calculating the number of solution as a function of the number of constraints \
(max distance)\
\>", "Subsubsection",
 CellChangeTimes->{{3.6963367238175445`*^9, 3.696336771716816*^9}, {
  3.6963368649082575`*^9, 3.6963368697017374`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"set", " ", "graph"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"G", "=", 
     RowBox[{
      RowBox[{"GenerateRandomMDGP", "[", 
       RowBox[{"10", ",", "Infinity"}], "]"}], "[", "\"\<G\>\"", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"allEdges", "=", 
     RowBox[{"EdgeList", "[", "G", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6963367766261096`*^9, 3.696336853892625*^9}, {
   3.696336892293545*^9, 3.6963371384809976`*^9}, {3.696337170280875*^9, 
   3.696337325083685*^9}, {3.6963373605819707`*^9, 3.696337421651475*^9}, 
   3.696337739584914*^9, {3.696337913015826*^9, 3.6963379215473475`*^9}, {
   3.696338446547945*^9, 3.696338511679804*^9}, {3.696338708052107*^9, 
   3.6963387335044403`*^9}, {3.6963392186813564`*^9, 3.696339351235952*^9}, {
   3.696339419103191*^9, 3.6963395733252993`*^9}, {3.6963396103098803`*^9, 
   3.69633284318084*^9}, {3.696333288665927*^9, 3.696333288881198*^9}, {
   3.6963336924953947`*^9, 3.6963337924287996`*^9}, {3.696333859526044*^9, 
   3.6963338642055693`*^9}, {3.69633390422436*^9, 3.6963339122002654`*^9}, {
   3.696333993525669*^9, 3.696334018920193*^9}, {3.696339787915368*^9, 
   3.6963398001768866`*^9}}],

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<ErrorBarPlots`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nSample", "=", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"density", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0.1", ",", "0.2", ",", "0.3", ",", "0.4", ",", "0.5"}],
     "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nSols", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "density", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "nSample"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"g", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "density", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "nSample"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ",", 
    RowBox[{"i", "\[LessEqual]", 
     RowBox[{"Length", "[", "density", "]"}]}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"d", "=", 
      RowBox[{"density", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", "nSample"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"create", " ", "subgraph"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"gij", "=", "G"}], ";", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"k", "=", "1"}], ",", 
          RowBox[{"k", "\[LessEqual]", 
           RowBox[{"Length", "[", "allEdges", "]"}]}], ",", 
          RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ek", "=", 
            RowBox[{"allEdges", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"RandomReal", "[", "]"}], ">", "d"}], "&&", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"ek", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", 
                 RowBox[{"ek", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ">", "3"}]}], ",", 
             RowBox[{"gij", "=", 
              RowBox[{"EdgeDelete", "[", 
               RowBox[{"gij", ",", "ek"}], "]"}]}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", "gij"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"solve", " ", "instance"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"S", ",", "work"}], "}"}], "=", 
         RowBox[{"BPSolver", "[", "gij", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"nSols", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", 
         RowBox[{"Length", "[", 
          RowBox[{"S", "[", "\"\<Points\>\"", "]"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ErrorListPlot", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"density", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"Mean", "[", 
          RowBox[{"nSols", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"ErrorBar", "[", 
        RowBox[{"StandardDeviation", "[", 
         RowBox[{"nSols", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "density", "]"}]}], "}"}]}], "]"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
     "\"\<Density of Edges\>\"", ",", " ", "\"\<Number of Solutions\>\""}], 
     "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.696334028602558*^9, 3.6963341389390335`*^9}, {
   3.696334203814807*^9, 3.696334553004195*^9}, {3.6963345893136067`*^9, 
   3.6963346447828355`*^9}, {3.6963346937306294`*^9, 
   3.6963348195399055`*^9}, {3.6963348799142075`*^9, 
   3.6963348804536867`*^9}, {3.696334945896783*^9, 3.6963349840214233`*^9}, {
   3.696335032797847*^9, 3.6963351414831853`*^9}, {3.6963352043938837`*^9, 
   3.696335230724231*^9}, {3.696335343802195*^9, 3.6963353555009074`*^9}, 
   3.696335412777022*^9, {3.696339497682501*^9, 3.6963395030722947`*^9}, {
   3.696339541525276*^9, 3.6963395556060305`*^9}, {3.69634027449716*^9, 
   3.6963403350733366`*^9}}],

Cell[BoxData[
 RowBox[{"nSols", "[", 
  RowBox[{"[", 
   RowBox[{"-", "3"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.696339938694536*^9, 3.6963400601940937`*^9}, {
  3.6963403646598105`*^9, 3.6963404076633387`*^9}, {3.6963406935535345`*^9, 
  3.696340694114237*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"MatrixPlot", "[", 
     RowBox[{
      RowBox[{"UpperTriangularize", "[", 
       RowBox[{
        RowBox[{"AdjacencyMatrix", "[", 
         RowBox[{
          RowBox[{"g", "[", 
           RowBox[{"[", 
            RowBox[{"-", "3"}], "]"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "3"}], "]"}], ",", 
      RowBox[{"MaxPlotPoints", "\[Rule]", "Infinity"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"MatrixPlot", "[", 
     RowBox[{"UpperTriangularize", "[", 
      RowBox[{
       RowBox[{"AdjacencyMatrix", "[", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"[", 
           RowBox[{"-", "3"}], "]"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"-", "4"}], "]"}], "]"}], "]"}], ",", "3"}], "]"}], "]"}]}],
    "}"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.696340412385273*^9, 3.6963404676489906`*^9}, {
  3.6963405240666523`*^9, 3.696340565290621*^9}, {3.696340632541873*^9, 
  3.6963406535339193`*^9}, {3.6963407008068347`*^9, 3.6963407118578453`*^9}, {
  3.6963407685490494`*^9, 3.696340774488199*^9}, {3.6963408054079695`*^9, 
  3.6963408386302795`*^9}, {3.696340880359873*^9, 3.69634088049673*^9}, {
  3.696340944228788*^9, 3.6963410088258734`*^9}}],

Cell[BoxData[{
 RowBox[{"M", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Circle", "[", "]"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"Circle", "[", "]"}]}], "}"}]}], 
   "}"}]}], "\[IndentingNewLine]", "MatrixForm"}], "Input",
 CellChangeTimes->{{3.696340857956562*^9, 3.696340873720018*^9}, {
  3.6963410137434177`*^9, 3.6963410550983295`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"S", ",", "work"}], "}"}], "=", 
   RowBox[{"BPSolver", "[", "G", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6963387670699315`*^9, 3.6963387800416546`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"meanNSols", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Mean", "[", 
      RowBox[{
       RowBox[{"nsols", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "nAtoms", "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", "maxDistance", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"meanEdges", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Mean", "[", 
       RowBox[{
        RowBox[{"nedges", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "[", 
        RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "nAtoms", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", "maxDistance", "]"}]}], "}"}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"plot", " ", "nsols"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"maxDistance", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"meanNSols", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "maxDistance", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", "meanNSols", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ListLinePlot", "[", 
   RowBox[{"data", ",", 
    RowBox[{"PlotLegends", "\[Rule]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"\"\<N=\>\"", ",", " ", 
         RowBox[{"ToString", "[", 
          RowBox[{"nAtoms", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{"Length", "[", "nAtoms", "]"}]}], "}"}]}], "]"}]}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"plot", " ", "nedges"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"maxDistance", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"meanEdges", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "maxDistance", "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", 
       RowBox[{"Length", "[", "meanNSols", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListLinePlot", "[", 
  RowBox[{"data", ",", 
   RowBox[{"PlotLabels", "\[Rule]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"StringJoin", "[", 
       RowBox[{"\"\<N=\>\"", ",", " ", 
        RowBox[{"ToString", "[", 
         RowBox[{"nAtoms", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", 
        RowBox[{"Length", "[", "nAtoms", "]"}]}], "}"}]}], "]"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6963379672508593`*^9, 3.6963379694831176`*^9}, {
  3.696338010976943*^9, 3.6963381548334093`*^9}, {3.6963381916028175`*^9, 
  3.6963384040035057`*^9}, {3.696338527893609*^9, 3.696338598064825*^9}, {
  3.696338630376333*^9, 3.6963386364154863`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Solving an instance using BPSolver", "Subsubsection",
 CellChangeTimes->{{3.6963389126720867`*^9, 3.6963389272834187`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"GenerateRandomMDGP", "[", 
    RowBox[{"5", ",", "3"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"M", "[", "\"\<G\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"S", ",", "work"}], "}"}], "=", 
  RowBox[{"BPSolver", "[", 
   RowBox[{"M", "[", "\"\<G\>\"", "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.693311450156807*^9, 3.693311476044976*^9}, {
  3.696338936452612*^9, 3.696338990378742*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Estimating the number of solutions", "Subsubsection",
 CellChangeTimes->{{3.696335480837241*^9, 3.6963354910600057`*^9}}],

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"M", "=", 
    RowBox[{"GenerateRandomMDGP", "[", 
     RowBox[{"7", ",", "4"}], "]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"M", "[", "\"\<X\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"M", "[", "\"\<G\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"S", ",", "work"}], "}"}], "=", 
    RowBox[{"BPSolver", "[", "G", "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"work", ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
     RowBox[{"PlotMarkers", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "Small"}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", "\"\<Real\>\"", "}"}]}]}], "]"}], ",", 
   RowBox[{"BPPlotEstimatedComplexity", "[", "G", "]"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"HoldForm", "[", 
       RowBox[{"Atom", " ", "ID"}], "]"}], ",", 
      RowBox[{"HoldForm", "[", 
       RowBox[{"Computed", " ", "Locations"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{"HoldForm", "[", 
     RowBox[{"Computational", " ", "Effort"}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CheckMDGPSolutionQuality", "[", 
   RowBox[{"G", ",", 
    RowBox[{
     RowBox[{"S", "[", "\"\<Points\>\"", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"MatrixPlot", "[", 
    RowBox[{
     RowBox[{"WeightedAdjacencyMatrix", "[", "G", "]"}], ",", 
     RowBox[{"ColorFunction", "->", "\"\<TemperatureMap\>\""}]}], "]"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"MatrixPlot", "[", 
    RowBox[{
     RowBox[{"WeightedAdjacencyMatrix", "[", "G", "]"}], ",", 
     RowBox[{"ColorFunction", "->", "\"\<Monochrome\>\""}]}], "]"}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6798218509178233`*^9, 3.679821852271891*^9}, {
   3.6798220754379344`*^9, 3.6798220755372047`*^9}, {3.679822744321784*^9, 
   3.6798227445214615`*^9}, {3.6798231052765684`*^9, 3.679823107593405*^9}, 
   3.679823226558363*^9, {3.6798233451775875`*^9, 3.679823345308581*^9}, {
   3.679823525737986*^9, 3.679823549906366*^9}, {3.6798263139146395`*^9, 
   3.679826344570452*^9}, {3.6798288602280912`*^9, 3.6798288604903975`*^9}, {
   3.6798288950564623`*^9, 3.679828994620492*^9}, {3.679829044969572*^9, 
   3.6798290909698343`*^9}, {3.6798294100005565`*^9, 
   3.6798294105697436`*^9}, {3.6798295004715223`*^9, 
   3.6798295681002893`*^9}, {3.6798296319378924`*^9, 3.679829632507357*^9}, {
   3.6798299800985794`*^9, 3.6798299863477526`*^9}, {3.679830157933735*^9, 
   3.6798301597117043`*^9}, {3.6798302974701996`*^9, 
   3.6798303164031887`*^9}, {3.6798303891181116`*^9, 3.679830389302563*^9}, {
   3.6798304759096456`*^9, 3.679830478014727*^9}, {3.6799119298147106`*^9, 
   3.6799119406954846`*^9}, {3.679912001613147*^9, 3.679912019708365*^9}, {
   3.6799121456440763`*^9, 3.6799121778114533`*^9}, 3.679912535631927*^9, {
   3.6799174812432394`*^9, 3.6799174816978993`*^9}, {3.679918592547327*^9, 
   3.6799186296132526`*^9}, {3.6799255011209993`*^9, 
   3.6799255012742624`*^9}, {3.6799265772569237`*^9, 
   3.6799266196275845`*^9}, {3.679927091468864*^9, 3.6799271177650127`*^9}, {
   3.679927217233017*^9, 3.679927233987025*^9}, {3.679927271460558*^9, 
   3.679927271760435*^9}, {3.679927363032942*^9, 3.679927363786351*^9}, 
   3.6799274640577226`*^9, {3.6799274956489134`*^9, 3.6799275047564964`*^9}, {
   3.6802494864436903`*^9, 3.680249517698353*^9}, {3.680249838745507*^9, 
   3.680249885493765*^9}, {3.6802499632347374`*^9, 3.68024997989824*^9}, {
   3.6802500278218193`*^9, 3.680250042557376*^9}, {3.6802500816458673`*^9, 
   3.680250094230627*^9}, {3.6802501729429226`*^9, 3.680250245242584*^9}, {
   3.680250277069769*^9, 3.680250349656209*^9}, {3.6802561938862762`*^9, 
   3.680256217314024*^9}, {3.6802562822999315`*^9, 3.6802562845355077`*^9}, {
   3.680259514448849*^9, 3.68025956932335*^9}, {3.680259617915313*^9, 
   3.680259625069577*^9}, {3.6802596588968315`*^9, 3.6802596591149898`*^9}, {
   3.6802597057100697`*^9, 3.680259710865752*^9}, {3.680259778882868*^9, 
   3.680259779298339*^9}, {3.6802598345877275`*^9, 3.6802598347003174`*^9}, {
   3.6802634539441957`*^9, 3.6802634724224014`*^9}, {3.680264125324051*^9, 
   3.680264127539488*^9}, {3.680971309238633*^9, 3.6809713321665344`*^9}, {
   3.6809713775361547`*^9, 3.680971388619849*^9}, 3.680971453133582*^9, {
   3.6809717846377277`*^9, 3.6809717933103046`*^9}, 3.682752354734047*^9, 
   3.682757377902835*^9, {3.6827585847612524`*^9, 3.682758585270115*^9}, {
   3.682758922849889*^9, 3.6827589310888653`*^9}, 3.682758963373986*^9}]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Solving Manually: Discrete Problem", "Section",
 CellChangeTimes->{{3.6957228443800993`*^9, 3.695722871251212*^9}, {
  3.696000820192024*^9, 3.6960008204222765`*^9}, {3.6960009494192247`*^9, 
  3.6960009726613865`*^9}}],

Cell[CellGroupData[{

Cell["Source : CreateTreeGraphFromBranches", "Subsection",
 CellChangeTimes->{{3.6961557444343433`*^9, 3.6961557587634087`*^9}, 
   3.696155818567206*^9}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "CreateTreeGraphFromBranches", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateTreeGraphFromBranches", "[", 
    RowBox[{"G_", ",", "branch_", ",", "branches_", ",", "check_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"T", ",", "X", ",", "k", ",", "i", ",", "n", ",", "b", ",", 
       RowBox[{"edges", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"v", "=", 
        RowBox[{"{", "}"}]}], ",", "styVertex", ",", 
       RowBox[{"styEdges", "=", 
        RowBox[{"{", "}"}]}], ",", "m", ",", "color", ",", "valid"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"n", "=", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"VertexList", "[", "G", "]"}], "]"}], "-", "3"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"creating", " ", "edges"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", 
         RowBox[{
          RowBox[{"2", "^", "n"}], "-", "1"}]}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"edges", ",", 
           RowBox[{"k", "\[UndirectedEdge]", 
            RowBox[{"2", "k"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"edges", ",", 
           RowBox[{"k", "\[UndirectedEdge]", 
            RowBox[{
             RowBox[{"2", "k"}], "+", "1"}]}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"highlighting", " ", "current", " ", "branch"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "0"}], ",", 
        RowBox[{"k", "\[LessEqual]", "n"}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"AppendTo", "[", 
          RowBox[{"v", ",", 
           RowBox[{"FromDigits", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"{", "1", "}"}], ",", 
               RowBox[{"branch", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ";;", "k"}], "]"}], "]"}]}], "]"}], ",", "2"}], 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"k", ">", "0"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"styEdges", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"v", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "\[UndirectedEdge]", 
               RowBox[{"v", "[", 
                RowBox[{"[", 
                 RowBox[{"k", "+", "1"}], "]"}], "]"}]}], "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Blue", ",", 
                RowBox[{"Thickness", "[", "0.01", "]"}]}], "}"}]}]}], "]"}]}],
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"coloring", " ", "visited", " ", "nodes", " ", 
        RowBox[{"(", "branches", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"styVertex", "=", 
       RowBox[{"{", "LightGray", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "branches", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", 
            RowBox[{"Length", "[", "branches", "]"}]}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"X", "=", 
             RowBox[{"BPSetXinit", "[", "G", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"b", "=", 
             RowBox[{"branches", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"check", ",", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"checking", " ", "partial", " ", "solutions"}], " ", 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"valid", "=", "True"}], ";", "\[IndentingNewLine]", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"i", "=", "1"}], ",", 
                 RowBox[{"i", "\[LessEqual]", "n"}], ",", 
                 RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"X", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "3"}], "]"}], "]"}], "=", 
                   RowBox[{"BPGetNodePosition", "[", 
                    RowBox[{"G", ",", "X", ",", 
                    RowBox[{"i", "+", "3"}], ",", 
                    RowBox[{"b", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"valid", "&&", 
                    RowBox[{
                    RowBox[{"CalculatePartialSolutionError", "[", 
                    RowBox[{"G", ",", "X", ",", 
                    RowBox[{"i", "+", "3"}]}], "]"}], "<", "0.001"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"color", "=", "Green"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"valid", " ", "=", "False"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"color", "=", "Red"}], ";"}]}], 
                   "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"v", "=", 
                   RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "1", "}"}], ",", 
                    RowBox[{"b", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ";;", "i"}], "]"}], "]"}]}], "]"}], ",", 
                    "2"}], "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"styVertex", ",", 
                    RowBox[{"v", "\[Rule]", "color"}]}], "]"}]}]}], 
                "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{
               "checking", " ", "only", " ", "final", " ", "solution"}], " ", 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"valid", "=", "True"}], ";", "\[IndentingNewLine]", 
               RowBox[{"For", "[", 
                RowBox[{
                 RowBox[{"i", "=", "1"}], ",", 
                 RowBox[{"i", "\[LessEqual]", "n"}], ",", 
                 RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"X", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", "+", "3"}], "]"}], "]"}], "=", 
                   RowBox[{"BPGetNodePosition", "[", 
                    RowBox[{"G", ",", "X", ",", 
                    RowBox[{"i", "+", "3"}], ",", 
                    RowBox[{"b", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"CalculatePartialSolutionError", "[", 
                    RowBox[{"G", ",", "X", ",", 
                    RowBox[{"i", "+", "3"}]}], "]"}], ">", "0.001"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"valid", "=", "False"}]}], "\[IndentingNewLine]", 
                   "]"}], ";", "\[IndentingNewLine]", 
                  RowBox[{"If", "[", 
                   RowBox[{"valid", ",", 
                    RowBox[{"color", "=", "Green"}], ",", 
                    RowBox[{"color", "=", "Red"}]}], "]"}], ";", 
                  "\[IndentingNewLine]", 
                  RowBox[{"v", "=", 
                   RowBox[{"FromDigits", "[", 
                    RowBox[{
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"{", "1", "}"}], ",", "b"}], "]"}], ",", "2"}], 
                    "]"}]}], ";", "\[IndentingNewLine]", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"styVertex", ",", 
                    RowBox[{"v", "\[Rule]", "color"}]}], "]"}]}]}], 
                "\[IndentingNewLine]", "]"}]}], ","}], "\[IndentingNewLine]", 
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"T", "=", 
       RowBox[{"TreeGraph", "[", "\[IndentingNewLine]", 
        RowBox[{"edges", ",", "\[IndentingNewLine]", 
         RowBox[{"VertexStyle", "\[Rule]", "styVertex"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"EdgeStyle", "\[Rule]", "styEdges"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"GraphLayout", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\"\<LayeredEmbedding\>\"", ",", 
            RowBox[{"LayerSizeFunction", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"8", "&"}], ")"}]}]}], "}"}]}]}], "\[IndentingNewLine]",
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "T", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6960012949917183`*^9, 3.6960013820533795`*^9}, {
   3.6960014640062556`*^9, 3.6960014726695976`*^9}, {3.6960015224387217`*^9, 
   3.696001551877679*^9}, {3.6960016079727764`*^9, 3.6960016398546915`*^9}, {
   3.696001789032284*^9, 3.69600181774117*^9}, {3.69600327963871*^9, 
   3.6960032965029154`*^9}, {3.6961483229273157`*^9, 
   3.6961483423601418`*^9}, {3.6961483983982*^9, 3.696148412128369*^9}, {
   3.6961484690152607`*^9, 3.6961485614272795`*^9}, {3.6961486679676576`*^9, 
   3.696148673589913*^9}, {3.6961493790330276`*^9, 3.6961494467388783`*^9}, {
   3.6961496986371365`*^9, 3.6961497320667543`*^9}, {3.696149777358199*^9, 
   3.6961498071294775`*^9}, {3.696149945923109*^9, 3.6961499484882417`*^9}, {
   3.69615000107961*^9, 3.6961500490175457`*^9}, {3.6961501213276567`*^9, 
   3.6961501583831005`*^9}, {3.6961502573314624`*^9, 
   3.6961506573839016`*^9}, {3.696151543775894*^9, 3.6961515845251284`*^9}, 
   3.6961516329070644`*^9, {3.6961517892881274`*^9, 3.696151908884268*^9}, {
   3.6961519468761954`*^9, 3.6961519561604776`*^9}, {3.6961520334809628`*^9, 
   3.696152035094754*^9}, {3.6961520736869907`*^9, 3.69615210409455*^9}, {
   3.696152482980331*^9, 3.696152662659408*^9}, {3.696152777450977*^9, 
   3.696152829088067*^9}, {3.696152992192956*^9, 3.6961530537242084`*^9}, {
   3.6961530935608644`*^9, 3.6961531073592224`*^9}, {3.6961531466061087`*^9, 
   3.696153176989295*^9}, {3.6961532190302734`*^9, 3.6961533272635355`*^9}, {
   3.696153382674528*^9, 3.696153388127223*^9}, {3.696153984277052*^9, 
   3.696153991264039*^9}, {3.696154288480689*^9, 3.6961543083889713`*^9}, {
   3.696154346918648*^9, 3.696154349270986*^9}, {3.6961545495652947`*^9, 
   3.696154831107952*^9}, {3.6961549224236975`*^9, 3.696154944621892*^9}, {
   3.696154986246745*^9, 3.6961550996201425`*^9}, {3.6961551664626613`*^9, 
   3.6961552808422456`*^9}, {3.6961553137663155`*^9, 3.696155436423814*^9}, {
   3.6961554717085285`*^9, 3.6961555844874773`*^9}, {3.6961556560732527`*^9, 
   3.6961556875246115`*^9}, {3.6961557605618525`*^9, 
   3.6961557675244627`*^9}, {3.6961558007438197`*^9, 
   3.6961560033942895`*^9}, {3.6961568624303703`*^9, 
   3.6961569103795757`*^9}, {3.6961603457477746`*^9, 
   3.6961604679840574`*^9}, {3.696160504538644*^9, 3.6961605099557457`*^9}, {
   3.6961605734631867`*^9, 3.696160585446912*^9}, {3.6961606327318373`*^9, 
   3.6961606329319468`*^9}, 3.69616154862936*^9, {3.6961617833819513`*^9, 
   3.696161794218891*^9}, {3.696161865565824*^9, 3.6961618725880227`*^9}, {
   3.6961620976200047`*^9, 3.69616220281542*^9}, {3.6961622897554994`*^9, 
   3.696162342362113*^9}, {3.6961624562802105`*^9, 3.696162471408639*^9}, {
   3.6961625259935856`*^9, 3.696162568801502*^9}, {3.696162605384383*^9, 
   3.6961627176237283`*^9}, {3.6961629128219624`*^9, 
   3.6961629181341624`*^9}, {3.6961629809348173`*^9, 3.696163373884967*^9}, {
   3.6961634604609146`*^9, 3.6961635400259466`*^9}, {3.6961636266736374`*^9, 
   3.696163627208607*^9}, {3.6961638085620933`*^9, 3.6961640023397727`*^9}, {
   3.696164142073502*^9, 3.696164178709567*^9}, {3.6961644014098186`*^9, 
   3.6961644116052637`*^9}, {3.6961645548322477`*^9, 
   3.6961646607476544`*^9}, {3.696164706458598*^9, 3.6961647660239115`*^9}, {
   3.6961703125046062`*^9, 3.6961705148012*^9}, {3.6961707246204853`*^9, 
   3.696170741937401*^9}, {3.696341417392389*^9, 3.6963414434231215`*^9}, {
   3.6966108338515267`*^9, 3.6966108852715893`*^9}, {3.696610963674673*^9, 
   3.6966109681277447`*^9}, 3.696611010397179*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Source Code : Solver", "Subsection",
 CellChangeTimes->{{3.696597957320731*^9, 3.6965979713710012`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{
    RowBox[{"GenerateRandomMDGP", "[", 
     RowBox[{"9", ",", "5"}], "]"}], "[", "\"\<G\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edges", "=", 
   RowBox[{"EdgeList", "[", "G", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ei", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"edges", "[", 
       RowBox[{"[", "k", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "[", "edges", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ej", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"edges", "[", 
       RowBox[{"[", "k", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "[", "edges", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dij", " ", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"GetEdgeWeight", "[", 
      RowBox[{"G", ",", 
       RowBox[{"edges", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{"Length", "[", "edges", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"DynamicModule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"G", "=", 
      RowBox[{
       RowBox[{"GenerateRandomMDGP", "[", 
        RowBox[{"9", ",", "5"}], "]"}], "[", "\"\<G\>\"", "]"}]}], ",", " ", 
     RowBox[{"branches", "=", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"b", "=", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"s", "=", 
      RowBox[{"{", "}"}]}], ",", 
     RowBox[{"X", "=", 
      RowBox[{"BPSetXinit", "[", "G", "]"}]}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"CreateTreeGraphFromBranches", "[", 
         RowBox[{"G", ",", 
          RowBox[{"{", 
           RowBox[{
           "\[Omega]4", ",", "\[Omega]5", ",", "\[Omega]6", ",", "\[Omega]7", 
            ",", "\[Omega]8", ",", "\[Omega]9"}], "}"}], ",", "branches", ",",
           "BP"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Column", "[", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PlotAdjacencyMatrix", "[", 
            RowBox[{"G", ",", "Sym"}], "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Graphics3D", "[", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Red", ",", 
                RowBox[{"Tube", "[", "X", "]"}]}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"PointSize", "[", "Large", "]"}], ",", "Blue", ",", 
                RowBox[{"Point", "[", "X", "]"}]}], "}"}]}], "}"}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"MatrixForm", "[", 
            RowBox[{"s", ",", 
             RowBox[{"TableHeadings", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"None", ",", 
                RowBox[{"{", 
                 RowBox[{
                 "\"\<\[Omega]4\>\"", ",", "\"\<\[Omega]5\>\"", ",", 
                  "\"\<\[Omega]6\>\"", ",", "\"\<\[Omega]7\>\"", ",", 
                  "\"\<\[Omega]8\>\"", ",", "\"\<\[Omega]9\>\""}], "}"}]}], 
               "}"}]}]}], "]"}]}], "}"}], "]"}]}], "}"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "Branches", " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Branches\>\"", ",", "Bold", ",", "Medium"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Omega]4", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"ControlType", "\[Rule]", "SetterBar"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Omega]5", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"ControlType", "\[Rule]", "SetterBar"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Omega]6", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"ControlType", "\[Rule]", "SetterBar"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Omega]7", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"ControlType", "\[Rule]", "SetterBar"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Omega]8", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"ControlType", "\[Rule]", "SetterBar"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"\[Omega]9", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}], ",", 
       RowBox[{"ControlType", "\[Rule]", "SetterBar"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Button", "[", 
      RowBox[{"\"\<Try\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"b", "=", 
          RowBox[{"{", 
           RowBox[{
           "\[Omega]4", ",", "\[Omega]5", ",", "\[Omega]6", ",", "\[Omega]7", 
            ",", "\[Omega]8", ",", "\[Omega]9"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Length", "[", "b", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", 
           RowBox[{
            RowBox[{"X", "[", 
             RowBox[{"[", 
              RowBox[{"i", "+", "3"}], "]"}], "]"}], "=", 
            RowBox[{"BPGetNodePosition", "[", 
             RowBox[{"G", ",", "X", ",", 
              RowBox[{"i", "+", "3"}], ",", 
              RowBox[{"b", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"branches", ",", 
           RowBox[{"{", 
            RowBox[{
            "\[Omega]4", ",", "\[Omega]5", ",", "\[Omega]6", ",", "\[Omega]7",
              ",", "\[Omega]8", ",", "\[Omega]9"}], "}"}]}], "]"}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"Background", "\[Rule]", "LightBlue"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Options\>\"", ",", "Bold", ",", " ", "Medium"}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"BP", ",", 
       RowBox[{"{", 
        RowBox[{"False", ",", "True"}], "}"}], ",", 
       RowBox[{"ControlType", "\[Rule]", "Checkbox"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Sym", ",", 
       RowBox[{"{", 
        RowBox[{"False", ",", "True"}], "}"}], ",", 
       RowBox[{"ControlType", "\[Rule]", "Checkbox"}]}], "}"}], ",", 
     "\[IndentingNewLine]", "Delimiter", ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"show", " ", "solutions"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Style", "[", 
      RowBox[{"\"\<Solutions\>\"", ",", "Bold", ",", "Medium"}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Button", "[", 
      RowBox[{"\"\<Show\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"BPSolver", "[", "G", "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "[", "\"\<Branches\>\"", "]"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"s", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"s", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"Length", "[", "s", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "4", ",", "9"}], "}"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"branches", "=", 
          RowBox[{"Union", "[", 
           RowBox[{"branches", ",", "s"}], "]"}]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Background", "\[Rule]", "LightRed"}]}], "\[IndentingNewLine]",
       "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Button", "[", 
      RowBox[{"\"\<Reset\>\"", ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"G", "=", 
          RowBox[{
           RowBox[{"GenerateRandomMDGP", "[", 
            RowBox[{"9", ",", "5"}], "]"}], "[", "\"\<G\>\"", "]"}]}], ",", 
         RowBox[{"branches", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"b", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"s", "=", 
          RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Background", "\[Rule]", "LightRed"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ControlPlacement", "\[Rule]", "Left"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.695723321371716*^9, 3.6957233477244525`*^9}, {
   3.6957234760533085`*^9, 3.6957235098336396`*^9}, {3.695723735715779*^9, 
   3.6957237877536187`*^9}, {3.695723850173235*^9, 3.6957239031129613`*^9}, {
   3.695728140234626*^9, 3.695728170469324*^9}, {3.695728206912562*^9, 
   3.6957283189207373`*^9}, {3.6957302430448112`*^9, 3.695730251925662*^9}, {
   3.695730284192649*^9, 3.6957303072451687`*^9}, 3.6957303419698424`*^9, {
   3.6957303818606863`*^9, 3.695730385876433*^9}, {3.695730776871158*^9, 
   3.6957307799432144`*^9}, {3.695730913909477*^9, 3.695731056625264*^9}, {
   3.6957319251514997`*^9, 3.6957319315696564`*^9}, {3.6957321042594004`*^9, 
   3.6957321106365647`*^9}, {3.6957322295983095`*^9, 
   3.6957322502411985`*^9}, {3.695732413433252*^9, 3.695732417498835*^9}, {
   3.6957325188132176`*^9, 3.6957326476413317`*^9}, {3.6957327030329676`*^9, 
   3.6957327379451895`*^9}, {3.6957328580897083`*^9, 3.695732908861949*^9}, {
   3.695732976478773*^9, 3.695732988297332*^9}, {3.6957330608395104`*^9, 
   3.6957331084110994`*^9}, {3.6957331512650113`*^9, 3.6957331875252066`*^9}, 
   3.695733451581834*^9, {3.6957335101968355`*^9, 3.6957335723975716`*^9}, {
   3.695733630567013*^9, 3.6957336843221555`*^9}, {3.6957337403604355`*^9, 
   3.6957338169156723`*^9}, {3.695733865807949*^9, 3.695733871196596*^9}, {
   3.6957339622950974`*^9, 3.695733976453291*^9}, {3.695734172561076*^9, 
   3.6957341961862507`*^9}, {3.6957343224310236`*^9, 3.695734490364665*^9}, {
   3.6957345316085634`*^9, 3.6957345401498027`*^9}, {3.6957345864160423`*^9, 
   3.695734631603385*^9}, {3.6957347012036605`*^9, 3.6957347215090895`*^9}, {
   3.69573479380623*^9, 3.695734822739337*^9}, {3.695734874725807*^9, 
   3.695734922835139*^9}, {3.6957349678751855`*^9, 3.6957350309412208`*^9}, {
   3.6957350745613704`*^9, 3.695735083754054*^9}, {3.6957351324046464`*^9, 
   3.6957351801778193`*^9}, {3.695735237659878*^9, 3.6957352843844495`*^9}, 
   3.6957353270579834`*^9, {3.695735465755406*^9, 3.6957354886370554`*^9}, {
   3.6957355946776204`*^9, 3.695735604012744*^9}, {3.6957356352356386`*^9, 
   3.6957357853389974`*^9}, {3.695736023894952*^9, 3.695736029581028*^9}, {
   3.6957361614117217`*^9, 3.6957361738382483`*^9}, {3.6957362038644595`*^9, 
   3.695736210350934*^9}, {3.6957363377798505`*^9, 3.695736339913566*^9}, {
   3.695736388787493*^9, 3.695736395158078*^9}, {3.695736466272395*^9, 
   3.6957364681925907`*^9}, {3.6957365737824*^9, 3.6957367221996307`*^9}, {
   3.695736804774605*^9, 3.695736824849099*^9}, {3.695736870426489*^9, 
   3.6957368746607704`*^9}, {3.695737066994382*^9, 3.6957370745685244`*^9}, {
   3.695737180725799*^9, 3.6957373546184263`*^9}, {3.6957375699866943`*^9, 
   3.6957375998386583`*^9}, {3.6957377143178205`*^9, 3.695737742205675*^9}, {
   3.6957378110143795`*^9, 3.6957378850992956`*^9}, {3.6957379340609617`*^9, 
   3.695737934462038*^9}, {3.695738259762306*^9, 3.695738367274972*^9}, {
   3.695738409500598*^9, 3.6957384421132274`*^9}, {3.6957385706618986`*^9, 
   3.695738572694256*^9}, {3.695738612038187*^9, 3.69573864960015*^9}, 
   3.6957388507380824`*^9, {3.6957394459987955`*^9, 3.695739542795068*^9}, {
   3.6957396054892187`*^9, 3.6957396122208004`*^9}, {3.6957398838947153`*^9, 
   3.6957398874824905`*^9}, {3.6957406530594573`*^9, 3.695740661880864*^9}, {
   3.6957408944610014`*^9, 3.6957410066013136`*^9}, {3.6957410861236067`*^9, 
   3.6957411096802387`*^9}, {3.6957411462041087`*^9, 3.695741146320501*^9}, {
   3.6957411825985527`*^9, 3.69574118828378*^9}, {3.6957412376215544`*^9, 
   3.6957412475596485`*^9}, {3.695741432878501*^9, 3.695741446835599*^9}, {
   3.6957415063069725`*^9, 3.6957415325437765`*^9}, {3.6957416929362893`*^9, 
   3.6957418450245347`*^9}, 3.695741894746039*^9, {3.6957419279122915`*^9, 
   3.695741993636595*^9}, 3.6957420446016536`*^9, {3.695742091680943*^9, 
   3.6957421855837917`*^9}, {3.6957422226389103`*^9, 3.695742266516306*^9}, {
   3.69574234306454*^9, 3.695742385774511*^9}, {3.6957424775536404`*^9, 
   3.695742506889844*^9}, {3.6957425514568357`*^9, 3.695742633174608*^9}, {
   3.6957428115295515`*^9, 3.695742880306145*^9}, 3.6957491344650517`*^9, {
   3.6957493282972527`*^9, 3.6957493520816793`*^9}, {3.6960012909403973`*^9, 
   3.6960012938883305`*^9}, {3.696156255994712*^9, 3.6961562650100794`*^9}, {
   3.696156295886201*^9, 3.6961563106886444`*^9}, {3.6961564013359656`*^9, 
   3.6961564517039223`*^9}, {3.6961565250416493`*^9, 
   3.6961566543467717`*^9}, {3.6961567288961554`*^9, 
   3.6961568441226873`*^9}, {3.6961568909910555`*^9, 3.696156903900296*^9}, {
   3.6961569672255335`*^9, 3.696156969304701*^9}, {3.6961571034179225`*^9, 
   3.696157110312049*^9}, {3.696160282114659*^9, 3.696160302223087*^9}, {
   3.6961605625418644`*^9, 3.6961606222501583`*^9}, {3.696160658944554*^9, 
   3.6961606778289185`*^9}, {3.6961609283775125`*^9, 
   3.6961609808174286`*^9}, {3.6961610459570017`*^9, 
   3.6961610477260633`*^9}, {3.696161209739623*^9, 3.6961613158159175`*^9}, {
   3.696161357319108*^9, 3.69616136948481*^9}, {3.696162431625352*^9, 
   3.6961624330647745`*^9}, {3.6961628027014465`*^9, 
   3.6961628571260533`*^9}, {3.696162900512824*^9, 3.6961629049376287`*^9}, {
   3.6961642456888447`*^9, 3.696164270507456*^9}, {3.6961649316798134`*^9, 
   3.696164998676358*^9}, {3.696165041400201*^9, 3.696165083729754*^9}, {
   3.6961651566015034`*^9, 3.696165206769026*^9}, {3.6961652700456624`*^9, 
   3.696165289007637*^9}, {3.6961653864122925`*^9, 3.696165497141945*^9}, {
   3.696165743808255*^9, 3.696165799254837*^9}, {3.696165845290099*^9, 
   3.696165990776334*^9}, {3.6961661230691767`*^9, 3.696166191968793*^9}, {
   3.6961662871277575`*^9, 3.696166327478566*^9}, {3.696166386078822*^9, 
   3.6961664236976624`*^9}, {3.696166496850869*^9, 3.6961664989856625`*^9}, {
   3.6961665602905154`*^9, 3.69616677076039*^9}, {3.69616684916016*^9, 
   3.696166888844514*^9}, {3.696166989227959*^9, 3.6961669927334337`*^9}, {
   3.696167046616452*^9, 3.696167051273269*^9}, {3.6961670863546443`*^9, 
   3.69616711698417*^9}, {3.696168089856365*^9, 3.696168121062352*^9}, {
   3.69616818237259*^9, 3.6961682224238987`*^9}, {3.6961683411240253`*^9, 
   3.696168384465231*^9}, 3.6961684150385275`*^9, {3.6961684819548564`*^9, 
   3.6961685051447563`*^9}, {3.696168568475537*^9, 3.696168570263974*^9}, {
   3.6961686351296844`*^9, 3.6961686370314665`*^9}, {3.696168686385473*^9, 
   3.696168691443553*^9}, {3.6961687468176303`*^9, 3.6961688101433983`*^9}, {
   3.6961689711518*^9, 3.6961690483381233`*^9}, {3.696169125123598*^9, 
   3.696169175323496*^9}, {3.69616950254916*^9, 3.696169563303851*^9}, {
   3.6961696075874076`*^9, 3.6961696257426414`*^9}, {3.69616969935327*^9, 
   3.6961697070144925`*^9}, 3.6961697386375637`*^9, {3.696169815828497*^9, 
   3.6961698450990944`*^9}, {3.696169882730567*^9, 3.6961699262763777`*^9}, {
   3.6961699622860117`*^9, 3.6961699750439024`*^9}, {3.6961700134511185`*^9, 
   3.696170017009848*^9}, {3.6961700553549232`*^9, 3.696170086868808*^9}, {
   3.696170163107408*^9, 3.6961701814566517`*^9}, {3.6961702450598593`*^9, 
   3.6961702610064096`*^9}, {3.6961705582279353`*^9, 3.6961705711466084`*^9}, 
   3.6961706335282717`*^9, {3.6961707824291086`*^9, 3.6961707949249997`*^9}, {
   3.696170828378927*^9, 3.6961708451917305`*^9}, {3.6961775244960194`*^9, 
   3.696177536639609*^9}, {3.6961777114223776`*^9, 3.6961778726060057`*^9}, {
   3.6961779536871257`*^9, 3.696178001287077*^9}, {3.6961780446438513`*^9, 
   3.6961780491063614`*^9}, {3.69617808066495*^9, 3.6961782203938217`*^9}, {
   3.696178433914888*^9, 3.6961784492746*^9}, {3.696178482911583*^9, 
   3.6961785279941273`*^9}, {3.6963358148945017`*^9, 3.696335824944496*^9}, {
   3.696336702720662*^9, 3.696336711565955*^9}, {3.6963367506934752`*^9, 
   3.696336898626133*^9}, {3.6963369663555574`*^9, 3.6963370245934205`*^9}, {
   3.6963370579884453`*^9, 3.6963370911332693`*^9}, {3.69633713867729*^9, 
   3.69633714758457*^9}, {3.6963371784547625`*^9, 3.696337330668229*^9}, 
   3.696337506286955*^9, {3.696342030265442*^9, 3.696342055614204*^9}, {
   3.6965973436925826`*^9, 3.6965973584907165`*^9}, {3.6965973978907404`*^9, 
   3.6965974400600586`*^9}, {3.6965980687982664`*^9, 3.696598082182392*^9}, {
   3.6965987379952097`*^9, 3.69659875237007*^9}, {3.6965991595664005`*^9, 
   3.696599161357998*^9}, {3.6966041446608152`*^9, 3.6966042105828886`*^9}, {
   3.696604264613673*^9, 3.69660426850031*^9}, {3.6966042987761164`*^9, 
   3.696604362039445*^9}, {3.696604415473429*^9, 3.696604443979203*^9}, {
   3.6966044989890485`*^9, 3.6966045013103867`*^9}, {3.696610914922676*^9, 
   3.6966109153078117`*^9}}],

Cell[BoxData[{
 RowBox[{"G", "=", 
  RowBox[{
   RowBox[{"GenerateRandomMDGP", "[", 
    RowBox[{"9", ",", "5"}], "]"}], "[", "\"\<G\>\"", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"VertexList", "[", "G", "]"}], "\[IndentingNewLine]", 
 RowBox[{"b", "=", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"X", "=", 
  RowBox[{"BPSetXinit", "[", "G", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"Length", "[", "b", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", 
   RowBox[{
    RowBox[{"X", "[", 
     RowBox[{"[", 
      RowBox[{"i", "+", "3"}], "]"}], "]"}], "=", 
    RowBox[{"BPGetNodePosition", "[", 
     RowBox[{"G", ",", "X", ",", 
      RowBox[{"i", "+", "3"}], ",", 
      RowBox[{"b", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6965989705036917`*^9, 3.6965990215554113`*^9}, {
  3.696599065184267*^9, 3.6965991040298233`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["IBPSolver", "Section",
 CellChangeTimes->{{3.6795571036686206`*^9, 3.679557113728629*^9}, {
  3.6811328435634823`*^9, 3.681132843691572*^9}, {3.682701946598136*^9, 
  3.682701963537011*^9}}],

Cell[CellGroupData[{

Cell["Source Code", "Subsection",
 CellChangeTimes->{{3.679557165643343*^9, 3.6795571685082006`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "IBPSolver", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IBPSolver", "[", 
    RowBox[{"G_", ",", 
     RowBox[{"nslices_:", "2"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "k", ",", "dij", ",", "numberOfAtoms", ",", "slices", ",", 
       "work", ",", 
       RowBox[{"done", "=", "False"}], ",", "E", ",", "B", ",", "Dij", ",", 
       "Lij", ",", "Uij", ",", "S", ",", "Z", ",", "X", ",", "W", ",", 
       "isnew"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"identifying", " ", "imprecise", " ", "distances"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numberOfAtoms", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"VertexList", "[", "G", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"branch", " ", "slices"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"slices", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"S", "=", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Points\>\"", "\[Rule]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"\"\<Branches\>\"", "\[Rule]", 
          RowBox[{"{", "}"}]}]}], "|>"}]}], ";", " ", 
      RowBox[{"(*", " ", "solutions", " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"create", " ", "an", " ", "work", " ", "graph", " ", 
        RowBox[{"(", "W", ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"E", "=", 
       RowBox[{"EdgeList", "[", "G", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"W", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{
         RowBox[{"VertexList", "[", "G", "]"}], ",", "E"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", 
         RowBox[{"Length", "[", "E", "]"}]}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"PropertyValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"W", ",", 
              RowBox[{"E", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", "EdgeWeight"}], 
           "]"}], "=", 
          RowBox[{"PropertyValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"G", ",", 
              RowBox[{"E", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", "EdgeWeight"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"PropertyValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"W", ",", 
              RowBox[{"E", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
            "\"\<DistanceBounds\>\""}], "]"}], "=", 
          RowBox[{"PropertyValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"G", ",", 
              RowBox[{"E", "[", 
               RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
            "\"\<DistanceBounds\>\""}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{"Not", "[", "done", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<slices=\>\"", ",", "slices"}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"generate", " ", "bp", " ", "instance"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "4"}], ",", 
            RowBox[{"k", "\[LessEqual]", "numberOfAtoms"}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Lij", ",", "Uij"}], "}"}], "=", 
              RowBox[{"GetEdgeDistanceBounds", "[", 
               RowBox[{"W", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"k", "-", "3"}], ")"}], "\[UndirectedEdge]", 
                 "k"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"dij", "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Uij", "-", "Lij"}], ")"}], "/", "nslices"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"PropertyValue", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"W", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"k", "-", "3"}], ")"}], "\[UndirectedEdge]", 
                   "k"}]}], "}"}], ",", "EdgeWeight"}], "]"}], "=", 
              RowBox[{
               RowBox[{
                RowBox[{"slices", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "*", "dij"}], "+", "Lij", 
               " ", "-", " ", 
               RowBox[{"dij", "/", "2"}]}]}], ";"}]}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<k=\>\"", ",", "k", ",", "\"\< Lij=\>\"", ",", "Lij", ",", 
               "\"\< Uij=\>\"", ",", "Uij", ",", "\"\< Dij=\>\"", ",", 
               RowBox[{"GetEdgeWeight", "[", 
                RowBox[{"W", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"k", "-", "3"}], ")"}], "\[UndirectedEdge]", 
                  "k"}]}], "]"}]}], "]"}], ";"}], "*)"}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"solve", " ", "bp", " ", "instance"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Z", ",", "work"}], "}"}], "=", 
           RowBox[{"BPSolver", "[", "W", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"and", " ", "add", " ", "new", " ", "solutions"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"X", "=", 
           RowBox[{"Z", "[", "\"\<Points\>\"", "]"}]}], ";"}], 
         RowBox[{"(*", 
          RowBox[{"Print", "[", "X", "]"}], "*)"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"B", "=", 
          RowBox[{"Z", "[", "\"\<Branches\>\"", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", 
            RowBox[{"Length", "[", "X", "]"}]}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"isnew", "=", "True"}], ";", "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"i", "=", "1"}], ",", 
              RowBox[{"i", "\[LessEqual]", 
               RowBox[{"Length", "[", 
                RowBox[{"S", "[", "\"\<Points\>\"", "]"}], "]"}]}], ",", 
              RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"S", "[", "\"\<Points\>\"", "]"}], "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "-", 
                   RowBox[{"X", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], "]"}], "<", "0.001"}], 
                ",", 
                RowBox[{
                 RowBox[{"isnew", "=", "False"}], ";", "Break"}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{"isnew", ",", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"\"\<branch=\>\"", ",", 
                  RowBox[{"B", "[", 
                   RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{
                 RowBox[{"S", "[", "\"\<Points\>\"", "]"}], ",", 
                 RowBox[{"X", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{
                 RowBox[{"S", "[", "\"\<Branches\>\"", "]"}], ",", 
                 RowBox[{"B", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], "]"}]}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"next", " ", "slice"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"done", "=", "True"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "4"}], ",", 
           RowBox[{"k", "\[LessEqual]", "numberOfAtoms"}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"slices", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "<", "nslices"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"slices", "[", 
                 RowBox[{"[", "k", "]"}], "]"}], "++"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"done", "=", "False"}], ";", "\[IndentingNewLine]", 
               RowBox[{"Break", "[", "]"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", "else", " ", "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"slices", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "=", "1"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<A total of \>\"", ",", " ", 
        RowBox[{"Length", "[", 
         RowBox[{"S", "[", "\"\<Points\>\"", "]"}], "]"}], ",", 
        "\"\< solutions has been found.\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", "S"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6827019671531935`*^9, 3.6827019883797054`*^9}, {
   3.6827520058773313`*^9, 3.682752007842795*^9}, {3.682773523900758*^9, 
   3.6827739504220514`*^9}, {3.6827739820939207`*^9, 3.682773997290721*^9}, {
   3.6827748027586565`*^9, 3.6827748602420864`*^9}, {3.682774937541239*^9, 
   3.6827753481045656`*^9}, {3.6827754855464773`*^9, 3.682775768077546*^9}, {
   3.6827758431794395`*^9, 3.682775852191575*^9}, {3.6827761086040697`*^9, 
   3.6827761356665545`*^9}, {3.6827761799051275`*^9, 
   3.6827762569294157`*^9}, {3.682776288487507*^9, 3.6827764838117733`*^9}, {
   3.682776598677207*^9, 3.682776711866549*^9}, {3.682776757766048*^9, 
   3.682776806526044*^9}, {3.6827769820156193`*^9, 3.6827770574592137`*^9}, {
   3.6827771830672836`*^9, 3.6827772226146555`*^9}, {3.6827772538317227`*^9, 
   3.682777263271402*^9}, {3.6827775456748238`*^9, 3.682777546518789*^9}, {
   3.6827775797151136`*^9, 3.6827775984622955`*^9}, {3.682777657482841*^9, 
   3.6827777067571774`*^9}, {3.6827777903994412`*^9, 
   3.6827777968861074`*^9}, {3.682777869172826*^9, 3.682777869551065*^9}, {
   3.6827779315169716`*^9, 3.682777931686807*^9}, {3.682778028203849*^9, 
   3.6827780327785378`*^9}, {3.682778114875511*^9, 3.6827781151693735`*^9}, {
   3.6827786318985825`*^9, 3.6827786532106905`*^9}, {3.682778780232845*^9, 
   3.6827788150088916`*^9}, {3.682778860589865*^9, 3.682778918862643*^9}, {
   3.6827790426077757`*^9, 3.6827794809945264`*^9}, {3.6827795619985237`*^9, 
   3.682779590990248*^9}, {3.682779976097824*^9, 3.6827799798825316`*^9}, 
   3.6827800453274255`*^9, {3.6827800812274303`*^9, 3.6827801376397424`*^9}, {
   3.6827801817742767`*^9, 3.682780266523752*^9}, {3.6827805401257453`*^9, 
   3.682780661598824*^9}, {3.6827807301684313`*^9, 3.6827807439590216`*^9}, {
   3.6827807922573433`*^9, 3.682780825155981*^9}, {3.68278089072889*^9, 
   3.6827809003062625`*^9}, {3.6827809636600475`*^9, 
   3.6827809691730986`*^9}, {3.682781052145022*^9, 3.6827810576947823`*^9}, 
   3.6827811031071897`*^9, {3.68278114552192*^9, 3.682781148502773*^9}, {
   3.682781191030442*^9, 3.682781251899205*^9}, {3.682781354202553*^9, 
   3.6827813544128523`*^9}, 3.6827813991698384`*^9, {3.6827814442928348`*^9, 
   3.6827814467598443`*^9}, {3.682781487351517*^9, 3.6827814884135475`*^9}, {
   3.6827818109759817`*^9, 3.682781813545724*^9}, {3.6827853356617775`*^9, 
   3.682785337550229*^9}, {3.6827867368412943`*^9, 3.682786741159988*^9}, {
   3.682786807927786*^9, 3.682786819894947*^9}, {3.68278715946465*^9, 
   3.682787162255832*^9}, {3.6827874230740376`*^9, 3.6827874366378717`*^9}, {
   3.682789227649762*^9, 3.682789230497446*^9}, {3.6827893815529485`*^9, 
   3.6827893845262256`*^9}, {3.682874323027193*^9, 3.682874336182909*^9}, {
   3.6829343494785357`*^9, 3.682934438253458*^9}, {3.682934871900261*^9, 
   3.682934888830892*^9}, {3.6829350043195353`*^9, 3.6829350106554976`*^9}, {
   3.6829355309198093`*^9, 3.682935703315592*^9}, {3.6829357824619856`*^9, 
   3.682935807468607*^9}, {3.683022005274223*^9, 3.6830220091210856`*^9}, {
   3.683022039821942*^9, 3.683022086349081*^9}, {3.6830326439989023`*^9, 
   3.6830326466660814`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples", "Subsection",
 CellChangeTimes->{{3.682777369516736*^9, 3.6827773754382195`*^9}}],

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"M", "=", 
    RowBox[{"GenerateRandomMDGP", "[", 
     RowBox[{"5", ",", "4", ",", "0.1", ",", 
      RowBox[{"algorithm", "=", "\"\<DistanceMatrix\>\""}], ",", 
      RowBox[{"seed", "=", "1"}]}], "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"M", "[", "\"\<X\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"M", "[", "\"\<G\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{"IBPSolver", "[", "G", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6798218509178233`*^9, 3.679821852271891*^9}, {
   3.6798220754379344`*^9, 3.6798220755372047`*^9}, {3.679822744321784*^9, 
   3.6798227445214615`*^9}, {3.6798231052765684`*^9, 3.679823107593405*^9}, 
   3.679823226558363*^9, {3.6798233451775875`*^9, 3.679823345308581*^9}, {
   3.679823525737986*^9, 3.679823549906366*^9}, {3.6798263139146395`*^9, 
   3.679826344570452*^9}, {3.6798288602280912`*^9, 3.6798288604903975`*^9}, {
   3.6798288950564623`*^9, 3.679828994620492*^9}, {3.679829044969572*^9, 
   3.6798290909698343`*^9}, {3.6798294100005565`*^9, 
   3.6798294105697436`*^9}, {3.6798295004715223`*^9, 
   3.6798295681002893`*^9}, {3.6798296319378924`*^9, 3.679829632507357*^9}, {
   3.6798299800985794`*^9, 3.6798299863477526`*^9}, {3.679830157933735*^9, 
   3.6798301597117043`*^9}, {3.6798302974701996`*^9, 
   3.6798303164031887`*^9}, {3.6798303891181116`*^9, 3.679830389302563*^9}, {
   3.6798304759096456`*^9, 3.679830478014727*^9}, {3.6799119298147106`*^9, 
   3.6799119406954846`*^9}, {3.679912001613147*^9, 3.679912019708365*^9}, {
   3.6799121456440763`*^9, 3.6799121778114533`*^9}, 3.679912535631927*^9, {
   3.6799174812432394`*^9, 3.6799174816978993`*^9}, {3.679918592547327*^9, 
   3.6799186296132526`*^9}, {3.6799255011209993`*^9, 
   3.6799255012742624`*^9}, {3.6799265772569237`*^9, 
   3.6799266196275845`*^9}, {3.679927091468864*^9, 3.6799271177650127`*^9}, {
   3.679927217233017*^9, 3.679927233987025*^9}, {3.679927271460558*^9, 
   3.679927271760435*^9}, {3.679927363032942*^9, 3.679927363786351*^9}, 
   3.6799274640577226`*^9, {3.6799274956489134`*^9, 3.6799275047564964`*^9}, {
   3.6802494864436903`*^9, 3.680249517698353*^9}, {3.680249838745507*^9, 
   3.680249885493765*^9}, {3.6802499632347374`*^9, 3.68024997989824*^9}, {
   3.6802500278218193`*^9, 3.680250042557376*^9}, {3.6802500816458673`*^9, 
   3.680250094230627*^9}, {3.6802501729429226`*^9, 3.680250245242584*^9}, {
   3.680250277069769*^9, 3.680250349656209*^9}, {3.6802561938862762`*^9, 
   3.680256217314024*^9}, {3.6802562822999315`*^9, 3.6802562845355077`*^9}, {
   3.680259514448849*^9, 3.68025956932335*^9}, {3.680259617915313*^9, 
   3.680259625069577*^9}, {3.6802596588968315`*^9, 3.6802596591149898`*^9}, {
   3.6802597057100697`*^9, 3.680259710865752*^9}, {3.680259778882868*^9, 
   3.680259779298339*^9}, {3.6802598345877275`*^9, 3.6802598347003174`*^9}, {
   3.6802634539441957`*^9, 3.6802634724224014`*^9}, {3.680264125324051*^9, 
   3.680264127539488*^9}, {3.680971309238633*^9, 3.6809713321665344`*^9}, {
   3.6809713775361547`*^9, 3.680971388619849*^9}, 3.680971453133582*^9, {
   3.6809717846377277`*^9, 3.6809717933103046`*^9}, 3.682752354734047*^9, 
   3.682757377902835*^9, {3.6827585847612524`*^9, 3.682758585270115*^9}, {
   3.682758922849889*^9, 3.6827589310888653`*^9}, 3.682758963373986*^9, {
   3.682777338739936*^9, 3.6827773397706623`*^9}, {3.6827773885972614`*^9, 
   3.682777509880164*^9}, {3.682777995186551*^9, 3.6827779952866464`*^9}, {
   3.682778057930979*^9, 3.6827780633222637`*^9}, {3.682778129241908*^9, 
   3.682778129377575*^9}, {3.682778697943698*^9, 3.682778699490327*^9}, {
   3.682778953526342*^9, 3.6827789556117177`*^9}, {3.682779505273485*^9, 
   3.682779536222084*^9}, {3.6827800751236987`*^9, 3.682780075207179*^9}, {
   3.682781360244443*^9, 3.682781393632818*^9}, 3.682781437277698*^9, {
   3.6830326521888623`*^9, 3.68303266619322*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["BuildUpSolver", "Section",
 CellChangeTimes->{{3.680878757330321*^9, 3.6808787634963007`*^9}, {
  3.682701954058903*^9, 3.6827019596222734`*^9}}],

Cell[CellGroupData[{

Cell["Source Code", "Subsection",
 CellChangeTimes->{{3.6808787874069276`*^9, 3.6808787932715735`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\[IndentingNewLine]", 
   RowBox[{
   "BuildUpOrdering", ",", "\[IndentingNewLine]", "BuildUpInitX", ",", 
    "\[IndentingNewLine]", "BuildUpNextBasisAndMatrix", ",", 
    "\[IndentingNewLine]", "BuildUpSolver"}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuildUpOrdering", "[", 
    RowBox[{"G_", ",", "C_", ",", 
     RowBox[{"verbose_:", "False"}]}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Finds", " ", "an", " ", "order", " ", "such", " ", "that", " ", "all", 
      " ", "atoms", " ", "could", " ", "be", " ", "determined", " ", "by", 
      " ", "following", " ", "it"}], ";", " ", "\[IndentingNewLine]", "   ", 
     RowBox[{
      StyleBox["C",
       FontSlant->"Italic"], 
      StyleBox[":",
       FontSlant->"Italic"], " ", 
      StyleBox[
       RowBox[{"Start", " ", "clique", " ", "with", " ", "4", " ", "atoms"}],
       FontSlant->"Italic"]}], 
     StyleBox[";",
      FontSlant->"Italic"], 
     StyleBox["\[IndentingNewLine]",
      FontSlant->"Italic"], 
     StyleBox["   ",
      FontSlant->"Italic"], 
     StyleBox[
      RowBox[{"G", ":", " ", 
       RowBox[{"Instance", " ", "graph"}]}],
      FontSlant->"Italic"], 
     StyleBox[";",
      FontSlant->"Italic"]}], 
    StyleBox["\[IndentingNewLine]",
     FontSlant->"Italic"], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "j", ",", "k", ",", "neighs", ",", "nAtoms", ",", 
       "nFixedAtoms", ",", "nFixedNeighs", ",", "atomsToBeFixed", ",", 
       "atomOrder", ",", " ", "order"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"initial", " ", "values"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"nAtoms", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"VertexList", "[", "G", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nFixedNeighs", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nAtoms"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"atomOrder", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nAtoms"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"atomsToBeFixed", "=", "C"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nFixedNeighs", "[", 
        RowBox[{"[", "C", "]"}], "]"}], "=", "Infinity"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nFixedAtoms", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "atomsToBeFixed", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{"verbose", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<nFixedNeighs=\>\"", ",", "nFixedNeighs"}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"Print", "[", 
             RowBox[{"\"\<atomsToBeFixed=\>\"", ",", "atomsToBeFixed"}], 
             "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"i", "=", 
          RowBox[{"First", "[", "atomsToBeFixed", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"remove", " ", "the", " ", "first", " ", "element"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"atomsToBeFixed", "=", 
          RowBox[{"Rest", "[", "atomsToBeFixed", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"skipped", ":", " ", 
           RowBox[{"already", " ", "fixed"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"atomOrder", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ">", "0"}], ",", 
           RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"verbose", ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<Fixing: \>\"", ",", "i"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"atomOrder", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"++", "nFixedAtoms"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"verbose", ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<atomOrder=\>\"", ",", "atomOrder"}], "]"}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"update", " ", "neighs", " ", "score"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"neighs", "=", 
          RowBox[{"AdjacencyList", "[", 
           RowBox[{"G", ",", "i"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"verbose", ",", 
           RowBox[{"Print", "[", 
            RowBox[{"\"\<neighs=\>\"", ",", "neighs"}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"k", "=", "1"}], ",", 
           RowBox[{"k", "\[LessEqual]", 
            RowBox[{"Length", "[", "neighs", "]"}]}], ",", 
           RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"j", "=", 
             RowBox[{"neighs", "[", 
              RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"nFixedNeighs", "[", 
              RowBox[{"[", "j", "]"}], "]"}], "++"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"atomOrder", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", "0"}], "&&", 
               RowBox[{
                RowBox[{"nFixedNeighs", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ">", "3"}], " ", "&&", 
               RowBox[{"Not", "[", 
                RowBox[{"MemberQ", "[", 
                 RowBox[{"atomsToBeFixed", ",", "j"}], "]"}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"atomsToBeFixed", ",", "j"}], "]"}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
          "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"order", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"i", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "nAtoms"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"order", "[", 
        RowBox[{"[", "atomOrder", "]"}], "]"}], "=", "order"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "order", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BuildUpInitX", "[", 
     RowBox[{"G_", ",", 
      RowBox[{"verbose_:", "False"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "d", ",", "c", ",", "absDetA", ",", 
        RowBox[{"maxAbsDetA", "=", "0"}], ",", "A", ",", "C", ",", "F", ",", 
        "S", ",", "U2", ",", "U3", ",", "U4", ",", "V3", ",", "V4", ",", "X", 
        ",", "Y", ",", "W", ",", "done"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"C", "=", 
        RowBox[{"FindClique", "[", 
         RowBox[{"G", ",", 
          RowBox[{"{", 
           RowBox[{"4", ",", "Infinity"}], "}"}], ",", "3"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "C", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"c", "=", 
           RowBox[{"Subsets", "[", 
            RowBox[{
             RowBox[{"C", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"{", "4", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"Length", "[", "c", "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"S", "=", 
              RowBox[{"c", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "set", " ", "the", " ", "position", " ", "of", " ", "the", " ", 
               "first", " ", "four", " ", "atoms"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"d", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"GetEdgeWeight", "[", 
                 RowBox[{"G", ",", 
                  RowBox[{
                   RowBox[{"S", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
                   RowBox[{"S", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "4"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Y", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "4"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Y", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "=", 
              RowBox[{"d", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
             RowBox[{"U2", "=", 
              RowBox[{
               RowBox[{"Y", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Y", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"d", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "3"}], "]"}], "]"}], "^", "2"}], "-", 
                 RowBox[{
                  RowBox[{"d", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "3"}], "]"}], "]"}], "^", "2"}], "+", 
                 RowBox[{"U2", "^", "2"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"2", "*", "U2"}], ")"}]}]}], ";", 
             RowBox[{"U3", "=", 
              RowBox[{
               RowBox[{"Y", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Y", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "=", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"d", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "3"}], "]"}], "]"}], "^", "2"}], "-", 
                RowBox[{"U3", "^", "2"}]}], "]"}]}], ";", 
             RowBox[{"V3", "=", 
              RowBox[{
               RowBox[{"Y", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Y", "[", 
                RowBox[{"[", "4", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"d", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "4"}], "]"}], "]"}], "^", "2"}], "-", 
                 RowBox[{
                  RowBox[{"d", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "4"}], "]"}], "]"}], "^", "2"}], "+", 
                 RowBox[{"U2", "^", "2"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"2", "*", "U2"}], ")"}]}]}], ";", 
             RowBox[{"U4", "=", 
              RowBox[{
               RowBox[{"Y", "[", 
                RowBox[{"[", "4", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Y", "[", 
                RowBox[{"[", "4", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}], "=", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"d", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "4"}], "]"}], "]"}], "^", "2"}], "-", 
                 RowBox[{
                  RowBox[{"d", "[", 
                   RowBox[{"[", 
                    RowBox[{"3", ",", "4"}], "]"}], "]"}], "^", "2"}], "-", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"U4", "-", "U2"}], ")"}], "^", "2"}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"U4", "-", "U3"}], ")"}], "^", "2"}], "+", 
                 RowBox[{"V3", "^", "2"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{"2", "*", "V3"}], ")"}]}]}], ";", 
             RowBox[{"V4", "=", 
              RowBox[{
               RowBox[{"Y", "[", 
                RowBox[{"[", "4", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"Y", "[", 
                RowBox[{"[", "4", "]"}], "]"}], "[", 
               RowBox[{"[", "3", "]"}], "]"}], "=", 
              RowBox[{"Sqrt", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"d", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "4"}], "]"}], "]"}], "^", "2"}], "-", 
                RowBox[{"U4", "^", "2"}], "-", 
                RowBox[{"V4", "^", "2"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"A", "=", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Y", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", 
                 RowBox[{"Y", "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"absDetA", "=", 
              RowBox[{"Abs", "[", 
               RowBox[{"Det", "[", "A", "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"absDetA", ">", "maxAbsDetA"}], ",", 
               RowBox[{
                RowBox[{"maxAbsDetA", "=", "absDetA"}], ";", 
                RowBox[{"F", "=", "S"}], ";", 
                RowBox[{"W", "=", "Y"}]}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"maxAbsDetA", ">", "1"}], ",", 
               RowBox[{"Goto", "[", "done", "]"}]}], "]"}]}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "done", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{"verbose", ",", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<Starting basis \>\"", ",", " ", "F"}], "]"}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"X", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", 
             RowBox[{"VertexList", "[", "G", "]"}], "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", 
          RowBox[{"F", "[", 
           RowBox[{"[", 
            RowBox[{"1", ";;", "4"}], "]"}], "]"}], "]"}], "]"}], "=", "W"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"X", ",", "F"}], "}"}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BuildUpNextBasis", "[", 
     RowBox[{"G_", ",", "F_", ",", "U_", ",", "X_", ",", 
      RowBox[{"verbose_:", "False"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "k", ",", "p", ",", "u", ",", 
        RowBox[{"basis", "=", 
         RowBox[{"{", "}"}]}], ",", "absDetA", ",", 
        RowBox[{"maxAbsDetA", "=", "0"}], ",", "A", ",", "C", ",", "P", ",", 
        "Y", ",", "done"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "U", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"u", "=", 
           RowBox[{"U", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"P", "=", 
           RowBox[{"Subsets", "[", 
            RowBox[{
             RowBox[{"Intersection", "[", 
              RowBox[{
               RowBox[{"AdjacencyList", "[", 
                RowBox[{"G", ",", "u"}], "]"}], ",", "F"}], "]"}], ",", 
             RowBox[{"{", "4", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "P", "]"}], "<", "1"}], ",", 
            RowBox[{"Continue", "[", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", 
             RowBox[{"Length", "[", "P", "]"}]}], ",", 
            RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"p", "=", 
              RowBox[{"Permutations", "[", 
               RowBox[{"P", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"k", "=", "1"}], ",", 
               RowBox[{"k", "\[LessEqual]", 
                RowBox[{"Length", "[", "p", "]"}]}], ",", 
               RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Y", "=", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"X", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"A", "=", 
                 RowBox[{"2", "*", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Y", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"Y", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "2", ",", "4"}], "}"}]}], "]"}]}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"absDetA", "=", 
                 RowBox[{"Abs", "[", 
                  RowBox[{"Det", "[", "A", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"update", " ", "basis"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"absDetA", ">", "maxAbsDetA"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"maxAbsDetA", "=", "absDetA"}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"basis", "=", 
                    RowBox[{"p", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{"verbose", ",", 
                    RowBox[{"Print", "[", 
                    RowBox[{
                    "\"\<basis=\>\"", ",", " ", "basis", ",", " ", 
                    "\"\< maxAbsDetA=\>\"", ",", "maxAbsDetA"}], "]"}]}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"maxAbsDetA", ">", "1"}], ",", 
                  RowBox[{"Goto", "[", "done", "]"}]}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Label", "[", "done", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "basis", "]"}], "<", "1"}], ",", 
         RowBox[{"Throw", "[", "\"\<BasisCouldNotBeFound\>\"", "]"}]}], "]"}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "basis", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BuildUpSetPosition", "[", 
     RowBox[{"G_", ",", "X_", ",", "S_", ",", "basis_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "b", ",", "d", ",", "A", ",", "Y", ",", "W"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Y", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "S", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"W", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"[", 
            RowBox[{"basis", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"A", "=", 
        RowBox[{"2", "*", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"W", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "-", 
            RowBox[{"W", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "2", ",", "4"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"A", "=", 
        RowBox[{"LUDecomposition", "[", "A", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "S", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"get", " ", "distances"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"d", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"GetEdgeWeight", "[", 
              RowBox[{"G", ",", 
               RowBox[{
                RowBox[{"S", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "\[Rule]", 
                RowBox[{"basis", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"b", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"W", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "^", "2"}], "-", 
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"W", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "^", "2"}]}], ")"}],
               "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"d", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "-", 
                RowBox[{
                 RowBox[{"d", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "^", "2"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Y", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"LUBackSubstitution", "[", 
            RowBox[{"A", ",", "b"}], "]"}]}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Y", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BuildUpSolver", "[", 
    RowBox[{"G_", ",", 
     RowBox[{"verbose_:", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "b", ",", "d", ",", "basis", ",", "A", ",", "F", ",", "S", 
       ",", "U", ",", "X", ",", "Y"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"X", ",", "F"}], "}"}], "=", 
       RowBox[{"BuildUpInitX", "[", 
        RowBox[{"G", ",", "verbose"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"set", " ", "remaining", " ", "atoms"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"U", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"j", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"VertexList", "[", "G", "]"}], "]"}]}], "}"}]}], "]"}], 
         ",", "F"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "U", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"basis", "=", 
          RowBox[{"BuildUpNextBasis", "[", 
           RowBox[{"G", ",", "F", ",", "U", ",", "X", ",", "verbose"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "find", " ", "atoms", " ", "to", " ", "set", " ", "position"}], " ",
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{"S", "=", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"AdjacencyList", "[", 
             RowBox[{"G", ",", 
              RowBox[{"basis", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "U"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"S", "=", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"AdjacencyList", "[", 
             RowBox[{"G", ",", 
              RowBox[{"basis", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "S"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"S", "=", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"AdjacencyList", "[", 
             RowBox[{"G", ",", 
              RowBox[{"basis", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", "S"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"S", "=", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"AdjacencyList", "[", 
             RowBox[{"G", ",", 
              RowBox[{"basis", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", "S"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"verbose", ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<F=\>\"", ",", "F", ",", "\"\< U=\>\"", ",", "U", ",", 
             "\"\< basis=\>\"", ",", "basis", ",", "\"\< S=\>\"", ",", "S"}], 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"set", " ", "positions"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"[", "S", "]"}], "]"}], "=", 
          RowBox[{"BuildUpSetPosition", "[", 
           RowBox[{"G", ",", "X", ",", "S", ",", "basis"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"F", "=", 
          RowBox[{"Union", "[", 
           RowBox[{"S", ",", "F"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"U", "=", 
          RowBox[{"Complement", "[", 
           RowBox[{"U", ",", "S"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "X", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.680878796715887*^9, 3.6808788985008335`*^9}, {
   3.6808789677890434`*^9, 3.680879020711442*^9}, {3.6808790793750415`*^9, 
   3.68087932980835*^9}, {3.6808794433580427`*^9, 3.680879452768545*^9}, {
   3.680879482957798*^9, 3.6808798572569814`*^9}, {3.6808801823844533`*^9, 
   3.6808802178347673`*^9}, {3.6808811493834057`*^9, 
   3.6808816352290897`*^9}, {3.6808816739789124`*^9, 3.680882032196274*^9}, {
   3.6808820912500343`*^9, 3.6808821757453947`*^9}, {3.680882211133314*^9, 
   3.680882378871024*^9}, {3.6808824342608643`*^9, 3.680882434823531*^9}, {
   3.680883747151867*^9, 3.680883922885659*^9}, {3.680883972978032*^9, 
   3.680884390920006*^9}, {3.6808844300037193`*^9, 3.6808845512584267`*^9}, 
   3.68088461521344*^9, {3.6808846535514545`*^9, 3.6808847349773226`*^9}, {
   3.6808850013417034`*^9, 3.6808850118309097`*^9}, {3.680885071364455*^9, 
   3.680885338050998*^9}, {3.680885369092225*^9, 3.6808854465825834`*^9}, {
   3.6808858161521587`*^9, 3.6808858165517445`*^9}, {3.680885969295744*^9, 
   3.680886034427628*^9}, {3.680886171713134*^9, 3.6808863538065033`*^9}, 
   3.6808863990841804`*^9, {3.6808864612464943`*^9, 3.680886529813063*^9}, {
   3.6808869456867824`*^9, 3.680886961764923*^9}, {3.6808870123576927`*^9, 
   3.680887019550462*^9}, {3.680887114898735*^9, 3.6808871182675095`*^9}, {
   3.680887181162428*^9, 3.680887187111746*^9}, {3.680887251367427*^9, 
   3.680887273892291*^9}, {3.680887323898876*^9, 3.680887325082522*^9}, {
   3.680887456347989*^9, 3.6808874620826855`*^9}, {3.6808875561244335`*^9, 
   3.680887573091951*^9}, {3.680887721148032*^9, 3.6808878253963804`*^9}, {
   3.680887892923795*^9, 3.680887895438401*^9}, {3.6808883279068727`*^9, 
   3.6808883742127953`*^9}, {3.6808887446347*^9, 3.6808888009663877`*^9}, {
   3.680888843084072*^9, 3.68088888217283*^9}, {3.6808889672984886`*^9, 
   3.680888980048806*^9}, {3.680889012873393*^9, 3.680889017001927*^9}, {
   3.6809607127676287`*^9, 3.680960713931309*^9}, {3.680963627939675*^9, 
   3.6809636936788006`*^9}, {3.680963725032446*^9, 3.68096375932222*^9}, {
   3.680963996232436*^9, 3.680964178133572*^9}, {3.680964213180361*^9, 
   3.6809642748716707`*^9}, {3.680964349959564*^9, 3.6809643607069154`*^9}, {
   3.6809643998686404`*^9, 3.680964423431587*^9}, {3.6809649940240765`*^9, 
   3.6809650555320835`*^9}, {3.680965297215009*^9, 3.680965374687066*^9}, {
   3.680965746541073*^9, 3.680965840873766*^9}, {3.680966028202756*^9, 
   3.6809661594200068`*^9}, {3.680966229724207*^9, 3.6809662777779217`*^9}, {
   3.6809663143619595`*^9, 3.680966336214636*^9}, {3.68096644404537*^9, 
   3.6809666533585944`*^9}, {3.680966782656155*^9, 3.68096684043402*^9}, {
   3.6809669531870036`*^9, 3.680967156904188*^9}, {3.6809672053008804`*^9, 
   3.680967224729057*^9}, {3.680967332314844*^9, 3.680967339149928*^9}, {
   3.6809673783050733`*^9, 3.6809674245168176`*^9}, {3.6809676623088226`*^9, 
   3.6809678364166517`*^9}, {3.6809683681222277`*^9, 
   3.6809686165290656`*^9}, {3.6809686831482697`*^9, 3.680968684388035*^9}, {
   3.680968722806388*^9, 3.6809688286478157`*^9}, {3.6809688660650325`*^9, 
   3.6809688731104565`*^9}, {3.680968922304273*^9, 3.680968979206273*^9}, {
   3.6809690865346055`*^9, 3.680969130012158*^9}, {3.680969781989382*^9, 
   3.680969872823762*^9}, {3.6809699400381446`*^9, 3.680970004489729*^9}, {
   3.6809700536833115`*^9, 3.6809700682716103`*^9}, {3.6809710208681808`*^9, 
   3.680971077002434*^9}, {3.680971109326406*^9, 3.680971115550733*^9}, {
   3.6809711907370863`*^9, 3.680971216592291*^9}, {3.680971278912956*^9, 
   3.6809712801192245`*^9}, {3.6809718771352825`*^9, 3.680971944993314*^9}, {
   3.6809720034773016`*^9, 3.6809720732264376`*^9}, {3.6809724406934075`*^9, 
   3.68097248602604*^9}, {3.6809726599472265`*^9, 3.6809726602954173`*^9}, {
   3.6809727230464745`*^9, 3.6809727291279593`*^9}, {3.680973017680879*^9, 
   3.6809730380391974`*^9}, {3.6809731227303166`*^9, 
   3.6809731466993895`*^9}, {3.680973762644851*^9, 3.6809737679144526`*^9}, {
   3.680973813745384*^9, 3.6809738243622527`*^9}, {3.6809739095062947`*^9, 
   3.680973940278738*^9}, {3.680973995792797*^9, 3.6809740011452093`*^9}, {
   3.6809740466010485`*^9, 3.680974060123784*^9}, {3.6809753469202642`*^9, 
   3.680975657929818*^9}, {3.680975695072091*^9, 3.6809758501681805`*^9}, {
   3.6809758996673946`*^9, 3.6809762262710686`*^9}, {3.680976301712438*^9, 
   3.6809763299510756`*^9}, {3.6809763746469035`*^9, 3.680976380499403*^9}, {
   3.6809764218826056`*^9, 3.6809765347847033`*^9}, {3.680976581667529*^9, 
   3.680976597026043*^9}, {3.680976666398885*^9, 3.6809766669610734`*^9}, {
   3.6809767210323706`*^9, 3.680976781558323*^9}, {3.6809768323302093`*^9, 
   3.680976846514173*^9}, {3.680976911357921*^9, 3.6809769209581203`*^9}, {
   3.680977049628893*^9, 3.6809771526850805`*^9}, {3.6809773883553143`*^9, 
   3.6809774793566475`*^9}, {3.6809775209278545`*^9, 3.680977521665044*^9}, {
   3.6809776512633805`*^9, 3.6809776515167046`*^9}, {3.680977712319936*^9, 
   3.6809777460168*^9}, {3.6810531539619203`*^9, 3.681053166959158*^9}, {
   3.6810532473507404`*^9, 3.6810532616980743`*^9}, {3.681053537630972*^9, 
   3.6810535971654816`*^9}, {3.6810536299030733`*^9, 3.681053764619897*^9}, {
   3.6810540191911044`*^9, 3.6810541426058364`*^9}, {3.681054193325778*^9, 
   3.681054202050123*^9}, {3.681054407650793*^9, 3.681054422525179*^9}, {
   3.6810544649467773`*^9, 3.6810544702728024`*^9}, {3.6810545196776843`*^9, 
   3.6810545642818737`*^9}, {3.6810546574028754`*^9, 
   3.6810546706011558`*^9}, {3.6811147611436043`*^9, 3.681114794728092*^9}, {
   3.681114882040724*^9, 3.6811148829097633`*^9}, {3.6811149340621448`*^9, 
   3.6811149841654096`*^9}, {3.6811151906954145`*^9, 3.68111537573689*^9}, {
   3.681115515816817*^9, 3.6811155891013746`*^9}, {3.6811156493781*^9, 
   3.681115666641453*^9}, {3.6811157198894944`*^9, 3.681115785849764*^9}, {
   3.681115827017232*^9, 3.6811158347965927`*^9}, {3.6811159033938723`*^9, 
   3.681116089029919*^9}, {3.681116213755548*^9, 3.681116272066968*^9}, {
   3.6811163405323725`*^9, 3.6811163422818956`*^9}, {3.6811164168073506`*^9, 
   3.6811164867154493`*^9}, {3.6811169255299654`*^9, 
   3.6811172248748937`*^9}, {3.681117258961213*^9, 3.6811174496638355`*^9}, {
   3.681117533579012*^9, 3.681117647560803*^9}, {3.681117763229082*^9, 
   3.681117783811084*^9}, {3.6811178439925947`*^9, 3.6811178454111786`*^9}, {
   3.6811178787361465`*^9, 3.681118062900173*^9}, {3.6811182140723333`*^9, 
   3.681118242911724*^9}, {3.681118570175209*^9, 3.681118576971583*^9}, {
   3.6811186959610105`*^9, 3.6811187586878242`*^9}, {3.6811187891790757`*^9, 
   3.681118790999563*^9}, {3.6811188571056223`*^9, 3.681118914067198*^9}, {
   3.6811189451494126`*^9, 3.681119011066283*^9}, {3.681119048258296*^9, 
   3.681119051434639*^9}, {3.681119092032136*^9, 3.681119104913178*^9}, {
   3.6811191834650784`*^9, 3.6811191867953424`*^9}, {3.6811196359476748`*^9, 
   3.681119688600884*^9}, {3.68111975028333*^9, 3.6811197807530875`*^9}, {
   3.6811198129044657`*^9, 3.681119817415021*^9}, 3.6811199829716883`*^9, {
   3.681120060387*^9, 3.68112008143056*^9}, {3.6811205197179084`*^9, 
   3.681120554142846*^9}, {3.68112059755657*^9, 3.6811209608421526`*^9}, {
   3.681121000321582*^9, 3.6811213121725974`*^9}, {3.68112299321381*^9, 
   3.681123012107442*^9}, {3.681123048832554*^9, 3.6811232172421627`*^9}, {
   3.6811273234720945`*^9, 3.681127432423428*^9}, {3.6811274800609336`*^9, 
   3.6811274809005604`*^9}, {3.6811275257683163`*^9, 3.681127578179681*^9}, {
   3.681127694826793*^9, 3.681127710789095*^9}, {3.6811278110887747`*^9, 
   3.681127844848827*^9}, {3.6811318326745567`*^9, 3.6811318616049323`*^9}, {
   3.6811320378293934`*^9, 3.6811321022246556`*^9}, {3.6811322022846727`*^9, 
   3.6811322197331595`*^9}, {3.681132275270756*^9, 3.681132303924238*^9}, {
   3.681132952546542*^9, 3.681132975747823*^9}, {3.6811330533869743`*^9, 
   3.681133069989792*^9}, {3.6811331401560717`*^9, 3.681133210129423*^9}, {
   3.68113355997246*^9, 3.681133580734687*^9}, {3.681133629200098*^9, 
   3.681133630070923*^9}, {3.6811337049047832`*^9, 3.6811337124057627`*^9}, {
   3.681133819975602*^9, 3.681133840938975*^9}, {3.681133980113397*^9, 
   3.6811339892678027`*^9}, {3.6811340593396463`*^9, 
   3.6811340697445583`*^9}, {3.6811341524626665`*^9, 3.681134155389428*^9}, {
   3.6811384085644703`*^9, 3.681138416451669*^9}, {3.6811384531639957`*^9, 
   3.6811387332515326`*^9}, {3.696326247015401*^9, 3.696326290249895*^9}, {
   3.6963263290758915`*^9, 3.6963263534943542`*^9}, {3.6963265499230905`*^9, 
   3.6963267199909678`*^9}, {3.6963267593116693`*^9, 
   3.6963269229873137`*^9}, {3.696326975109809*^9, 3.6963269771450577`*^9}, {
   3.6963270084709077`*^9, 3.6963270268753195`*^9}, {3.696327279707534*^9, 
   3.6963277124342194`*^9}, {3.6963277670566783`*^9, 
   3.6963279383852067`*^9}, {3.6963279795211296`*^9, 
   3.6963281839315977`*^9}, {3.696328216429962*^9, 3.696328350263246*^9}, {
   3.696328411126731*^9, 3.6963286380076227`*^9}, {3.6963286951665726`*^9, 
   3.6963289772073884`*^9}, {3.696329031822198*^9, 3.696329290347029*^9}, {
   3.6963293252573895`*^9, 3.696329474349821*^9}, {3.6963295071975946`*^9, 
   3.6963295732929854`*^9}, {3.6963296485433044`*^9, 
   3.6963296648466263`*^9}, {3.6963298886113076`*^9, 3.696329943964314*^9}, {
   3.6963299828627825`*^9, 3.696330037711483*^9}, {3.6963301105312886`*^9, 
   3.6963301559281893`*^9}, {3.69633018944613*^9, 3.696330215930565*^9}, {
   3.696330259860301*^9, 3.6963304438441257`*^9}, {3.696330475475258*^9, 
   3.6963306230483894`*^9}, {3.6963306563291655`*^9, 
   3.6963307206242332`*^9}, {3.6963345425594997`*^9, 3.696334563107193*^9}, {
   3.696334653622881*^9, 3.696334663105197*^9}, {3.6963351846429973`*^9, 
   3.696335191975522*^9}, {3.696338539683173*^9, 3.6963385468592424`*^9}, {
   3.6967009588676825`*^9, 3.6967009616899395`*^9}, {3.696701101654566*^9, 
   3.6967011779401827`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example", "Subsection",
 CellChangeTimes->{{3.6808847610415177`*^9, 3.680884762636571*^9}}],

Cell[CellGroupData[{

Cell["Ordering atoms using BuildUpOrdering method ", "Subsubsection",
 CellChangeTimes->{
  3.696335250480235*^9, {3.6963366417863913`*^9, 3.6963366443081226`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Simple", " ", 
    RowBox[{"Example", ":", " ", 
     RowBox[{"The", " ", "initial", " ", "ordering", " ", "is", " ", 
      RowBox[{"ok", "!"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"G", "=", 
     RowBox[{"Graph", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"1", "\[UndirectedEdge]", "2"}], ",", 
        RowBox[{"1", "\[UndirectedEdge]", "3"}], ",", 
        RowBox[{"1", "\[UndirectedEdge]", "4"}], ",", 
        RowBox[{"1", "\[UndirectedEdge]", "5"}], ",", 
        RowBox[{"2", "\[UndirectedEdge]", "3"}], ",", 
        RowBox[{"2", "\[UndirectedEdge]", "4"}], ",", 
        RowBox[{"2", "\[UndirectedEdge]", "5"}], ",", 
        RowBox[{"3", "\[UndirectedEdge]", "4"}], ",", 
        RowBox[{"3", "\[UndirectedEdge]", "5"}], ",", 
        RowBox[{"4", "\[UndirectedEdge]", "5"}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"GraphPlot", "[", 
      RowBox[{"G", ",", 
       RowBox[{"VertexLabeling", "\[Rule]", "True"}]}], "]"}], ",", 
     RowBox[{"PlotAdjacencyMatrix", "[", 
      RowBox[{"G", ",", "True"}], "]"}]}], "}"}], "\[IndentingNewLine]", 
   RowBox[{"i", "=", 
    RowBox[{"BuildUpOrdering", "[", 
     RowBox[{"G", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6963351391970744`*^9, 3.6963351781245375`*^9}, {
   3.6963352250157614`*^9, 3.6963352441326723`*^9}, {3.6966991356467*^9, 
   3.6966991599848185`*^9}, {3.696699212467594*^9, 3.696699212567856*^9}, 
   3.696699760565385*^9, {3.69669979452897*^9, 3.6966998652771873`*^9}, {
   3.6967008913917418`*^9, 3.696700901880651*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[
    TagBox[
     GraphicsComplexBox[{{-0.9510565162951538, 
      0.3090169943749484}, {-0.5877852522924726, -0.8090169943749468}, {
      0.5877852522924738, -0.8090169943749481}, {0.9510565162951533, 
      0.30901699437494634`}, {-7.044813998280222*^-16, 1.}}, {
       {RGBColor[0.5, 0., 0.], 
        LineBox[{{1, 2}, {1, 3}, {1, 4}, {1, 5}, {2, 3}, {2, 4}, {2, 5}, {3, 
         4}, {3, 5}, {4, 5}}]}, {InsetBox[
         FrameBox["1",
          Background->RGBColor[1, 1, 0.8],
          FrameStyle->RGBColor[0.94, 0.85, 0.36],
          StripOnInput->False], 1], InsetBox[
         FrameBox["2",
          Background->RGBColor[1, 1, 0.8],
          FrameStyle->RGBColor[0.94, 0.85, 0.36],
          StripOnInput->False], 2], InsetBox[
         FrameBox["3",
          Background->RGBColor[1, 1, 0.8],
          FrameStyle->RGBColor[0.94, 0.85, 0.36],
          StripOnInput->False], 3], InsetBox[
         FrameBox["4",
          Background->RGBColor[1, 1, 0.8],
          FrameStyle->RGBColor[0.94, 0.85, 0.36],
          StripOnInput->False], 4], InsetBox[
         FrameBox["5",
          Background->RGBColor[1, 1, 0.8],
          FrameStyle->RGBColor[0.94, 0.85, 0.36],
          StripOnInput->False], 5]}}],
     Annotation[#, 
      VertexCoordinateRules -> {{-0.9510565162951538, 
       0.3090169943749484}, {-0.5877852522924726, -0.8090169943749468}, {
       0.5877852522924738, -0.8090169943749481}, {0.9510565162951533, 
       0.30901699437494634`}, {-7.044813998280222*^-16, 1.}}]& ],
    AspectRatio->Automatic,
    FrameTicks->None,
    PlotRange->All,
    PlotRangePadding->Scaled[0.1]], ",", 
   GraphicsBox[{
     {RGBColor[1, 0, 0], Opacity[0.2], 
      TagBox[PolygonBox[{{5, 1}, {5, 5}, {1, 5}}],
       "Triangle"]}, 
     {PointSize[Medium], 
      PointBox[{{2, 5}, {3, 5}, {4, 5}, {5, 5}, {3, 4}, {4, 4}, {5, 4}, {4, 
       3}, {5, 3}, {5, 2}}]}, 
     {RGBColor[1, 0, 0], Dashing[{Small, Small}], LineBox[{{1, 5}, {5, 1}}]}},
    Axes->True,
    AxesOrigin->{1, 1},
    GridLines->Automatic,
    Ticks->{Automatic, {{1, 
        FormBox["5", TraditionalForm]}, {2, 
        FormBox["4", TraditionalForm]}, {3, 
        FormBox["3", TraditionalForm]}, {4, 
        FormBox["2", TraditionalForm]}, {5, 
        FormBox["1", TraditionalForm]}}}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6966997215744925`*^9, 3.696699762368534*^9, {3.69669985346739*^9, 
   3.696699867614601*^9}, {3.6967008833346953`*^9, 3.696700902914832*^9}, 
   3.6967009722090564`*^9, 3.696701194458383*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6966997215744925`*^9, 3.696699762368534*^9, {3.69669985346739*^9, 
   3.696699867614601*^9}, {3.6967008833346953`*^9, 3.696700902914832*^9}, 
   3.6967009722090564`*^9, 3.696701194474007*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Harder", " ", 
   RowBox[{"Example", ":", " ", 
    RowBox[{
    "The", " ", "initial", " ", "ordering", " ", "is", " ", "not", " ", 
     "valid"}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6966991879927807`*^9, 3.696699204059147*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"edges", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "\[UndirectedEdge]", "2"}], ",", 
     RowBox[{"1", "\[UndirectedEdge]", "3"}], ",", 
     RowBox[{"1", "\[UndirectedEdge]", "4"}], ",", 
     RowBox[{"1", "\[UndirectedEdge]", "7"}], ",", 
     RowBox[{"1", "\[UndirectedEdge]", "8"}], ",", 
     RowBox[{"2", "\[UndirectedEdge]", "3"}], ",", 
     RowBox[{"2", "\[UndirectedEdge]", "4"}], ",", 
     RowBox[{"2", "\[UndirectedEdge]", "5"}], ",", 
     RowBox[{"2", "\[UndirectedEdge]", "6"}], ",", 
     RowBox[{"2", "\[UndirectedEdge]", "8"}], ",", 
     RowBox[{"3", "\[UndirectedEdge]", "4"}], ",", 
     RowBox[{"3", "\[UndirectedEdge]", "7"}], ",", 
     RowBox[{"3", "\[UndirectedEdge]", "8"}], ",", 
     RowBox[{"4", "\[UndirectedEdge]", "6"}], ",", 
     RowBox[{"4", "\[UndirectedEdge]", "7"}], ",", 
     RowBox[{"4", "\[UndirectedEdge]", "8"}], ",", 
     RowBox[{"4", "\[UndirectedEdge]", "5"}], ",", 
     RowBox[{"5", "\[UndirectedEdge]", "6"}], ",", 
     RowBox[{"5", "\[UndirectedEdge]", "7"}], ",", 
     RowBox[{"6", "\[UndirectedEdge]", "7"}], ",", 
     RowBox[{"6", "\[UndirectedEdge]", "8"}], ",", 
     RowBox[{"7", "\[UndirectedEdge]", "8"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"Graph", "[", "edges", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{
   RowBox[{"GraphPlot", "[", 
    RowBox[{"G", ",", 
     RowBox[{"VertexLabeling", "\[Rule]", "True"}]}], "]"}], ",", 
   RowBox[{"PlotAdjacencyMatrix", "[", 
    RowBox[{"G", ",", "True"}], "]"}]}], "}"}], "\[IndentingNewLine]", 
 RowBox[{"i", "=", 
  RowBox[{"BuildUpOrdering", "[", 
   RowBox[{"G", ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", "True"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.696699222452924*^9, 3.6966993598737216`*^9}, {
  3.6966993928242817`*^9, 3.69669964645918*^9}, {3.6966996846742587`*^9, 
  3.6966996863586435`*^9}, {3.696699787441859*^9, 3.6966997902261276`*^9}, {
  3.696699983277195*^9, 3.696700066799402*^9}, {3.6967001159283457`*^9, 
  3.6967001463737307`*^9}, {3.696700378130589*^9, 3.696700406037734*^9}, {
  3.6967008496726646`*^9, 3.696700855375781*^9}, {3.6967012062244864`*^9, 
  3.6967012420923347`*^9}, {3.6967013615844746`*^9, 3.696701364078554*^9}, {
  3.6967014049615245`*^9, 3.6967014090833235`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[
    TagBox[
     GraphicsComplexBox[{{0.2201364009269462, 1.030980580344115}, {
      1.1130445584309527`, 0.}, {0., 0.4294270005706362}, {1.095691072601297, 
      0.6505122461849997}, {1.0491244756787474`, 1.1794990727199575`}, {
      0.5531324991014905, 0.08045910464541084}, {2.100483218682584, 
      0.9014058445027913}, {1.8248187044662827`, 0.16135316934500915`}}, {
       {RGBColor[0.5, 0., 0.], 
        LineBox[{{1, 2}, {1, 3}, {1, 4}, {1, 5}, {1, 6}, {2, 3}, {2, 4}, {2, 
         6}, {2, 7}, {2, 8}, {3, 4}, {3, 5}, {3, 6}, {4, 5}, {4, 6}, {4, 7}, {
         4, 8}, {5, 6}, {5, 7}, {5, 8}, {6, 8}, {7, 8}}]}, {InsetBox[
         FrameBox["1",
          Background->RGBColor[1, 1, 0.8],
          FrameStyle->RGBColor[0.94, 0.85, 0.36],
          StripOnInput->False], 1], InsetBox[
         FrameBox["2",
          Background->RGBColor[1, 1, 0.8],
          FrameStyle->RGBColor[0.94, 0.85, 0.36],
          StripOnInput->False], 2], InsetBox[
         FrameBox["3",
          Background->RGBColor[1, 1, 0.8],
          FrameStyle->RGBColor[0.94, 0.85, 0.36],
          StripOnInput->False], 3], InsetBox[
         FrameBox["4",
          Background->RGBColor[1, 1, 0.8],
          FrameStyle->RGBColor[0.94, 0.85, 0.36],
          StripOnInput->False], 4], InsetBox[
         FrameBox["5",
          Background->RGBColor[1, 1, 0.8],
          FrameStyle->RGBColor[0.94, 0.85, 0.36],
          StripOnInput->False], 5], InsetBox[
         FrameBox["6",
          Background->RGBColor[1, 1, 0.8],
          FrameStyle->RGBColor[0.94, 0.85, 0.36],
          StripOnInput->False], 6], InsetBox[
         FrameBox["7",
          Background->RGBColor[1, 1, 0.8],
          FrameStyle->RGBColor[0.94, 0.85, 0.36],
          StripOnInput->False], 7], InsetBox[
         FrameBox["8",
          Background->RGBColor[1, 1, 0.8],
          FrameStyle->RGBColor[0.94, 0.85, 0.36],
          StripOnInput->False], 8]}}],
     Annotation[#, 
      VertexCoordinateRules -> {{0.2201364009269462, 1.030980580344115}, {
       1.1130445584309527`, 0.}, {0., 0.4294270005706362}, {1.095691072601297,
        0.6505122461849997}, {1.0491244756787474`, 1.1794990727199575`}, {
       0.5531324991014905, 0.08045910464541084}, {2.100483218682584, 
       0.9014058445027913}, {1.8248187044662827`, 0.16135316934500915`}}]& ],
    AspectRatio->Automatic,
    FrameTicks->None,
    ImageSize->{326.6666666666662, Automatic},
    PlotRange->All,
    PlotRangePadding->Scaled[0.1]], ",", 
   GraphicsBox[{
     {RGBColor[1, 0, 0], Opacity[0.2], 
      TagBox[PolygonBox[{{8, 1}, {8, 8}, {1, 8}}],
       "Triangle"]}, 
     {PointSize[Medium], 
      PointBox[{{2, 8}, {3, 8}, {4, 8}, {7, 8}, {8, 8}, {3, 7}, {4, 7}, {5, 
       7}, {6, 7}, {8, 7}, {4, 6}, {7, 6}, {8, 6}, {6, 5}, {7, 5}, {8, 5}, {5,
        5}, {6, 4}, {7, 4}, {7, 3}, {8, 3}, {8, 2}}]}, 
     {RGBColor[1, 0, 0], Dashing[{Small, Small}], LineBox[{{1, 8}, {8, 1}}]}},
    Axes->True,
    AxesOrigin->{1, 1},
    GridLines->Automatic,
    Ticks->{Automatic, {{1, 
        FormBox["8", TraditionalForm]}, {2, 
        FormBox["7", TraditionalForm]}, {3, 
        FormBox["6", TraditionalForm]}, {4, 
        FormBox["5", TraditionalForm]}, {5, 
        FormBox["4", TraditionalForm]}, {6, 
        FormBox["3", TraditionalForm]}, {7, 
        FormBox["2", TraditionalForm]}, {8, 
        FormBox["1", TraditionalForm]}}}]}], "}"}]], "Output",
 CellChangeTimes->{3.6967014099616113`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nFixedNeighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["nFixedNeighs=", {
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 0, 0, 0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014099616113`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomsToBeFixed=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}],
  SequenceForm["atomsToBeFixed=", {1, 2, 3, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{3.696701409981251*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fixing: \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["Fixing: ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{3.696701409983757*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomOrder=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}],
  SequenceForm["atomOrder=", {1, 0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014099993844`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"neighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "4", ",", "7", ",", "8"}], "}"}]}],
  SequenceForm["neighs=", {2, 3, 4, 7, 8}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014100150137`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nFixedNeighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]",
      ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["nFixedNeighs=", {
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 0, 0, 1, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014100150137`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomsToBeFixed=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "4"}], "}"}]}],
  SequenceForm["atomsToBeFixed=", {2, 3, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014100306387`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fixing: \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["Fixing: ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{3.696701410046265*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomOrder=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}],
  SequenceForm["atomOrder=", {1, 2, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{3.696701410046265*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"neighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "4", ",", "8", ",", "5", ",", "6"}], "}"}]}],
  SequenceForm["neighs=", {1, 3, 4, 8, 5, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014100618877`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nFixedNeighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]",
      ",", "1", ",", "1", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["nFixedNeighs=", {
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 1, 1, 1, 2}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014100795355`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomsToBeFixed=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}]}],
  SequenceForm["atomsToBeFixed=", {3, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014100840373`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fixing: \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["Fixing: ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014100996733`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomOrder=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "3", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}],
  SequenceForm["atomOrder=", {1, 2, 3, 0, 0, 0, 0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014100996733`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"neighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "4", ",", "7", ",", "8"}], "}"}]}],
  SequenceForm["neighs=", {1, 2, 4, 7, 8}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014101152983`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nFixedNeighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]",
      ",", "1", ",", "1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["nFixedNeighs=", {
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 1, 1, 2, 3}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014101309304`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomsToBeFixed=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["atomsToBeFixed=", {4}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014101309304`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fixing: \"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["Fixing: ", 4],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014101465535`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomOrder=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "3", ",", "4", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}],
  SequenceForm["atomOrder=", {1, 2, 3, 4, 0, 0, 0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014101465535`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"neighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "7", ",", "8", ",", "5", ",", "6"}],
     "}"}]}],
  SequenceForm["neighs=", {1, 2, 3, 7, 8, 5, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.696701410162179*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nFixedNeighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]",
      ",", "2", ",", "2", ",", "3", ",", "4"}], "}"}]}],
  SequenceForm["nFixedNeighs=", {
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 2, 2, 3, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{3.696701410182319*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomsToBeFixed=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["atomsToBeFixed=", {8}],
  Editable->False]], "Print",
 CellChangeTimes->{3.696701410184327*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fixing: \"\>", "\[InvisibleSpace]", "8"}],
  SequenceForm["Fixing: ", 8],
  Editable->False]], "Print",
 CellChangeTimes->{3.696701410184327*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomOrder=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "3", ",", "4", ",", "0", ",", "0", ",", "0", ",", 
     "5"}], "}"}]}],
  SequenceForm["atomOrder=", {1, 2, 3, 4, 0, 0, 0, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{3.696701410199956*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"neighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "7", ",", "6"}], "}"}]}],
  SequenceForm["neighs=", {1, 2, 3, 4, 7, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014102155857`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nFixedNeighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]",
      ",", "2", ",", "3", ",", "4", ",", "4"}], "}"}]}],
  SequenceForm["nFixedNeighs=", {
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 2, 3, 4, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014102155857`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomsToBeFixed=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "7", "}"}]}],
  SequenceForm["atomsToBeFixed=", {7}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014102312126`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fixing: \"\>", "\[InvisibleSpace]", "7"}],
  SequenceForm["Fixing: ", 7],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014102312126`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomOrder=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "3", ",", "4", ",", "0", ",", "0", ",", "6", ",", 
     "5"}], "}"}]}],
  SequenceForm["atomOrder=", {1, 2, 3, 4, 0, 0, 6, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014102468305`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"neighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "4", ",", "8", ",", "5", ",", "6"}], "}"}]}],
  SequenceForm["neighs=", {1, 3, 4, 8, 5, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.696701410262457*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nFixedNeighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]",
      ",", "3", ",", "4", ",", "4", ",", "5"}], "}"}]}],
  SequenceForm["nFixedNeighs=", {
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 3, 4, 4, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{3.696701410262457*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomsToBeFixed=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["atomsToBeFixed=", {6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.696701410282609*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fixing: \"\>", "\[InvisibleSpace]", "6"}],
  SequenceForm["Fixing: ", 6],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014102846065`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomOrder=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "3", ",", "4", ",", "0", ",", "7", ",", "6", ",", 
     "5"}], "}"}]}],
  SequenceForm["atomOrder=", {1, 2, 3, 4, 0, 7, 6, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014102846065`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"neighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "7", ",", "8", ",", "5"}], "}"}]}],
  SequenceForm["neighs=", {2, 4, 7, 8, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014103002443`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nFixedNeighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]",
      ",", "4", ",", "4", ",", "5", ",", "6"}], "}"}]}],
  SequenceForm["nFixedNeighs=", {
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 4, 4, 5, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014103158717`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomsToBeFixed=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "5", "}"}]}],
  SequenceForm["atomsToBeFixed=", {5}],
  Editable->False]], "Print",
 CellChangeTimes->{3.6967014103158717`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fixing: \"\>", "\[InvisibleSpace]", "5"}],
  SequenceForm["Fixing: ", 5],
  Editable->False]], "Print",
 CellChangeTimes->{3.696701410331491*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomOrder=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "3", ",", "4", ",", "8", ",", "7", ",", "6", ",", 
     "5"}], "}"}]}],
  SequenceForm["atomOrder=", {1, 2, 3, 4, 8, 7, 6, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{3.696701410331491*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"neighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "7", ",", "6"}], "}"}]}],
  SequenceForm["neighs=", {2, 4, 7, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{3.696701410347118*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "2", ",", "3", ",", "4", ",", "8", ",", "7", ",", "6", ",", "5"}],
   "}"}]], "Output",
 CellChangeTimes->{3.696701410347118*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[
    TagBox[
     GeometricTransformationBox[
      GraphicsComplexBox[{{1.9629000240646646`, 0.6535236293115947}, {
       1.3113739894596574`, 1.4000078660215696`}, {1.304961752625168, 
       0.5710033059452878}, {0.767490222901031, 0.8561007972736039}, {
       0.7409097176431163, 0.04685643849687049}, {1.405626861359698, 0.}, {0.,
        1.133060758114075}, {0.12661733011298015`, 0.14110219074373742`}}, {
        {RGBColor[0.5, 0., 0.], 
         LineBox[{{1, 2}, {1, 3}, {1, 4}, {1, 5}, {1, 6}, {2, 3}, {2, 4}, {2, 
          6}, {2, 7}, {3, 4}, {3, 5}, {3, 6}, {3, 8}, {4, 5}, {4, 6}, {4, 
          7}, {4, 8}, {5, 6}, {5, 7}, {5, 8}, {6, 8}, {7, 8}}]}, {InsetBox[
          FrameBox["1",
           Background->RGBColor[1, 1, 0.8],
           FrameStyle->RGBColor[0.94, 0.85, 0.36],
           StripOnInput->False], 1], InsetBox[
          FrameBox["2",
           Background->RGBColor[1, 1, 0.8],
           FrameStyle->RGBColor[0.94, 0.85, 0.36],
           StripOnInput->False], 2], InsetBox[
          FrameBox["3",
           Background->RGBColor[1, 1, 0.8],
           FrameStyle->RGBColor[0.94, 0.85, 0.36],
           StripOnInput->False], 3], InsetBox[
          FrameBox["4",
           Background->RGBColor[1, 1, 0.8],
           FrameStyle->RGBColor[0.94, 0.85, 0.36],
           StripOnInput->False], 4], InsetBox[
          FrameBox["5",
           Background->RGBColor[1, 1, 0.8],
           FrameStyle->RGBColor[0.94, 0.85, 0.36],
           StripOnInput->False], 5], InsetBox[
          FrameBox["6",
           Background->RGBColor[1, 1, 0.8],
           FrameStyle->RGBColor[0.94, 0.85, 0.36],
           StripOnInput->False], 6], InsetBox[
          FrameBox["7",
           Background->RGBColor[1, 1, 0.8],
           FrameStyle->RGBColor[0.94, 0.85, 0.36],
           StripOnInput->False], 7], InsetBox[
          FrameBox["8",
           Background->RGBColor[1, 1, 0.8],
           FrameStyle->RGBColor[0.94, 0.85, 0.36],
           StripOnInput->False], 8]}}], {{0.07513760543132653, 
      0.005335422663418576}}],
     Annotation[#, 
      VertexCoordinateRules -> {{1.9629000240646646`, 0.6535236293115947}, {
       1.3113739894596574`, 1.4000078660215696`}, {1.304961752625168, 
       0.5710033059452878}, {0.767490222901031, 0.8561007972736039}, {
       0.7409097176431163, 0.04685643849687049}, {1.405626861359698, 0.}, {0.,
        1.133060758114075}, {0.12661733011298015`, 0.14110219074373742`}}]& ],
    AspectRatio->Automatic,
    FrameTicks->None,
    ImagePadding->{{0., 0.952381}, {0.952381, 0.}},
    ImageSize->{267.6190476190476, Automatic},
    PlotRange->{{-0.24536250300808304`, 
     2.2082625270727476`}, {-0.1750009832526962, 1.5750088492742658`}},
    PlotRangePadding->Automatic], ",", 
   GraphicsBox[{
     {RGBColor[1, 0, 0], Opacity[0.2], 
      TagBox[PolygonBox[{{8, 1}, {8, 8}, {1, 8}}],
       "Triangle"]}, 
     {PointSize[Medium], 
      PointBox[{{2, 8}, {3, 8}, {4, 8}, {7, 8}, {8, 8}, {3, 7}, {4, 7}, {5, 
       7}, {8, 7}, {4, 6}, {6, 6}, {7, 6}, {8, 6}, {6, 5}, {7, 5}, {8, 5}, {5,
        5}, {6, 4}, {7, 4}, {7, 3}, {8, 3}, {8, 2}}]}, 
     {RGBColor[1, 0, 0], Dashing[{Small, Small}], LineBox[{{1, 8}, {8, 1}}]}},
    Axes->True,
    AxesOrigin->{1, 1},
    GridLines->Automatic,
    Ticks->{Automatic, {{1, 
        FormBox["8", TraditionalForm]}, {2, 
        FormBox["7", TraditionalForm]}, {3, 
        FormBox["6", TraditionalForm]}, {4, 
        FormBox["5", TraditionalForm]}, {5, 
        FormBox["4", TraditionalForm]}, {6, 
        FormBox["3", TraditionalForm]}, {7, 
        FormBox["2", TraditionalForm]}, {8, 
        FormBox["1", TraditionalForm]}}}]}], "}"}]], "Input",
 CellChangeTimes->{3.696701380955738*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nFixedNeighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
  SequenceForm["nFixedNeighs=", {
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 0, 0, 0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.69670136616284*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomsToBeFixed=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}],
  SequenceForm["atomsToBeFixed=", {1, 2, 3, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.69670136616284*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fixing: \"\>", "\[InvisibleSpace]", "1"}],
  SequenceForm["Fixing: ", 1],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366178464*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomOrder=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}],
  SequenceForm["atomOrder=", {1, 0, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366184986*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"neighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "4", ",", "7", ",", "8"}], "}"}]}],
  SequenceForm["neighs=", {2, 3, 4, 7, 8}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366184986*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nFixedNeighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]",
      ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}]}],
  SequenceForm["nFixedNeighs=", {
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 0, 0, 1, 1}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366200612*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomsToBeFixed=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "4"}], "}"}]}],
  SequenceForm["atomsToBeFixed=", {2, 3, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366200612*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fixing: \"\>", "\[InvisibleSpace]", "2"}],
  SequenceForm["Fixing: ", 2],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366216239*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomOrder=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}],
  SequenceForm["atomOrder=", {1, 2, 0, 0, 0, 0, 0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366216239*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"neighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "4", ",", "8", ",", "5"}], "}"}]}],
  SequenceForm["neighs=", {1, 3, 4, 8, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.6967013662318635`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nFixedNeighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]",
      ",", "1", ",", "0", ",", "1", ",", "2"}], "}"}]}],
  SequenceForm["nFixedNeighs=", {
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 1, 0, 1, 2}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.6967013662318635`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomsToBeFixed=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4"}], "}"}]}],
  SequenceForm["atomsToBeFixed=", {3, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366247491*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fixing: \"\>", "\[InvisibleSpace]", "3"}],
  SequenceForm["Fixing: ", 3],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366247491*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomOrder=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "3", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}],
  SequenceForm["atomOrder=", {1, 2, 3, 0, 0, 0, 0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.6967013662631164`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"neighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "4", ",", "7", ",", "8", ",", "6"}], "}"}]}],
  SequenceForm["neighs=", {1, 2, 4, 7, 8, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.6967013662631164`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nFixedNeighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]",
      ",", "1", ",", "1", ",", "2", ",", "3"}], "}"}]}],
  SequenceForm["nFixedNeighs=", {
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 1, 1, 2, 3}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366282756*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomsToBeFixed=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "4", "}"}]}],
  SequenceForm["atomsToBeFixed=", {4}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366285262*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fixing: \"\>", "\[InvisibleSpace]", "4"}],
  SequenceForm["Fixing: ", 4],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366285262*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomOrder=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "3", ",", "4", ",", "0", ",", "0", ",", "0", ",", 
     "0"}], "}"}]}],
  SequenceForm["atomOrder=", {1, 2, 3, 4, 0, 0, 0, 0}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366300889*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"neighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "7", ",", "8", ",", "5", ",", "6"}],
     "}"}]}],
  SequenceForm["neighs=", {1, 2, 3, 7, 8, 5, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366300889*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nFixedNeighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]",
      ",", "2", ",", "2", ",", "3", ",", "4"}], "}"}]}],
  SequenceForm["nFixedNeighs=", {
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 2, 2, 3, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366316515*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomsToBeFixed=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "8", "}"}]}],
  SequenceForm["atomsToBeFixed=", {8}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366332141*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fixing: \"\>", "\[InvisibleSpace]", "8"}],
  SequenceForm["Fixing: ", 8],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366332141*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomOrder=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "3", ",", "4", ",", "0", ",", "0", ",", "0", ",", 
     "5"}], "}"}]}],
  SequenceForm["atomOrder=", {1, 2, 3, 4, 0, 0, 0, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366332141*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"neighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "7", ",", "6"}], "}"}]}],
  SequenceForm["neighs=", {1, 2, 3, 4, 7, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366347767*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nFixedNeighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]",
      ",", "2", ",", "3", ",", "4", ",", "4"}], "}"}]}],
  SequenceForm["nFixedNeighs=", {
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 2, 3, 4, 4}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366347767*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomsToBeFixed=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "7", "}"}]}],
  SequenceForm["atomsToBeFixed=", {7}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.6967013663633933`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fixing: \"\>", "\[InvisibleSpace]", "7"}],
  SequenceForm["Fixing: ", 7],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.6967013663633933`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomOrder=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "3", ",", "4", ",", "0", ",", "0", ",", "6", ",", 
     "5"}], "}"}]}],
  SequenceForm["atomOrder=", {1, 2, 3, 4, 0, 0, 6, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.6967013663820314`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"neighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "3", ",", "4", ",", "8", ",", "5", ",", "6"}], "}"}]}],
  SequenceForm["neighs=", {1, 3, 4, 8, 5, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366385537*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nFixedNeighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]",
      ",", "3", ",", "4", ",", "4", ",", "5"}], "}"}]}],
  SequenceForm["nFixedNeighs=", {
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 3, 4, 4, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366385537*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomsToBeFixed=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "6", "}"}]}],
  SequenceForm["atomsToBeFixed=", {6}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.6967013664011717`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fixing: \"\>", "\[InvisibleSpace]", "6"}],
  SequenceForm["Fixing: ", 6],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.6967013664011717`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomOrder=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "3", ",", "4", ",", "0", ",", "7", ",", "6", ",", 
     "5"}], "}"}]}],
  SequenceForm["atomOrder=", {1, 2, 3, 4, 0, 7, 6, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366416791*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"neighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "7", ",", "8", ",", "5"}], "}"}]}],
  SequenceForm["neighs=", {3, 4, 7, 8, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366416791*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"nFixedNeighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]", ",", "\[Infinity]",
      ",", "4", ",", "4", ",", "5", ",", "6"}], "}"}]}],
  SequenceForm["nFixedNeighs=", {
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 
    DirectedInfinity[1], 4, 4, 5, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366432416*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomsToBeFixed=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "5", "}"}]}],
  SequenceForm["atomsToBeFixed=", {5}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366432416*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Fixing: \"\>", "\[InvisibleSpace]", "5"}],
  SequenceForm["Fixing: ", 5],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366448048*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"atomOrder=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "2", ",", "3", ",", "4", ",", "8", ",", "7", ",", "6", ",", 
     "5"}], "}"}]}],
  SequenceForm["atomOrder=", {1, 2, 3, 4, 8, 7, 6, 5}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366448048*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"neighs=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "7", ",", "6"}], "}"}]}],
  SequenceForm["neighs=", {2, 4, 7, 6}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6966998768005533`*^9, 3.696700010564171*^9, 3.6967000691675105`*^9, 
   3.6967001479650297`*^9, 3.6967003011743364`*^9, {3.6967003611901255`*^9, 
   3.6967004068705015`*^9}, 3.696700446611411*^9, 3.69670085336008*^9, 
   3.6967009146842375`*^9, 3.6967009928575363`*^9, 3.696701208505991*^9, 
   3.6967012443076267`*^9, 3.696701366463669*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "2", ",", "3", ",", "4", ",", "8", ",", "7", ",", "6", ",", "5"}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.6966994015629272`*^9, {3.6966994401476507`*^9, 3.6966995778330116`*^9}, 
   3.696699649859806*^9, {3.69669968774351*^9, 3.6966996915279217`*^9}, 
   3.6966997218909616`*^9, 3.6966998767849274`*^9, 3.696700010542028*^9, 
   3.6967000691206255`*^9, 3.696700147928505*^9, 3.6967003011899643`*^9, {
   3.6967003612057505`*^9, 3.696700406917378*^9}, 3.696700446627036*^9, 
   3.696700853422597*^9, 3.6967009146620913`*^9, 3.6967009928262854`*^9, 
   3.6967012084682183`*^9, 3.6967012442731037`*^9, 3.696701366463669*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Solving an instance using BuilUpSolver method ", "Subsubsection",
 CellChangeTimes->{3.696335266702453*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"GenerateRandomMDGP", "[", 
    RowBox[{"5", ",", "5", ",", "0"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"M", "[", "\"\<X\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"M", "[", "\"\<G\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{"BuildUpSolver", "[", "G", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<LDME=\>\"", ",", 
   RowBox[{"LDME", "[", 
    RowBox[{"G", ",", "S"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", "S", "\[IndentingNewLine]", 
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{
      RowBox[{"S", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "-", 
      RowBox[{"S", "[", 
       RowBox[{"[", "5", "]"}], "]"}]}], "]"}], "^", "2"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "4"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6811193723446083`*^9, 3.681119412620857*^9}, {
   3.6811199311928988`*^9, 3.681119960930756*^9}, {3.681119990991001*^9, 
   3.6811200405793905`*^9}, {3.6811230224344797`*^9, 3.681123028526058*^9}, {
   3.6811277224020305`*^9, 3.6811277237741623`*^9}, {3.6811285593560123`*^9, 
   3.681128578782134*^9}, {3.6811286737619624`*^9, 3.681128765537285*^9}, {
   3.681128804607932*^9, 3.6811288239519253`*^9}, {3.681130635133052*^9, 
   3.6811306585684404`*^9}, {3.681132006711861*^9, 3.6811320068519697`*^9}, {
   3.6811322329539566`*^9, 3.6811322568870325`*^9}, {3.681132509241618*^9, 
   3.681132516105033*^9}, {3.6811328599020844`*^9, 3.681132874485738*^9}, {
   3.6811342789491444`*^9, 3.6811343056250167`*^9}, {3.6815665500810804`*^9, 
   3.681566551437929*^9}, {3.681569740351883*^9, 3.681569740852806*^9}, {
   3.6815710193111305`*^9, 3.681571023000434*^9}, {3.6815714400430307`*^9, 
   3.681571491286482*^9}, 3.682752354751058*^9, 3.682757377921311*^9, {
   3.69633473379433*^9, 3.696334739241384*^9}, 3.696335048087739*^9, {
   3.6963351061616244`*^9, 3.696335135730406*^9}, {3.696335254918723*^9, 
   3.6963352586483583`*^9}}],

Cell[BoxData["G"], "Input",
 CellChangeTimes->{{3.696334923014681*^9, 3.6963349313084607`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["GASolver", "Section",
 CellChangeTimes->{{3.6811203277692585`*^9, 3.681120330322966*^9}}],

Cell[CellGroupData[{

Cell["Source Code", "Subsection",
 CellChangeTimes->{{3.6811203529955482`*^9, 3.6811203596894712`*^9}}],

Cell[CellGroupData[{

Cell["GASolver", "Subsubsection",
 CellChangeTimes->{{3.681130895375606*^9, 3.681130897976305*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "GASolver", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GANextBasis", "[", 
     RowBox[{"G_", ",", "F_", ",", "U_", ",", 
      RowBox[{"verbose_:", "False"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "u", ",", "P", ",", "basis"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "U", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"u", "=", 
           RowBox[{"U", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"P", "=", 
           RowBox[{"Intersection", "[", 
            RowBox[{
             RowBox[{"AdjacencyList", "[", 
              RowBox[{"G", ",", "u"}], "]"}], ",", "F"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "P", "]"}], "\[GreaterEqual]", "4"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"basis", "=", 
              RowBox[{"Take", "[", 
               RowBox[{"P", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"Return", "[", "basis", "]"}]}]}], "]"}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Throw", "[", "\"\<BasisCouldNotBeFound\>\"", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GASetPosition", "[", 
     RowBox[{"G_", ",", "X_", ",", "S_", ",", "basis_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "d", ",", "r", ",", "w", ",", "A", ",", "B", ",", "C", ",", 
        "D", ",", "x", ",", "y", ",", "z", ",", "s", ",", "u", ",", "Y"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Y", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "S", "]"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"get", " ", "basis", " ", "coords"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x", ",", "y", ",", "z", ",", "s"}], "}"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"[", 
            RowBox[{"basis", "[", 
             RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", "S", "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"u", "=", 
           RowBox[{"S", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"get", " ", "distances"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"r", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"GetEdgeWeight", "[", 
              RowBox[{"G", ",", 
               RowBox[{"u", "\[Rule]", 
                RowBox[{"basis", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"get", " ", "factors"}], " ", "*)"}], " ", 
          "\[IndentingNewLine]", 
          RowBox[{"w", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "^", "2"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "-", 
              RowBox[{
               RowBox[{"r", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], ",", 
             RowBox[{
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"y", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "^", "2"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "-", 
              RowBox[{
               RowBox[{"r", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], ",", 
             RowBox[{
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"z", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "^", "2"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "-", 
              RowBox[{
               RowBox[{"r", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}], ",", 
             RowBox[{
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"s", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "^", "2"}], ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "-", 
              RowBox[{
               RowBox[{"r", "[", 
                RowBox[{"[", "4", "]"}], "]"}], "^", "2"}]}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"A", "=", 
           RowBox[{"0.5", "*", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", 
                   RowBox[{"y", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "*", 
                   RowBox[{"y", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "*", 
                RowBox[{"w", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "*", 
                   RowBox[{"z", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", 
                   RowBox[{"z", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], ")"}], "*", 
                RowBox[{"w", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"y", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", 
                   RowBox[{"z", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"y", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "*", 
                   RowBox[{"z", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "*", 
                RowBox[{"w", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "*", 
                   RowBox[{"y", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", 
                   RowBox[{"y", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], ")"}], "*", 
                RowBox[{"w", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", 
                   RowBox[{"z", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "*", 
                   RowBox[{"z", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "*", 
                RowBox[{"w", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"y", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], "*", 
                   RowBox[{"z", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"y", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", 
                   RowBox[{"z", "[", 
                    RowBox[{"[", "3", "]"}], "]"}]}]}], ")"}], "*", 
                RowBox[{"w", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", 
                   RowBox[{"y", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", 
                   RowBox[{"y", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "*", 
                RowBox[{"w", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", 
                   RowBox[{"z", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"x", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", 
                   RowBox[{"z", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "*", 
                RowBox[{"w", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"y", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "*", 
                   RowBox[{"z", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], "-", 
                  RowBox[{
                   RowBox[{"y", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "*", 
                   RowBox[{"z", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "*", 
                RowBox[{"w", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"B", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{"y", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{"z", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "*", 
               RowBox[{"y", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "*", 
               RowBox[{"z", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{"z", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "*", 
               RowBox[{"z", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "*", 
               RowBox[{"y", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "*", 
               RowBox[{"z", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{"y", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{"z", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "*", 
               RowBox[{"z", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{"z", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{"y", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{"z", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{"y", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{"z", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{"z", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"y", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{"z", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"C", "=", 
           RowBox[{"0.5", "*", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                RowBox[{"w", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", 
                  RowBox[{"y", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                RowBox[{"w", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"y", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
                RowBox[{"w", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                RowBox[{"w", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"y", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                RowBox[{"w", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"y", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
                RowBox[{"w", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "-", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "*", 
                RowBox[{"w", "[", 
                 RowBox[{"[", "2", "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "-", 
                  RowBox[{"y", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "*", 
                RowBox[{"w", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "-", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"y", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "-", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "*", 
                RowBox[{"w", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"d", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"y", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{"z", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"y", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "*", 
             RowBox[{"z", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{"y", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"z", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{"y", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "*", 
             RowBox[{"z", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "*", 
             RowBox[{"y", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "*", 
             RowBox[{"z", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"x", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "*", 
             RowBox[{"y", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "*", 
             RowBox[{"z", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"D", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{"s", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "*", 
               RowBox[{"s", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "-", 
              RowBox[{"0.5", "*", 
               RowBox[{"B", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "+", 
              RowBox[{"A", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "*", 
               RowBox[{"s", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{"s", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "-", 
              RowBox[{"0.5", "*", 
               RowBox[{"B", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "+", 
              RowBox[{"A", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{"s", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{"s", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", 
              RowBox[{"0.5", "*", 
               RowBox[{"B", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}], "+", 
              RowBox[{"A", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Dot", "[", 
                RowBox[{"A", ",", "s"}], "]"}]}], "+", 
              RowBox[{"0.5", "*", "d", "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "4", "]"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Dot", "[", 
                RowBox[{"B", ",", "s"}], "]"}]}], "+", "d"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Y", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"D", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"D", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "/", 
            RowBox[{"D", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}]}]}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "Y", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GASolver", "[", 
    RowBox[{"G_", ",", 
     RowBox[{"verbose_:", "False"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "d", ",", "x", ",", "y", ",", "z", ",", "r", ",", "s", ",", 
       "u", ",", "w", ",", "basis", ",", "A", ",", "B", ",", "C", ",", "D", 
       ",", "F", ",", "S", ",", "X", ",", "U"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"X", ",", "F"}], "}"}], "=", 
       RowBox[{"BuildUpInitX", "[", 
        RowBox[{"G", ",", "verbose"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"U", "=", 
       RowBox[{"Complement", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{"i", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", 
              RowBox[{"VertexList", "[", "G", "]"}], "]"}]}], "}"}]}], "]"}], 
         ",", "F"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"set", " ", "the", " ", "remaining", " ", "atoms"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "U", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"basis", "=", 
          RowBox[{"GANextBasis", "[", 
           RowBox[{"G", ",", "F", ",", "U", ",", "verbose"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "find", " ", "atoms", " ", "to", " ", "set", " ", "position"}], " ",
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{"S", "=", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"AdjacencyList", "[", 
             RowBox[{"G", ",", 
              RowBox[{"basis", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", "U"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"S", "=", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"AdjacencyList", "[", 
             RowBox[{"G", ",", 
              RowBox[{"basis", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ",", "S"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"S", "=", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"AdjacencyList", "[", 
             RowBox[{"G", ",", 
              RowBox[{"basis", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", "S"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"S", "=", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"AdjacencyList", "[", 
             RowBox[{"G", ",", 
              RowBox[{"basis", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "]"}], ",", "S"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{"verbose", ",", 
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<F=\>\"", ",", "F", ",", "\"\< U=\>\"", ",", "U", ",", 
             "\"\< basis=\>\"", ",", "basis", ",", "\"\< S=\>\"", ",", "S"}], 
            "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"[", "S", "]"}], "]"}], "=", 
          RowBox[{"GASetPosition", "[", 
           RowBox[{"G", ",", "X", ",", "S", ",", "basis"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"F", "=", 
          RowBox[{"Union", "[", 
           RowBox[{"F", ",", "S"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"U", "=", 
          RowBox[{"Complement", "[", 
           RowBox[{"U", ",", "S"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "X", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6811309036956406`*^9, 3.681130906662017*^9}, {
   3.6811326106758246`*^9, 3.6811326182755585`*^9}, {3.6811326608445787`*^9, 
   3.681132667494706*^9}, 3.681132790556154*^9, {3.6811348971520386`*^9, 
   3.681134933680307*^9}, {3.6811349842965508`*^9, 3.6811349927972374`*^9}, {
   3.6811350792596626`*^9, 3.681135102779213*^9}, {3.6811351811048417`*^9, 
   3.681135222058572*^9}, {3.6811352894743447`*^9, 3.6811355290295305`*^9}, {
   3.6811355649797287`*^9, 3.681135583486353*^9}, {3.6811356619102936`*^9, 
   3.681136061616135*^9}, 3.6811362440094643`*^9, {3.681136309122642*^9, 
   3.681136311545313*^9}, {3.681136354873017*^9, 3.6811363554166436`*^9}, {
   3.6811364078501635`*^9, 3.6811365254862614`*^9}, {3.6811365959324903`*^9, 
   3.681136696547014*^9}, {3.6811367378252068`*^9, 3.6811367419892883`*^9}, {
   3.6811377950084248`*^9, 3.681137990906658*^9}, {3.681138030736383*^9, 
   3.6811380979072227`*^9}, {3.6811381373662457`*^9, 3.68113831104065*^9}, 
   3.681138353756702*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["GASolver2 (Not working)", "Subsubsection",
 CellChangeTimes->{{3.681130854243985*^9, 3.681130870964182*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"GASolver2", "[", "G_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "j", ",", "d", ",", "x", ",", "y", ",", "z", ",", "s", ",", 
        "numberOfAtoms", ",", "A", ",", "C", ",", "B", ",", "D", ",", "Y", 
        ",", "M", ",", "X", ",", "S", ",", "U2", ",", "U3", ",", "U4", ",", 
        "V3", ",", "V4"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"numberOfAtoms", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"VertexList", "[", "G", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"X", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "set", " ", "the", " ", "position", " ", "of", " ", "the", " ", 
         "first", " ", "four", " ", "atoms"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"GetEdgeWeight", "[", 
         RowBox[{"G", ",", 
          RowBox[{"1", "\[Rule]", "2"}]}], "]"}]}], ";", 
       RowBox[{"U2", "=", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"GetEdgeWeight", "[", 
             RowBox[{"G", ",", 
              RowBox[{"3", "\[Rule]", "1"}]}], "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"GetEdgeWeight", "[", 
             RowBox[{"G", ",", 
              RowBox[{"3", "\[Rule]", "2"}]}], "]"}], "^", "2"}], "+", 
           RowBox[{"U2", "^", "2"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", "U2"}], ")"}]}]}], ";", 
       RowBox[{"U3", "=", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"GetEdgeWeight", "[", 
            RowBox[{"G", ",", 
             RowBox[{"3", "\[Rule]", "1"}]}], "]"}], "^", "2"}], "-", 
          RowBox[{"U3", "^", "2"}]}], "]"}]}], ";", 
       RowBox[{"V3", "=", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"GetEdgeWeight", "[", 
             RowBox[{"G", ",", 
              RowBox[{"4", "\[Rule]", "1"}]}], "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"GetEdgeWeight", "[", 
             RowBox[{"G", ",", 
              RowBox[{"4", "\[Rule]", "2"}]}], "]"}], "^", "2"}], "+", 
           RowBox[{"U2", "^", "2"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", "U2"}], ")"}]}]}], ";", 
       RowBox[{"U4", "=", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"GetEdgeWeight", "[", 
             RowBox[{"G", ",", 
              RowBox[{"4", "\[Rule]", "2"}]}], "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"GetEdgeWeight", "[", 
             RowBox[{"G", ",", 
              RowBox[{"4", "\[Rule]", "3"}]}], "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"U4", "-", "U2"}], ")"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"U4", "-", "U3"}], ")"}], "^", "2"}], "+", 
           RowBox[{"V3", "^", "2"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", "V3"}], ")"}]}]}], ";", 
       RowBox[{"V4", "=", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"GetEdgeWeight", "[", 
            RowBox[{"G", ",", 
             RowBox[{"4", "\[Rule]", "1"}]}], "]"}], "^", "2"}], "-", 
          RowBox[{"U4", "^", "2"}], "-", 
          RowBox[{"V4", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "the", " ", "remaining", " ", "atoms"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "5"}], ",", 
         RowBox[{"i", "\[LessEqual]", "numberOfAtoms"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"P", "=", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"AdjacencyList", "[", 
              RowBox[{"G", ",", "i"}], "]"}], ",", 
             RowBox[{
              RowBox[{"#", "<", "i"}], "&"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "P", "]"}], "<", "4"}], ",", 
            RowBox[{"Throw", "[", "\"\<NotEnoughAdjacentNodes\>\"", "]"}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Y", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"[", 
               RowBox[{"P", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"S", "=", 
           RowBox[{"Y", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"squared", " ", "distances"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"z", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{"Y", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], "^", "2"}], "-", 
              RowBox[{
               RowBox[{"GetEdgeWeight", "[", 
                RowBox[{"G", ",", 
                 RowBox[{"i", "\[Rule]", 
                  RowBox[{"P", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], "^", "2"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"M", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cross", "[", 
               RowBox[{
                RowBox[{"Y", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"Y", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"Cross", "[", 
               RowBox[{
                RowBox[{"Y", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", 
                RowBox[{"Y", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"Cross", "[", 
               RowBox[{
                RowBox[{"Y", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"Y", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"A", "=", 
           RowBox[{"0.5", "*", 
            RowBox[{"(", 
             RowBox[{"M", ".", 
              RowBox[{"z", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"B", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"M", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "j"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "3"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"C", "=", 
           RowBox[{"0.5", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "-", 
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", 
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "]"}], ".", 
              RowBox[{"z", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"d", " ", "=", 
           RowBox[{"Det", "[", 
            RowBox[{"Y", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "3"}], "]"}], "]"}], "]"}]}], ";", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Det(A)=\>\"", ",", "d"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"D", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{"S", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "*", 
               RowBox[{"S", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"B", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "/", "2"}]}], "+", 
              RowBox[{"A", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "*", 
               RowBox[{"S", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{"S", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"B", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "/", "2"}]}], "+", 
              RowBox[{"A", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{"S", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{"S", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"B", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "*", 
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "/", "2"}]}], "+", 
              RowBox[{"A", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Dot", "[", 
                RowBox[{"A", ",", "S"}], "]"}]}], "+", 
              RowBox[{"d", "*", 
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "/", "2"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Dot", "[", 
                RowBox[{"B", ",", "S"}], "]"}]}], "+", "d"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"D", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"D", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "/", 
            RowBox[{"D", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "X", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.681130775574441*^9, 3.681130780520343*^9}}]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example", "Subsection",
 CellChangeTimes->{{3.6811325368290606`*^9, 3.6811325496242456`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"GenerateRandomMDGP", "[", 
    RowBox[{"150", ",", "5", ",", "\"\<DistanceMatrix\>\"", ",", "0"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"M", "[", "\"\<X\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"M", "[", "\"\<G\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{"GASolver", "[", 
    RowBox[{"G", ",", "False"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<LDME=\>\"", ",", 
   RowBox[{"LDME", "[", 
    RowBox[{"G", ",", "S"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.681132585671668*^9, 3.6811326017862873`*^9}, {
   3.681132697205409*^9, 3.6811327714843345`*^9}, {3.681134728514855*^9, 
   3.6811347327051363`*^9}, {3.6811348419605255`*^9, 3.681134870132739*^9}, {
   3.681134938427829*^9, 3.681134938496883*^9}, {3.6811368475243416`*^9, 
   3.68113689600677*^9}, {3.6815665994763823`*^9, 3.6815666147680187`*^9}, {
   3.681567257619912*^9, 3.681567271946435*^9}, {3.6815681038222165`*^9, 
   3.6815681053415165`*^9}, {3.6815696913741565`*^9, 3.6815697265790234`*^9}, 
   3.682752354771577*^9, 3.68275737795257*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Comparisons", "Section",
 CellChangeTimes->{{3.681569813484808*^9, 3.681569816344872*^9}}],

Cell[CellGroupData[{

Cell["Speed", "Subsection",
 CellChangeTimes->{{3.6815698264989896`*^9, 3.68156984638715*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"GenerateRandomMDGP", "[", 
    RowBox[{"350", ",", "5", ",", "\"\<DistanceMatrix\>\"", ",", "0"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"M", "[", "\"\<G\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<GA      = \>\"", ",", 
   RowBox[{"Timing", "[", 
    RowBox[{
     RowBox[{"S", "=", 
      RowBox[{"GASolver", "[", 
       RowBox[{"G", ",", "False"}], "]"}]}], ";"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<BuildUp = \>\"", ",", 
   RowBox[{"Timing", "[", 
    RowBox[{
     RowBox[{"Y", "=", 
      RowBox[{"BuildUpSolver", "[", 
       RowBox[{"G", ",", "False"}], "]"}]}], ";"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<LDME(GA)      = \>\"", ",", 
   RowBox[{"LDME", "[", 
    RowBox[{"G", ",", "S"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<LDME(BuildUp) = \>\"", ",", 
   RowBox[{"LDME", "[", 
    RowBox[{"G", ",", "Y"}], "]"}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6815698480721264`*^9, 3.6815700048257246`*^9}, {
   3.6815700435273275`*^9, 3.681570079052247*^9}, {3.681570156011415*^9, 
   3.681570156787325*^9}, {3.681570210274677*^9, 3.681570210412711*^9}, {
   3.6815702446462665`*^9, 3.6815702520650797`*^9}, {3.681570284928616*^9, 
   3.681570304578995*^9}, 3.6827523547930994`*^9, 3.68275737795257*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Robustness", "Subsection",
 CellChangeTimes->{{3.6811369593317337`*^9, 3.681136962953414*^9}, 
   3.6815697884056425`*^9, 3.6815698199673333`*^9}],

Cell[CellGroupData[{

Cell["Example: Colinear Points", "Subsubsection",
 CellChangeTimes->{{3.681575755660693*^9, 3.681575771130968*^9}, {
  3.6815759375107937`*^9, 3.6815759504074736`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"z", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"10", "^", 
       RowBox[{"(", "i", ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "16"}], "}"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"a", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "z", "]"}]}], "}"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"b", "=", 
    RowBox[{"Table", "[", 
     RowBox[{"0", ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"Length", "[", "z", "]"}]}], "}"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"k", "=", "1"}], ",", 
     RowBox[{"k", "\[LessEqual]", 
      RowBox[{"Length", "[", "z", "]"}]}], ",", 
     RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"X", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.5", ",", 
           RowBox[{"1", "/", 
            RowBox[{"z", "[", 
             RowBox[{"[", "k", "]"}], "]"}]}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"build", " ", "graph"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"edges", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"weights", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", "4"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"j", "=", 
            RowBox[{"i", "+", "1"}]}], ",", 
           RowBox[{"j", "\[LessEqual]", "4"}], ",", 
           RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"AppendTo", "[", 
             RowBox[{"edges", ",", 
              RowBox[{"i", "\[UndirectedEdge]", "j"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"weights", ",", 
              RowBox[{"Norm", "[", 
               RowBox[{
                RowBox[{"X", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "-", 
                RowBox[{"X", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"G", "=", 
       RowBox[{"Graph", "[", 
        RowBox[{"edges", ",", 
         RowBox[{"EdgeWeight", "\[Rule]", "weights"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Z", "=", 
       RowBox[{"BPGetNodePosition", "[", 
        RowBox[{"G", ",", "X", ",", "4", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<k= \>\"", ",", "k", ",", "\"\<  Log10[E]= \>\"", ",", " ", 
        RowBox[{"Log10", "[", 
         RowBox[{"Norm", "[", 
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "-", "Z"}], "]"}], "]"}]}], " ", 
       "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQ7SfbqmOW+9qx6ckcExDdPWerD4iOLm3xA9Fefcei
QTRLmFIMiGZTtE0E0frR01pB9KriuZ0g+kCJfzeIVudQ5TIH0skhYWog+txT
XiMQzdop7QWi7xrtDADRZmZ/wkE0k0R0A4je87QJTF+aJNwKopM+SIHpGP99
PSC6XCawF0TvM+5PsATSj27KpIDoVQfEMkH0le6abBB9ky+qhSfvteN0Z6Ep
IHq1RudsEL3r8vdVIFpg47V1ILpH8AuYPnT7ZJ4OkN6j/KcYRJ/q8KgG0R0b
NOtA9ItO4WkgWlHbcjqInuGzfQuIdtl7fDeIPj7zcKUxkM6IVKwB0R2R8w6Y
AekqprTDINpXu/MEiN7U1gumS36kl/kUvHYUsWAoB9EAGS2xGA==
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example B", "Subsubsection",
 CellChangeTimes->{{3.6815757784336452`*^9, 3.6815757805693655`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"z", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", "i"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", "12"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "z", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "z", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"k", "=", "1"}], ",", 
    RowBox[{"k", "\[LessEqual]", 
     RowBox[{"Length", "[", "z", "]"}]}], ",", 
    RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"X", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", 
          RowBox[{"z", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{".5", ",", ".5", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"build", " ", "graph"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"edges", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"weights", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "5"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"i", "+", "1"}]}], ",", 
          RowBox[{"j", "\[LessEqual]", "5"}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"edges", ",", 
             RowBox[{"i", "\[UndirectedEdge]", "j"}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"weights", ",", 
             RowBox[{"Norm", "[", 
              RowBox[{
               RowBox[{"X", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "-", 
               RowBox[{"X", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"G", "=", 
      RowBox[{"Graph", "[", 
       RowBox[{"edges", ",", 
        RowBox[{"EdgeWeight", "\[Rule]", "weights"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"S", "=", 
      RowBox[{"{", "5", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"basis", "=", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"a", "[", 
       RowBox[{"[", "k", "]"}], "]"}], "=", 
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", "S", "]"}], "]"}], "-", 
        RowBox[{"BuildUpSetPosition", "[", 
         RowBox[{"G", ",", "X", ",", "S", ",", "basis"}], "]"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"b", "[", 
       RowBox[{"[", "k", "]"}], "]"}], "=", 
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", "S", "]"}], "]"}], "-", 
        RowBox[{"GASetPosition", "[", 
         RowBox[{"G", ",", "X", ",", "S", ",", "basis"}], "]"}]}], 
       "]"}]}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6815757863621497`*^9, 3.6815759019046144`*^9}, 
   3.681575932212285*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Articles: ", "Section",
 CellChangeTimes->{{3.681569813484808*^9, 3.681569816344872*^9}, {
   3.6830321679776583`*^9, 3.6830321725073566`*^9}, {3.6950518168642263`*^9, 
   3.6950518230488887`*^9}, {3.695718544230457*^9, 3.6957185487638164`*^9}, 
   3.6957185793601875`*^9}],

Cell[CellGroupData[{

Cell["MMAS' 17", "Subsection",
 CellChangeTimes->{{3.695718588561105*^9, 3.6957185934945707`*^9}}],

Cell[CellGroupData[{

Cell["Problem", "Subsubsection",
 CellChangeTimes->{{3.683032240630539*^9, 3.683032245583842*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"vertices", "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], "}"}]}],
    ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"create", " ", "edges"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"edges", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", "3"}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"k", "=", "1"}], ",", 
       RowBox[{"k", "\[LessEqual]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "vertices", "]"}], "-", "j"}], ")"}]}], ",", 
       RowBox[{"k", "++"}], ",", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"edges", ",", 
         RowBox[{"k", "\[UndirectedEdge]", 
          RowBox[{"(", 
           RowBox[{"k", "+", "j"}], ")"}]}]}], "]"}]}], "]"}]}], 
    "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"extra", " ", "distances"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AppendTo", "[", 
    RowBox[{"edges", ",", 
     RowBox[{"1", "\[UndirectedEdge]", "5"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"create", " ", "graph"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"G", "=", 
    RowBox[{"Graph", "[", 
     RowBox[{"vertices", ",", "edges"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"set", " ", "edges", " ", "values"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"k", "=", "1"}], ",", 
   RowBox[{"k", "\[LessEqual]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Length", "[", "vertices", "]"}], "-", "1"}], ")"}]}], ",", 
   RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PropertyValue", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"G", ",", 
         RowBox[{"k", "\[UndirectedEdge]", 
          RowBox[{"(", 
           RowBox[{"k", "+", "1"}], ")"}]}]}], "}"}], ",", "EdgeWeight"}], 
      "]"}], "=", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PropertyValue", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"G", ",", 
         RowBox[{"k", "\[UndirectedEdge]", 
          RowBox[{"(", 
           RowBox[{"k", "+", "1"}], ")"}]}]}], "}"}], ",", 
       "\"\<DistanceBounds\>\""}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}]}]}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"k", "=", "1"}], ",", 
   RowBox[{"k", "\[LessEqual]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Length", "[", "vertices", "]"}], "-", "2"}], ")"}]}], ",", 
   RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PropertyValue", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"G", ",", 
         RowBox[{"k", "\[UndirectedEdge]", 
          RowBox[{"(", 
           RowBox[{"k", "+", "2"}], ")"}]}]}], "}"}], ",", "EdgeWeight"}], 
      "]"}], "=", 
     RowBox[{"Sqrt", "[", "3", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"PropertyValue", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"G", ",", 
         RowBox[{"k", "\[UndirectedEdge]", 
          RowBox[{"(", 
           RowBox[{"k", "+", "2"}], ")"}]}]}], "}"}], ",", 
       "\"\<DistanceBounds\>\""}], "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Sqrt", "[", "3", "]"}], ",", 
       RowBox[{"Sqrt", "[", "3", "]"}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PropertyValue", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"G", ",", 
       RowBox[{"1", "\[UndirectedEdge]", "4"}]}], "}"}], ",", "EdgeWeight"}], 
    "]"}], "=", "2.15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PropertyValue", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"G", ",", 
       RowBox[{"1", "\[UndirectedEdge]", "4"}]}], "}"}], ",", 
     "\"\<DistanceBounds\>\""}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"2.15", ",", "2.15"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PropertyValue", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"G", ",", 
       RowBox[{"1", "\[UndirectedEdge]", "5"}]}], "}"}], ",", "EdgeWeight"}], 
    "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PropertyValue", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"G", ",", 
       RowBox[{"1", "\[UndirectedEdge]", "5"}]}], "}"}], ",", 
     "\"\<DistanceBounds\>\""}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"2.45", ",", "2.55"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PropertyValue", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"G", ",", 
       RowBox[{"2", "\[UndirectedEdge]", "5"}]}], "}"}], ",", "EdgeWeight"}], 
    "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PropertyValue", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"G", ",", 
       RowBox[{"2", "\[UndirectedEdge]", "5"}]}], "}"}], ",", 
     "\"\<DistanceBounds\>\""}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"2.2", ",", "2.6"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PropertyValue", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"G", ",", 
       RowBox[{"3", "\[UndirectedEdge]", "6"}]}], "}"}], ",", "EdgeWeight"}], 
    "]"}], "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PropertyValue", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"G", ",", 
       RowBox[{"3", "\[UndirectedEdge]", "6"}]}], "}"}], ",", 
     "\"\<DistanceBounds\>\""}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{"2.4", ",", "2.6"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<G=\>\"", ",", "G"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<EdgesList[G]=\>\"", ",", 
   RowBox[{"EdgeList", "[", "G", "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.6830327705159297`*^9, {3.683032825412712*^9, 3.683032825841506*^9}, {
   3.6833897373710327`*^9, 3.6833897383116617`*^9}, 3.6833898066456614`*^9, {
   3.6950519461372876`*^9, 3.695051971253236*^9}, {3.695054339359205*^9, 
   3.695054374964918*^9}, {3.6950544382550755`*^9, 3.695054471742462*^9}, {
   3.695054520813548*^9, 3.695054543675331*^9}, {3.6950545886517105`*^9, 
   3.6950545996175528`*^9}, {3.6950546478888445`*^9, 3.695054668863003*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Getting Reference Solution", "Subsubsection",
 CellChangeTimes->{{3.683032240630539*^9, 3.683032268346609*^9}, {
  3.6950524843359594`*^9, 3.695052487617569*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Create", " ", "BP", " ", "instance", " ", "by", " ", "removing", " ", 
     "the", " ", "edge", " ", "1"}], "\[UndirectedEdge]", 
    RowBox[{
    "5", " ", "and", " ", "choosing", " ", "the", " ", "lower", " ", 
     "bounds"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"H", "=", 
     RowBox[{"EdgeDelete", "[", 
      RowBox[{"G", ",", 
       RowBox[{"1", "\[UndirectedEdge]", "5"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PropertyValue", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"H", ",", 
         RowBox[{"2", "\[UndirectedEdge]", "5"}]}], "}"}], ",", 
       "EdgeWeight"}], "]"}], "=", 
     RowBox[{
      RowBox[{"PropertyValue", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"H", ",", 
          RowBox[{"2", "\[UndirectedEdge]", "5"}]}], "}"}], ",", 
        "\"\<DistanceBounds\>\""}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PropertyValue", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"H", ",", 
         RowBox[{"3", "\[UndirectedEdge]", "6"}]}], "}"}], ",", 
       "EdgeWeight"}], "]"}], "=", 
     RowBox[{
      RowBox[{"PropertyValue", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"H", ",", 
          RowBox[{"3", "\[UndirectedEdge]", "6"}]}], "}"}], ",", 
        "\"\<DistanceBounds\>\""}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<H=\>\"", ",", "H"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"\"\<EdgesList[H]=\>\"", ",", 
     RowBox[{"EdgeList", "[", "H", "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "solving", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"S", ",", "work"}], "}"}], "=", 
     RowBox[{"BPSolver", "[", "H", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XL", "=", 
     RowBox[{"S", "[", "\"\<Points\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BL", "=", 
     RowBox[{"S", "[", "\"\<Branches\>\"", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6830323369314127`*^9, 3.6830323752327642`*^9}, {
   3.6830324064069014`*^9, 3.683032518447234*^9}, {3.6830330028395824`*^9, 
   3.683033003422675*^9}, {3.6830337363905363`*^9, 3.6830337369824314`*^9}, {
   3.695052527876314*^9, 3.695052657252447*^9}, {3.695052770792269*^9, 
   3.6950527768632755`*^9}, {3.695053260248283*^9, 3.6950532803955593`*^9}, {
   3.6950551430748186`*^9, 3.6950552071468477`*^9}, 3.695055263405859*^9, {
   3.6950555806726036`*^9, 3.69505568640932*^9}, {3.69505743477678*^9, 
   3.695057479245922*^9}, {3.6950575813323817`*^9, 3.695057623299964*^9}, {
   3.6950576823027267`*^9, 3.6950577531837635`*^9}, {3.695057799076247*^9, 
   3.695057807915103*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Create", " ", "BP", " ", "instance", " ", "from", " ", "H", " ", "and", 
    " ", "choosing", " ", "the", " ", "upper", " ", "bounds"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PropertyValue", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"H", ",", 
         RowBox[{"2", "\[UndirectedEdge]", "5"}]}], "}"}], ",", 
       "EdgeWeight"}], "]"}], "=", 
     RowBox[{
      RowBox[{"PropertyValue", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"H", ",", 
          RowBox[{"2", "\[UndirectedEdge]", "5"}]}], "}"}], ",", 
        "\"\<DistanceBounds\>\""}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PropertyValue", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"H", ",", 
         RowBox[{"3", "\[UndirectedEdge]", "6"}]}], "}"}], ",", 
       "EdgeWeight"}], "]"}], "=", 
     RowBox[{
      RowBox[{"PropertyValue", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"H", ",", 
          RowBox[{"3", "\[UndirectedEdge]", "6"}]}], "}"}], ",", 
        "\"\<DistanceBounds\>\""}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "solving", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"S", ",", "work"}], "}"}], "=", 
     RowBox[{"BPSolver", "[", "H", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XU", "=", 
     RowBox[{"S", "[", "\"\<Points\>\"", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BU", "=", 
     RowBox[{"S", "[", "\"\<Branches\>\"", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.695057056090493*^9, 3.69505705754543*^9}, {
  3.6950571272277336`*^9, 3.695057219509966*^9}, {3.6950574882308807`*^9, 
  3.6950574997439814`*^9}, {3.6950576362600946`*^9, 3.6950576415895653`*^9}, {
  3.695057787475413*^9, 3.695057850965598*^9}}],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"Length", "[", "XL", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{
       RowBox[{"XL", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "5", "]"}], "]"}], ",", 
      RowBox[{"BL", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6950579175660443`*^9, 3.6950579558232527`*^9}}],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"Length", "[", "XU", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"Print", "[", 
    RowBox[{"{", 
     RowBox[{"i", ",", 
      RowBox[{
       RowBox[{"XU", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "[", 
       RowBox[{"[", "5", "]"}], "]"}], ",", 
      RowBox[{"BU", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "}"}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{
  3.695058027324939*^9, {3.6950581001956034`*^9, 3.6950581040611625`*^9}}],

Cell[BoxData[
 RowBox[{"\[Omega]0", "=", 
  RowBox[{"CalculateTorsionAngles", "[", 
   RowBox[{"XL", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6950541262807856`*^9, 3.695054186192066*^9}, {
   3.6950559450171585`*^9, 3.6950559471075864`*^9}, {3.6950559775138326`*^9, 
   3.6950559821965356`*^9}, 3.6950576634842234`*^9, {3.695057872082612*^9, 
   3.6950578791489077`*^9}, 3.695058330038464*^9, {3.695058909831279*^9, 
   3.6950589178761344`*^9}}],

Cell[BoxData[
 RowBox[{"\[Omega]1", "=", 
  RowBox[{"CalculateTorsionAngles", "[", 
   RowBox[{"XU", "[", 
    RowBox[{"[", "3", "]"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.6950583416494923`*^9, {3.6950589254273415`*^9, 3.695058930410454*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6950589530100813`*^9, 3.6950590657287765`*^9}, {
   3.6950592779488635`*^9, 3.6950592784443636`*^9}, {3.695059459889648*^9, 
   3.695059460153572*^9}, 3.695061808122598*^9, 3.6950619070409408`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"XL", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Y", "=", 
  RowBox[{"ApplyRotors", "[", 
   RowBox[{"X", ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0.56", ",", "0"}], 
     "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"DistanceMatrix", "[", "X", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"DistanceMatrix", "[", "Y", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Omega]5", "=", 
   RowBox[{"{", 
    RowBox[{"0.56", ",", "0.62", ",", "0.733"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ApplyRotors", "[", 
      RowBox[{"X", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
         RowBox[{"\[Omega]5", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "0"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "\[Omega]5", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"ApplyRotors", "[", 
    RowBox[{"X", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0.68", ",", "0"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"figs", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"Y", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PointSize", "[", ".025", "]"}], ",", "LightGray", ",", 
         RowBox[{"Point", "[", 
          RowBox[{"Y", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "Y", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"figs", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{"figs", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Line", "[", "Z", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PointSize", "[", ".025", "]"}], ",", "Black", ",", 
         RowBox[{"Point", "[", "Z", "]"}]}], "}"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{"figs", ",", " ", 
   RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.695059069380664*^9, 3.695059079218292*^9}, {
   3.695059165067521*^9, 3.6950591683089304`*^9}, {3.6950594704683523`*^9, 
   3.695059490913286*^9}, {3.6950595327211742`*^9, 3.695059557567137*^9}, {
   3.6950595935692854`*^9, 3.695059596442844*^9}, {3.695059903701016*^9, 
   3.695059910940896*^9}, {3.695059964986123*^9, 3.695059966233364*^9}, {
   3.69506056720686*^9, 3.6950606298272543`*^9}, 3.6950608355869904`*^9, {
   3.6950614559913406`*^9, 3.695061460562259*^9}, {3.695061910985814*^9, 
   3.69506193350578*^9}, {3.6950620351205225`*^9, 3.6950620425233655`*^9}, {
   3.695062075629792*^9, 3.6950620811496515`*^9}, {3.695062126537776*^9, 
   3.695062146555786*^9}, {3.6950623484888964`*^9, 3.695062356687842*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6950599702795286`*^9, 3.6950599865026665`*^9}, {
   3.695060028731949*^9, 3.695060031712731*^9}, {3.695060890252981*^9, 
   3.6950608964950476`*^9}, {3.6950610532620497`*^9, 3.695061053338114*^9}, {
   3.6950611685828285`*^9, 3.695061170026735*^9}, 3.6950619146793003`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Omega]6", "=", 
   RowBox[{"{", 
    RowBox[{"0.56", ",", "0.62", ",", "0.68", ",", "0.733"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"ApplyRotors", "[", 
      RowBox[{"X", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0.68", ",", 
         RowBox[{"\[Omega]6", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "\[Omega]6", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"figs", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{"figs", ",", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Line", "[", 
          RowBox[{"Y", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PointSize", "[", ".025", "]"}], ",", "LightGray", ",", 
           RowBox[{"Point", "[", 
            RowBox[{"Y", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"Length", "[", "Y", "]"}]}], "}"}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Graphics3D", "[", 
  RowBox[{"figs", ",", " ", 
   RowBox[{"Axes", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.695061500319137*^9, 3.6950615551899457`*^9}, {
   3.6950616344677877`*^9, 3.695061662826518*^9}, {3.695061824960895*^9, 
   3.6950618250694942`*^9}, 3.695061897375805*^9, 3.69506196754156*^9, {
   3.6950620167280955`*^9, 3.6950620295541925`*^9}, {3.69506215795319*^9, 
   3.695062162916585*^9}, {3.6950625666231346`*^9, 3.6950626238052263`*^9}, {
   3.6950628167809553`*^9, 3.6950628180579033`*^9}}],

Cell[BoxData[
 Graphics3DBox[{{{
     Line3DBox[
      NCache[{{0, 0, 0}, {-1, 0, 0}, {
        Rational[-3, 2], Rational[1, 2] 3^Rational[1, 2], 
         0}, {-1.3112499999999996`, 1.5523505362836068`, 
        0.7023754337959144}, {-1.5015795671235659`, 1.3500876663997305`, 
        1.663033743157206}, {-0.8116033137690675, 1.5427066755333547`, 
        2.360766275813594}}, {{0, 0, 0}, {-1, 0, 
        0}, {-1.5, 0.8660254037844386, 0}, {-1.3112499999999996`, 
        1.5523505362836068`, 0.7023754337959144}, {-1.5015795671235659`, 
        1.3500876663997305`, 1.663033743157206}, {-0.8116033137690675, 
        1.5427066755333547`, 2.360766275813594}}]], 
     {GrayLevel[0.85], PointSize[0.025], 
      Point3DBox[
       NCache[{{0, 0, 0}, {-1, 0, 0}, {
         Rational[-3, 2], Rational[1, 2] 3^Rational[1, 2], 
          0}, {-1.3112499999999996`, 1.5523505362836068`, 
         0.7023754337959144}, {-1.5015795671235659`, 1.3500876663997305`, 
         1.663033743157206}, {-0.8116033137690675, 1.5427066755333547`, 
         2.360766275813594}}, {{0, 0, 0}, {-1, 0, 
         0}, {-1.5, 0.8660254037844386, 0}, {-1.3112499999999996`, 
         1.5523505362836068`, 0.7023754337959144}, {-1.5015795671235659`, 
         1.3500876663997305`, 1.663033743157206}, {-0.8116033137690675, 
         1.5427066755333547`, 2.360766275813594}}]]}}, {
     Line3DBox[
      NCache[{{0, 0, 0}, {-1, 0, 0}, {
        Rational[-3, 2], Rational[1, 2] 3^Rational[1, 2], 
         0}, {-1.3112499999999996`, 1.5523505362836068`, 
        0.7023754337959144}, {-1.5015795671235659`, 1.3500876663997305`, 
        1.663033743157206}, {-0.8325743899998022, 1.5898872789129277`, 
        2.3665450926178595`}}, {{0, 0, 0}, {-1, 0, 
        0}, {-1.5, 0.8660254037844386, 0}, {-1.3112499999999996`, 
        1.5523505362836068`, 0.7023754337959144}, {-1.5015795671235659`, 
        1.3500876663997305`, 1.663033743157206}, {-0.8325743899998022, 
        1.5898872789129277`, 2.3665450926178595`}}]], 
     {GrayLevel[0.85], PointSize[0.025], 
      Point3DBox[
       NCache[{{0, 0, 0}, {-1, 0, 0}, {
         Rational[-3, 2], Rational[1, 2] 3^Rational[1, 2], 
          0}, {-1.3112499999999996`, 1.5523505362836068`, 
         0.7023754337959144}, {-1.5015795671235659`, 1.3500876663997305`, 
         1.663033743157206}, {-0.8325743899998022, 1.5898872789129277`, 
         2.3665450926178595`}}, {{0, 0, 0}, {-1, 0, 
         0}, {-1.5, 0.8660254037844386, 0}, {-1.3112499999999996`, 
         1.5523505362836068`, 0.7023754337959144}, {-1.5015795671235659`, 
         1.3500876663997305`, 1.663033743157206}, {-0.8325743899998022, 
         1.5898872789129277`, 2.3665450926178595`}}]]}}, {
     Line3DBox[
      NCache[{{0, 0, 0}, {-1, 0, 0}, {
        Rational[-3, 2], Rational[1, 2] 3^Rational[1, 2], 
         0}, {-1.3112499999999996`, 1.5523505362836068`, 
        0.7023754337959144}, {-1.5015795671235659`, 1.3500876663997305`, 
        1.663033743157206}, {-0.8562956528844772, 1.635840898683012, 
        2.3715206945287646`}}, {{0, 0, 0}, {-1, 0, 
        0}, {-1.5, 0.8660254037844386, 0}, {-1.3112499999999996`, 
        1.5523505362836068`, 0.7023754337959144}, {-1.5015795671235659`, 
        1.3500876663997305`, 1.663033743157206}, {-0.8562956528844772, 
        1.635840898683012, 2.3715206945287646`}}]], 
     {GrayLevel[0.85], PointSize[0.025], 
      Point3DBox[
       NCache[{{0, 0, 0}, {-1, 0, 0}, {
         Rational[-3, 2], Rational[1, 2] 3^Rational[1, 2], 
          0}, {-1.3112499999999996`, 1.5523505362836068`, 
         0.7023754337959144}, {-1.5015795671235659`, 1.3500876663997305`, 
         1.663033743157206}, {-0.8562956528844772, 1.635840898683012, 
         2.3715206945287646`}}, {{0, 0, 0}, {-1, 0, 
         0}, {-1.5, 0.8660254037844386, 0}, {-1.3112499999999996`, 
         1.5523505362836068`, 0.7023754337959144}, {-1.5015795671235659`, 
         1.3500876663997305`, 1.663033743157206}, {-0.8562956528844772, 
         1.635840898683012, 2.3715206945287646`}}]]}}, {
     Line3DBox[
      NCache[{{0, 0, 0}, {-1, 0, 0}, {
        Rational[-3, 2], Rational[1, 2] 3^Rational[1, 2], 
         0}, {-1.3112499999999996`, 1.5523505362836068`, 
        0.7023754337959144}, {-1.5015795671235659`, 1.3500876663997305`, 
        1.663033743157206}, {-0.8794690305440742, 1.6752803202112725`, 
        2.375233306610885}}, {{0, 0, 0}, {-1, 0, 
        0}, {-1.5, 0.8660254037844386, 0}, {-1.3112499999999996`, 
        1.5523505362836068`, 0.7023754337959144}, {-1.5015795671235659`, 
        1.3500876663997305`, 1.663033743157206}, {-0.8794690305440742, 
        1.6752803202112725`, 2.375233306610885}}]], 
     {GrayLevel[0.85], PointSize[0.025], 
      Point3DBox[
       NCache[{{0, 0, 0}, {-1, 0, 0}, {
         Rational[-3, 2], Rational[1, 2] 3^Rational[1, 2], 
          0}, {-1.3112499999999996`, 1.5523505362836068`, 
         0.7023754337959144}, {-1.5015795671235659`, 1.3500876663997305`, 
         1.663033743157206}, {-0.8794690305440742, 1.6752803202112725`, 
         2.375233306610885}}, {{0, 0, 0}, {-1, 0, 
         0}, {-1.5, 0.8660254037844386, 0}, {-1.3112499999999996`, 
         1.5523505362836068`, 0.7023754337959144}, {-1.5015795671235659`, 
         1.3500876663997305`, 1.663033743157206}, {-0.8794690305440742, 
         1.6752803202112725`, 2.375233306610885}}]]}}}, {
    Line3DBox[
     NCache[{{0, 0, 0}, {-1, 0, 0}, {
       Rational[-3, 2], Rational[1, 2] 3^Rational[1, 2], 
        0}, {-1.3112499999999996`, 1.5523505362836068`, 
       0.7023754337959144}, {-0.9343460610311477, 1.273330916304608, 
       1.5856033049914173`}, {0.044173487394552506`, 1.373500947181597, 
       1.765785041753762}}, {{0, 0, 0}, {-1, 0, 
       0}, {-1.5, 0.8660254037844386, 0}, {-1.3112499999999996`, 
       1.5523505362836068`, 0.7023754337959144}, {-0.9343460610311477, 
       1.273330916304608, 1.5856033049914173`}, {0.044173487394552506`, 
       1.373500947181597, 1.765785041753762}}]], 
    {GrayLevel[0], PointSize[0.025], 
     Point3DBox[
      NCache[{{0, 0, 0}, {-1, 0, 0}, {
        Rational[-3, 2], Rational[1, 2] 3^Rational[1, 2], 
         0}, {-1.3112499999999996`, 1.5523505362836068`, 
        0.7023754337959144}, {-0.9343460610311477, 1.273330916304608, 
        1.5856033049914173`}, {0.044173487394552506`, 1.373500947181597, 
        1.765785041753762}}, {{0, 0, 0}, {-1, 0, 
        0}, {-1.5, 0.8660254037844386, 0}, {-1.3112499999999996`, 
        1.5523505362836068`, 0.7023754337959144}, {-0.9343460610311477, 
        1.273330916304608, 1.5856033049914173`}, {0.044173487394552506`, 
        1.373500947181597, 1.765785041753762}}]]}}, {
    Line3DBox[
     NCache[{{0, 0, 0}, {-1, 0, 0}, {
       Rational[-3, 2], Rational[1, 2] 3^Rational[1, 2], 
        0}, {-1.3112499999999996`, 1.5523505362836068`, 
       0.7023754337959144}, {-1.0324059357654696`, 1.2660712072358646`, 
       1.619048839977824}, {-0.06678889023882852, 1.2891909663806485`, 
       1.877987439119232}}, {{0, 0, 0}, {-1, 0, 
       0}, {-1.5, 0.8660254037844386, 0}, {-1.3112499999999996`, 
       1.5523505362836068`, 0.7023754337959144}, {-1.0324059357654696`, 
       1.2660712072358646`, 1.619048839977824}, {-0.06678889023882852, 
       1.2891909663806485`, 1.877987439119232}}]], 
    {GrayLevel[0.85], PointSize[0.025], 
     Point3DBox[
      NCache[{{0, 0, 0}, {-1, 0, 0}, {
        Rational[-3, 2], Rational[1, 2] 3^Rational[1, 2], 
         0}, {-1.3112499999999996`, 1.5523505362836068`, 
        0.7023754337959144}, {-1.0324059357654696`, 1.2660712072358646`, 
        1.619048839977824}, {-0.06678889023882852, 1.2891909663806485`, 
        1.877987439119232}}, {{0, 0, 0}, {-1, 0, 
        0}, {-1.5, 0.8660254037844386, 0}, {-1.3112499999999996`, 
        1.5523505362836068`, 0.7023754337959144}, {-1.0324059357654696`, 
        1.2660712072358646`, 1.619048839977824}, {-0.06678889023882852, 
        1.2891909663806485`, 1.877987439119232}}]]}}, {
    Line3DBox[
     NCache[{{0, 0, 0}, {-1, 0, 0}, {
       Rational[-3, 2], Rational[1, 2] 3^Rational[1, 2], 
        0}, {-1.3112499999999996`, 1.5523505362836068`, 
       0.7023754337959144}, {-0.9829550688237976, 1.2685729079270271`, 
       1.6033153295760538`}, {-0.009263719422088758, 1.3298587788415488`, 
       1.8227901530213768`}}, {{0, 0, 0}, {-1, 0, 
       0}, {-1.5, 0.8660254037844386, 0}, {-1.3112499999999996`, 
       1.5523505362836068`, 0.7023754337959144}, {-0.9829550688237976, 
       1.2685729079270271`, 1.6033153295760538`}, {-0.009263719422088758, 
       1.3298587788415488`, 1.8227901530213768`}}]], 
    {GrayLevel[0.85], PointSize[0.025], 
     Point3DBox[
      NCache[{{0, 0, 0}, {-1, 0, 0}, {
        Rational[-3, 2], Rational[1, 2] 3^Rational[1, 2], 
         0}, {-1.3112499999999996`, 1.5523505362836068`, 
        0.7023754337959144}, {-0.9829550688237976, 1.2685729079270271`, 
        1.6033153295760538`}, {-0.009263719422088758, 1.3298587788415488`, 
        1.8227901530213768`}}, {{0, 0, 0}, {-1, 0, 
        0}, {-1.5, 0.8660254037844386, 0}, {-1.3112499999999996`, 
        1.5523505362836068`, 0.7023754337959144}, {-0.9829550688237976, 
        1.2685729079270271`, 1.6033153295760538`}, {-0.009263719422088758, 
        1.3298587788415488`, 1.8227901530213768`}}]]}}, {
    Line3DBox[
     NCache[{{0, 0, 0}, {-1, 0, 0}, {
       Rational[-3, 2], Rational[1, 2] 3^Rational[1, 2], 
        0}, {-1.3112499999999996`, 1.5523505362836068`, 
       0.7023754337959144}, {-0.892248306411026, 1.2793971316347617`, 
       1.5683627429755442`}, {0.0878218578058983, 1.4144002879050193`, 
       1.7140906435598429`}}, {{0, 0, 0}, {-1, 0, 
       0}, {-1.5, 0.8660254037844386, 0}, {-1.3112499999999996`, 
       1.5523505362836068`, 0.7023754337959144}, {-0.892248306411026, 
       1.2793971316347617`, 1.5683627429755442`}, {0.0878218578058983, 
       1.4144002879050193`, 1.7140906435598429`}}]], 
    {GrayLevel[0.85], PointSize[0.025], 
     Point3DBox[
      NCache[{{0, 0, 0}, {-1, 0, 0}, {
        Rational[-3, 2], Rational[1, 2] 3^Rational[1, 2], 
         0}, {-1.3112499999999996`, 1.5523505362836068`, 
        0.7023754337959144}, {-0.892248306411026, 1.2793971316347617`, 
        1.5683627429755442`}, {0.0878218578058983, 1.4144002879050193`, 
        1.7140906435598429`}}, {{0, 0, 0}, {-1, 0, 
        0}, {-1.5, 0.8660254037844386, 0}, {-1.3112499999999996`, 
        1.5523505362836068`, 0.7023754337959144}, {-0.892248306411026, 
        1.2793971316347617`, 1.5683627429755442`}, {0.0878218578058983, 
        1.4144002879050193`, 1.7140906435598429`}}]]}}},
  Axes->False,
  ImageSize->{386.07046301129776`, 386.9094108468787},
  ViewPoint->{-2.812485700589807, -1.8790147117895213`, 0.09606194280998626},
  ViewVertical->{-0.6490481996450563, -0.544508297076808, \
-0.8147870624501306}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.695061560082364*^9, 3.695061687193681*^9, 3.695061826599939*^9, 
   3.695061899939538*^9, {3.695061944628637*^9, 3.6950619781705823`*^9}, 
   3.695062052841627*^9, 3.695062089639553*^9, 3.695062164549741*^9, 
   3.695062362854325*^9, {3.6950626047349925`*^9, 3.695062631346203*^9}, 
   3.695062678846036*^9}]
}, Closed]]
}, Closed]]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{1600, 827},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{594.9599999999999, 842.04}},
Magnification:>1.05 Inherited,
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 185, 3, 122, "Title"],
Cell[768, 27, 1073, 25, 72, "Input"],
Cell[CellGroupData[{
Cell[1866, 56, 268, 4, 76, "Section"],
Cell[CellGroupData[{
Cell[2159, 64, 236, 3, 51, "Subsection"],
Cell[2398, 69, 86904, 2009, 6152, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89339, 2083, 132, 2, 51, "Subsection"],
Cell[89474, 2087, 2651, 65, 2341, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[92162, 2157, 158, 2, 42, "Subsection"],
Cell[92323, 2161, 2976, 73, 14141, "Input"],
Cell[95302, 2236, 2397, 57, 7264, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[97736, 2298, 157, 2, 42, "Subsection"],
Cell[97896, 2302, 2572, 67, 20829, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[100505, 2374, 96, 1, 42, "Subsection"],
Cell[CellGroupData[{
Cell[100626, 2379, 149, 2, 41, "Subsubsection"],
Cell[100778, 2383, 1346, 24, 409, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[102161, 2412, 138, 1, 35, "Subsubsection"],
Cell[102302, 2415, 2524, 50, 359, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[104863, 2470, 149, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[105037, 2476, 3613, 68, 152, "Input"],
Cell[108653, 2546, 919, 26, 24, "Print"],
Cell[109575, 2574, 9057, 163, 217, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[118681, 2743, 123, 1, 41, "Subsubsection"],
Cell[118807, 2746, 1324, 33, 525, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[120168, 2784, 260, 3, 35, "Subsubsection"],
Cell[120431, 2789, 4639, 108, 36342, "Input"],
Cell[125073, 2899, 824, 23, 5373, "Input"],
Cell[125900, 2924, 540, 11, 3897, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[126477, 2940, 215, 3, 35, "Subsubsection"],
Cell[126695, 2945, 2375, 44, 283, "Input"],
Cell[129073, 2991, 2246, 54, 359, "Input"],
Cell[131322, 3047, 885, 19, 208, "Input"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[132268, 3073, 162, 2, 72, "Section"],
Cell[CellGroupData[{
Cell[132455, 3079, 245, 3, 51, "Subsection"],
Cell[132703, 3084, 3907, 105, 2850, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[136647, 3194, 151, 2, 42, "Subsection"],
Cell[136801, 3198, 5224, 116, 3192, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[142062, 3319, 122, 1, 42, "Subsection"],
Cell[142187, 3322, 6940, 169, 3537, "Input"],
Cell[149130, 3493, 3342, 88, 1651, "Input"],
Cell[152475, 3583, 148, 4, 275, "Input"],
Cell[152626, 3589, 148, 4, 275, "Input"],
Cell[152777, 3595, 1237, 34, 1309, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[154051, 3634, 345, 4, 42, "Subsection"],
Cell[154399, 3640, 4335, 116, 9840, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[158771, 3761, 241, 3, 42, "Subsection"],
Cell[159015, 3766, 4334, 115, 352, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163386, 3886, 95, 1, 51, "Subsection"],
Cell[163484, 3889, 2774, 58, 132, "Input"],
Cell[166261, 3949, 147, 2, 31, "Input"],
Cell[166411, 3953, 1563, 40, 132, "Input"],
Cell[167977, 3995, 2005, 57, 132, "Input"],
Cell[169985, 4054, 3843, 85, 333, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[173877, 4145, 224, 3, 57, "Section"],
Cell[174104, 4150, 4374, 112, 412, "Input"],
Cell[178481, 4264, 2553, 64, 212, "Input"],
Cell[181037, 4330, 1731, 48, 112, "Input"],
Cell[182771, 4380, 14026, 289, 831, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[196834, 4674, 234, 4, 61, "Section"],
Cell[CellGroupData[{
Cell[197093, 4682, 101, 1, 51, "Subsection"],
Cell[197197, 4685, 44270, 945, 22215, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[241504, 5635, 168, 2, 42, "Subsection"],
Cell[CellGroupData[{
Cell[241697, 5641, 248, 5, 41, "Subsubsection"],
Cell[241948, 5648, 1281, 25, 72, "Input"],
Cell[243232, 5675, 5239, 134, 472, "Input"],
Cell[248474, 5811, 272, 6, 284, "Input"],
Cell[248749, 5819, 1309, 32, 670, "Input"],
Cell[250061, 5853, 424, 12, 450, "Input"],
Cell[250488, 5867, 225, 6, 31, "Input"],
Cell[250716, 5875, 3850, 112, 172, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[254603, 5992, 129, 1, 35, "Subsubsection"],
Cell[254735, 5995, 532, 14, 663, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[255304, 6014, 127, 1, 35, "Subsubsection"],
Cell[255434, 6017, 4957, 98, 1788, "Input"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[260452, 6122, 225, 3, 57, "Section"],
Cell[CellGroupData[{
Cell[260702, 6129, 154, 2, 51, "Subsection"],
Cell[260859, 6133, 13442, 270, 2157, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[274338, 6408, 110, 1, 42, "Subsection"],
Cell[274451, 6411, 18022, 361, 932, "Input"],
Cell[292476, 6774, 1075, 29, 112, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[293600, 6809, 196, 3, 57, "Section"],
Cell[CellGroupData[{
Cell[293821, 6816, 101, 1, 6400, "Subsection"],
Cell[293925, 6819, 13906, 298, 135831, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[307868, 7122, 98, 1, 5131, "Subsection"],
Cell[307969, 7125, 4019, 64, 11146, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[312037, 7195, 151, 2, 57, "Section"],
Cell[CellGroupData[{
Cell[312213, 7201, 103, 1, 51, "Subsection"],
Cell[312319, 7204, 40618, 889, 2812, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[352974, 8098, 97, 1, 51, "Subsection"],
Cell[CellGroupData[{
Cell[353096, 8103, 164, 2, 41, "Subsubsection"],
Cell[CellGroupData[{
Cell[353285, 8109, 1763, 41, 92, "Input"],
Cell[355051, 8152, 2572, 61, 217, "Output"],
Cell[357626, 8215, 319, 6, 32, "Output"]
}, Open  ]],
Cell[357960, 8224, 290, 7, 31, "Input"],
Cell[CellGroupData[{
Cell[358275, 8235, 2388, 51, 92, "Input"],
Cell[360666, 8288, 3499, 78, 217, "Output"],
Cell[CellGroupData[{
Cell[364190, 8370, 481, 13, 24, "Print"],
Cell[364674, 8385, 288, 7, 24, "Print"],
Cell[364965, 8394, 194, 5, 24, "Print"],
Cell[365162, 8401, 343, 9, 24, "Print"],
Cell[365508, 8412, 287, 7, 24, "Print"],
Cell[365798, 8421, 481, 13, 24, "Print"],
Cell[366282, 8436, 277, 7, 24, "Print"],
Cell[366562, 8445, 194, 5, 24, "Print"],
Cell[366759, 8452, 341, 9, 24, "Print"],
Cell[367103, 8463, 300, 7, 24, "Print"],
Cell[367406, 8472, 481, 13, 24, "Print"],
Cell[367890, 8487, 264, 7, 24, "Print"],
Cell[368157, 8496, 196, 5, 24, "Print"],
Cell[368356, 8503, 343, 9, 24, "Print"],
Cell[368702, 8514, 287, 7, 24, "Print"],
Cell[368992, 8523, 481, 13, 24, "Print"],
Cell[369476, 8538, 236, 6, 24, "Print"],
Cell[369715, 8546, 196, 5, 24, "Print"],
Cell[369914, 8553, 343, 9, 24, "Print"],
Cell[370260, 8564, 316, 8, 24, "Print"],
Cell[370579, 8574, 479, 13, 24, "Print"],
Cell[371061, 8589, 234, 6, 24, "Print"],
Cell[371298, 8597, 194, 5, 24, "Print"],
Cell[371495, 8604, 341, 9, 24, "Print"],
Cell[371839, 8615, 300, 7, 24, "Print"],
Cell[372142, 8624, 481, 13, 24, "Print"],
Cell[372626, 8639, 236, 6, 24, "Print"],
Cell[372865, 8647, 196, 5, 24, "Print"],
Cell[373064, 8654, 343, 9, 24, "Print"],
Cell[373410, 8665, 298, 7, 24, "Print"],
Cell[373711, 8674, 479, 13, 24, "Print"],
Cell[374193, 8689, 234, 6, 24, "Print"],
Cell[374430, 8697, 196, 5, 24, "Print"],
Cell[374629, 8704, 343, 9, 24, "Print"],
Cell[374975, 8715, 287, 7, 24, "Print"],
Cell[375265, 8724, 481, 13, 24, "Print"],
Cell[375749, 8739, 236, 6, 24, "Print"],
Cell[375988, 8747, 194, 5, 24, "Print"],
Cell[376185, 8754, 341, 9, 24, "Print"],
Cell[376529, 8765, 272, 7, 24, "Print"]
}, Open  ]],
Cell[376816, 8775, 181, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[377034, 8785, 3768, 82, 218, InheritFromParent],
Cell[CellGroupData[{
Cell[380827, 8871, 802, 18, 24, "Print"],
Cell[381632, 8891, 611, 12, 24, "Print"],
Cell[382246, 8905, 518, 10, 24, "Print"],
Cell[382767, 8917, 665, 14, 24, "Print"],
Cell[383435, 8933, 609, 12, 24, "Print"],
Cell[384047, 8947, 803, 18, 24, "Print"],
Cell[384853, 8967, 599, 12, 24, "Print"],
Cell[385455, 8981, 518, 10, 24, "Print"],
Cell[385976, 8993, 665, 14, 24, "Print"],
Cell[386644, 9009, 611, 12, 24, "Print"],
Cell[387258, 9023, 805, 18, 24, "Print"],
Cell[388066, 9043, 586, 12, 24, "Print"],
Cell[388655, 9057, 518, 10, 24, "Print"],
Cell[389176, 9069, 667, 14, 24, "Print"],
Cell[389846, 9085, 624, 12, 24, "Print"],
Cell[390473, 9099, 803, 18, 24, "Print"],
Cell[391279, 9119, 558, 11, 24, "Print"],
Cell[391840, 9132, 518, 10, 24, "Print"],
Cell[392361, 9144, 665, 14, 24, "Print"],
Cell[393029, 9160, 640, 13, 24, "Print"],
Cell[393672, 9175, 803, 18, 24, "Print"],
Cell[394478, 9195, 558, 11, 24, "Print"],
Cell[395039, 9208, 518, 10, 24, "Print"],
Cell[395560, 9220, 665, 14, 24, "Print"],
Cell[396228, 9236, 622, 12, 24, "Print"],
Cell[396853, 9250, 803, 18, 24, "Print"],
Cell[397659, 9270, 560, 11, 24, "Print"],
Cell[398222, 9283, 520, 10, 24, "Print"],
Cell[398745, 9295, 667, 14, 24, "Print"],
Cell[399415, 9311, 622, 12, 24, "Print"],
Cell[400040, 9325, 803, 18, 24, "Print"],
Cell[400846, 9345, 560, 11, 24, "Print"],
Cell[401409, 9358, 520, 10, 24, "Print"],
Cell[401932, 9370, 665, 14, 24, "Print"],
Cell[402600, 9386, 609, 12, 24, "Print"],
Cell[403212, 9400, 803, 18, 24, "Print"],
Cell[404018, 9420, 558, 11, 24, "Print"],
Cell[404579, 9433, 518, 10, 24, "Print"],
Cell[405100, 9445, 665, 14, 24, "Print"],
Cell[405768, 9461, 596, 12, 24, "Print"]
}, Open  ]],
Cell[406379, 9476, 679, 12, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[407107, 9494, 113, 1, 41, "Subsubsection"],
Cell[407223, 9497, 2138, 45, 152, "Input"],
Cell[409364, 9544, 95, 1, 31, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[409520, 9552, 95, 1, 72, "Section"],
Cell[CellGroupData[{
Cell[409640, 9557, 103, 1, 51776, "Subsection"],
Cell[CellGroupData[{
Cell[409768, 9562, 99, 1, 41488, "Subsubsection"],
Cell[409870, 9565, 29324, 729, 1296319, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[439231, 10299, 114, 1, 41488, "Subsubsection"],
Cell[439348, 10302, 14562, 378, 292784, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[453959, 10686, 99, 1, 51776, "Subsection"],
Cell[454061, 10689, 1254, 27, 120984, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[455364, 10722, 96, 1, 57, "Section"],
Cell[CellGroupData[{
Cell[455485, 10727, 94, 1, 22496, "Subsection"],
Cell[455582, 10730, 1518, 37, 67658, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[457137, 10772, 152, 2, 50830, "Subsection"],
Cell[CellGroupData[{
Cell[457314, 10778, 168, 2, 40966, "Subsubsection"],
Cell[457485, 10782, 4112, 107, 391833, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[461634, 10894, 104, 1, 40966, "Subsubsection"],
Cell[461741, 10897, 4100, 116, 434268, "Input"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[465902, 11020, 279, 4, 57, "Section"],
Cell[CellGroupData[{
Cell[466206, 11028, 98, 1, 3631, "Subsection"],
Cell[CellGroupData[{
Cell[466329, 11033, 98, 1, 2837, "Subsubsection"],
Cell[466430, 11036, 6752, 198, 45522, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[473219, 11239, 168, 2, 2283, "Subsubsection"],
Cell[473390, 11243, 3005, 76, 16229, "Input"],
Cell[476398, 11321, 2039, 56, 11606, "Input"],
Cell[478440, 11379, 611, 17, 5373, "Input"],
Cell[479054, 11398, 636, 18, 5373, "Input"],
Cell[479693, 11418, 487, 9, 2283, "Input"],
Cell[480183, 11429, 256, 6, 2283, "Input"],
Cell[480442, 11437, 246, 3, 2283, "Input"],
Cell[480691, 11442, 3256, 84, 16229, "Input"],
Cell[483950, 11528, 322, 4, 2283, "Input"],
Cell[CellGroupData[{
Cell[484297, 11536, 1885, 49, 8446, "Input"],
Cell[486185, 11587, 11194, 198, 31780, "Output"]
}, Closed]]
}, Closed]]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

