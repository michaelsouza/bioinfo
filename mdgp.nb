(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    221024,       5048]
NotebookOptionsPosition[    218217,       4951]
NotebookOutlinePosition[    218758,       4972]
CellTagsIndexPosition[    218715,       4969]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["DMDGP Package", "Title",
 CellChangeTimes->{{3.6793495261201363`*^9, 3.6793495384395885`*^9}, 
   3.679349644788345*^9, 3.67934974754046*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Put", " ", "the", " ", "following", " ", "two", " ", "lines", " ", "at", 
    " ", "the", " ", "top", " ", "of", " ", "every", " ", 
    RowBox[{"notebook", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"messageHandler", "=", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Last", "[", "#", "]"}], ",", 
        RowBox[{"Abort", "[", "]"}]}], "]"}], "&"}]}], ";", "\n", 
    RowBox[{"Internal`AddHandler", "[", 
     RowBox[{"\"\<Message\>\"", ",", "messageHandler"}], "]"}], ";"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.679757497923143*^9, 3.679757497925144*^9}, {
  3.679757553203314*^9, 3.6797575703583574`*^9}, {3.6798207857498636`*^9, 
  3.6798207957920666`*^9}}],

Cell[CellGroupData[{

Cell["Instance Creation", "Section",
 CellChangeTimes->{{3.6793500520209*^9, 3.679350065056984*^9}}],

Cell[CellGroupData[{

Cell["Source Code", "Subsection",
 CellChangeTimes->{{3.679350082058382*^9, 3.6793500874771576`*^9}, 
   3.679918572426056*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\[IndentingNewLine]", 
    RowBox[{
    "CalculateProteinAngles", ",", "\[IndentingNewLine]", 
     "GenerateRandom3DBackbone", ",", "\[IndentingNewLine]", 
     "GenerateRandomDMDGPInstance"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetPositionUsingCartesianSystem", "::", "usage"}], "=", 
    "\"\<Set the atoms positions using atomic rotations and \
translations.\>\""}], ";", 
   RowBox[{
    RowBox[{"SetPositionUsingCartesianSystem", "[", 
     RowBox[{"d_", ",", "t_", ",", "w_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"declare", " ", "local", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "a", ",", "b", ",", "c", ",", "v", ",", "n", ",", "R", ",", "X", ",", 
        "numberOfAtoms"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"numberOfAtoms", "=", 
        RowBox[{"Length", "[", "d", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "atoms", " ", "positions", " ", "on", " ", "Euclidean", " ", "3", "d",
          " ", "space"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"X", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "numberOfAtoms"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "set", " ", "the", " ", "position", " ", "of", " ", "the", " ", 
         "three", " ", "first", " ", "points"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"d", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", "0", ",", "0"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"d", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"d", "[", 
               RowBox[{"[", "3", "]"}], "]"}], 
              RowBox[{"Cos", "[", 
               RowBox[{"t", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"[", "3", "]"}], "]"}], 
             RowBox[{"Sin", "[", 
              RowBox[{"t", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}]}], " ", ",", "0"}], 
           "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "remaining", " ", "positions"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "4"}], ",", 
         RowBox[{"i", "\[LessEqual]", "numberOfAtoms"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"[", 
               RowBox[{"i", "-", "3"}], "]"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"[", 
               RowBox[{"i", "-", "2"}], "]"}], "]"}], ",", 
             RowBox[{"X", "[", 
              RowBox[{"[", 
               RowBox[{"i", "-", "1"}], "]"}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"v", "=", " ", 
           RowBox[{
            RowBox[{"d", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "*", " ", 
            RowBox[{"Normalize", "[", 
             RowBox[{"b", "-", "c"}], "]"}]}]}], ";", " ", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "normal", " ", "to", " ", "the", " ", "plane", " ", "abc"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"n", "=", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"a", "-", "b"}], ",", 
             RowBox[{"c", "-", "b"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"apply", " ", "plane", " ", "rotation"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"R", "=", 
           RowBox[{"RotationTransform", "[", 
            RowBox[{
             RowBox[{"t", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "n"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"v", "=", 
           RowBox[{"R", "[", "v", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "apply", " ", "torsion", " ", "rotation", " ", "and", " ", 
            "translation"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"R", "=", 
           RowBox[{"RotationTransform", "[", 
            RowBox[{
             RowBox[{"w", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"c", "-", "b"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"v", "=", 
           RowBox[{
            RowBox[{"R", "[", "v", "]"}], "+", "c"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"set", " ", "i"}], "-", 
            RowBox[{"th", " ", "coordinate"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", "v"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "X"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SetPositionUsingHomogeneousCoords", "::", "usage"}], "=", 
   "\"\<Set the atoms positions using internal coordinate system.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetPositionUsingHomogeneousCoords", "[", 
     RowBox[{"d_", ",", "t_", ",", "w_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "B", ",", "B1", ",", "B2", ",", "B3", ",", "X", ",", "di", ",", "ct", 
        ",", "st", ",", "cw", ",", "sw", ",", "v", ",", "numberOfAtoms"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"numberOfAtoms", "=", 
        RowBox[{"Length", "[", "d", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "atoms", " ", "positions", " ", "on", " ", "Euclidean", " ", "3", "d",
          " ", "space"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"X", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "numberOfAtoms"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "set", " ", "the", " ", "position", " ", "of", " ", "the", " ", 
         "three", " ", "first", " ", "points"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"d", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", "0", ",", "0"}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", 
              RowBox[{"d", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"d", "[", 
               RowBox[{"[", "3", "]"}], "]"}], 
              RowBox[{"Cos", "[", 
               RowBox[{"t", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"d", "[", 
              RowBox[{"[", "3", "]"}], "]"}], 
             RowBox[{"Sin", "[", 
              RowBox[{"t", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}]}], " ", ",", "0"}], 
           "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "first", " ", "transformation", " ", "matrices"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"B1", "=", 
        RowBox[{"IdentityMatrix", "[", "4", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"B2", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0", ",", "0", ",", 
            RowBox[{"-", 
             RowBox[{"d", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ct", ",", "st"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"t", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", 
          RowBox[{"Sin", "[", 
           RowBox[{"t", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"di", "=", 
        RowBox[{"d", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"B3", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "ct"}], ",", 
            RowBox[{"-", "st"}], ",", "0", ",", 
            RowBox[{
             RowBox[{"-", "di"}], "*", "ct"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"st", ",", 
            RowBox[{"-", "ct"}], ",", "0", ",", 
            RowBox[{"di", "*", "st"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "remaining", " ", "coordinates"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"B", "=", 
        RowBox[{"B1", ".", "B2", ".", "B3"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "4"}], ",", 
         RowBox[{"i", "\[LessEqual]", "numberOfAtoms"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"ct", ",", "st"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"t", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Sin", "[", 
              RowBox[{"t", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"cw", ",", "sw"}], "}"}], "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Cos", "[", 
              RowBox[{"w", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
             RowBox[{"Sin", "[", 
              RowBox[{"w", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"di", "=", 
           RowBox[{"d", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"concatenate", " ", "transformation", " ", "matrices"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"B", " ", "=", 
           RowBox[{"B", ".", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "ct"}], ",", 
                RowBox[{"-", "st"}], ",", "0", ",", 
                RowBox[{
                 RowBox[{"-", "di"}], "*", "ct"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"st", "*", "cw"}], ",", 
                RowBox[{
                 RowBox[{"-", "ct"}], "*", "cw"}], ",", 
                RowBox[{"-", "sw"}], ",", 
                RowBox[{"di", "*", "st", "*", "cw"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"st", "*", "sw"}], ",", 
                RowBox[{
                 RowBox[{"-", "ct"}], "*", "sw"}], ",", "cw", ",", 
                RowBox[{"di", "*", "st", "*", "sw"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], 
             "}"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"apply", " ", "transformation", " ", "at", " ", "origin"}],
            " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"v", " ", "=", 
           RowBox[{"B", ".", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"update", " ", "coordinate"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"v", "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}]}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "X"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateRandom3DBackbone", "::", "usage"}], "=", 
   "\"\<Generates a random backbone in tridimensional Euclidean space.\>\""}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenerateRandom3DBackbone", "[", 
     RowBox[{"numberOfAtoms_", ",", 
      RowBox[{"algorithm_:", "\"\<HomogeneousCoords\>\""}], ",", 
      RowBox[{"seed_:", "False"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"declare", " ", "the", " ", "local", " ", "variables"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d", ",", "t", ",", "w", ",", "X", ",", "output"}], "}"}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"set", " ", "seed"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"BooleanQ", "[", "seed", "]"}], "]"}], ",", 
         RowBox[{"SeedRandom", "[", "seed", "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"length", " ", "of", " ", "covalent", " ", "bonds"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"1.526", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"d", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", "0"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"plane", " ", "angles"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"t", "=", 
        RowBox[{"Table", "[", 
         RowBox[{"1.91", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"t", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"torsion", " ", "angles"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"w", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RandomChoice", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"60", "Degree"}], ",", 
             RowBox[{"180", "Degree"}], ",", 
             RowBox[{"300", "Degree"}]}], "}"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"w", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "set", " ", "the", " ", "remaining", " ", "3", "d", " ", 
         "positions"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "algorithm", ",", "\[IndentingNewLine]", "\"\<HomogeneousCoords\>\"", 
         ",", 
         RowBox[{"X", "=", 
          RowBox[{"SetPositionUsingHomogeneousCoords", "[", 
           RowBox[{"d", ",", "t", ",", "w"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\"\<CartesianSystem\>\"", ",", 
         RowBox[{"X", "=", 
          RowBox[{"SetPositionUsingCartesianSystem", "[", 
           RowBox[{"d", ",", "t", ",", "w"}], "]"}]}], ",", 
         "\[IndentingNewLine]", "_", ",", 
         RowBox[{"Throw", "[", 
          RowBox[{"\"\<InvalidAlgorithm:\>\"", ",", 
           RowBox[{"OptionValue", "[", "algorithm", "]"}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "output"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<Points\>\"", "->", "X"}], ",", 
         RowBox[{"\"\<TorsionAngles\>\"", "->", "w"}], ",", 
         RowBox[{"\"\<CovalentBondLengths\>\"", "->", "d"}], ",", 
         RowBox[{"\"\<PlaneRotationAngles\>\"", "->", "t"}]}], "|>"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetMatrixDistance", "::", "usage"}], "=", 
   "\"\<Gets the complete distance matrix for all coordinates in the array X.\
\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetMatrixDistance", "[", "x_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{"x", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "-", 
        RowBox[{"x", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", 
        RowBox[{"Length", "[", "x", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", 
        RowBox[{"Length", "[", "x", "]"}]}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateRandomDMDGPInstance", "::", "usage"}], "=", 
   "\"\<Generates a random DMDGP instance.\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenerateRandomDMDGPInstance", "[", 
     RowBox[{"numberOfAtoms_", ",", 
      RowBox[{"dtol_:", "5.0"}], ",", 
      RowBox[{"algorithm_:", "\"\<DistanceMatrix\>\""}], ",", 
      RowBox[{"seed_:", "True"}]}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"declare", " ", "local", " ", "variables"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "j", ",", "k", ",", "X", ",", "G", ",", "D", ",", "N", ",", 
        "E", ",", "output", ",", "dij"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"X", "=", 
        RowBox[{"GenerateRandom3DBackbone", "[", 
         RowBox[{
         "numberOfAtoms", ",", "\"\<HomogeneousCoords\>\"", ",", "seed"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Switch", "[", 
        RowBox[{
        "algorithm", ",", "\[IndentingNewLine]", "\"\<DistanceMatrix\>\"", 
         ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"D", "=", 
           RowBox[{"DistanceMatrix", "[", 
            RowBox[{"X", "[", "\"\<Points\>\"", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"G", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"And", "[", 
                RowBox[{
                 RowBox[{"0", "<", 
                  RowBox[{
                   RowBox[{"D", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"D", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "\[LessEqual]", "dtol"}]}],
                 "]"}], ",", 
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "Infinity"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "numberOfAtoms"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "numberOfAtoms"}], "}"}]}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"G", "=", 
           RowBox[{"WeightedAdjacencyGraph", "[", "G", "]"}]}]}], ",", 
         "\[IndentingNewLine]", "\"\<Nearest\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"N", "=", 
           RowBox[{"Nearest", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"X", "[", "\"\<Points\>\"", "]"}], "\[Rule]", 
              "Automatic"}], ",", 
             RowBox[{"X", "[", "\"\<Points\>\"", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"All", ",", "dtol"}], "}"}], ",", " ", 
             RowBox[{"Method", "\[Rule]", " ", "\"\<Octree\>\""}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"E", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "1"}], ",", 
            RowBox[{"i", "\[LessEqual]", 
             RowBox[{"Length", "[", "N", "]"}]}], ",", 
            RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", "1"}], ",", 
               RowBox[{"j", "\[LessEqual]", 
                RowBox[{"Length", "[", 
                 RowBox[{"N", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
               RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"k", "=", 
                 RowBox[{
                  RowBox[{"N", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], "[", 
                  RowBox[{"[", "j", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"k", ">", "i"}], ",", 
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"E", ",", 
                    RowBox[{"i", "\[UndirectedEdge]", "k"}]}], "]"}]}], 
                 "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"G", "=", 
           RowBox[{"Graph", "[", "E", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"E", "=", 
           RowBox[{"EdgeList", "[", "G", "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"k", "=", "1"}], ",", 
            RowBox[{"k", "\[LessEqual]", 
             RowBox[{"Length", "[", "E", "]"}]}], ",", 
            RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"i", "=", 
              RowBox[{
               RowBox[{"E", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"j", "=", 
              RowBox[{
               RowBox[{"E", "[", 
                RowBox[{"[", "k", "]"}], "]"}], "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"PropertyValue", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"G", ",", 
                  RowBox[{"i", "\[UndirectedEdge]", "j"}]}], "}"}], ",", 
                "EdgeWeight"}], "]"}], "=", 
              RowBox[{"EuclideanDistance", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"X", "[", "\"\<Points\>\"", "]"}], "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"X", "[", "\"\<Points\>\"", "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}]}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", "_", 
         ",", 
         RowBox[{"Throw", "[", "\"\<InvalidAlgorithm\>\"", "]"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<X\>\"", "->", "X"}], ",", 
         RowBox[{"\"\<G\>\"", "->", "G"}]}], "|>"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Plot3DBackbone", "::", "usage"}], "=", 
   "\"\<Plots the points using the coordinates of X[Points].\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Plot3DBackbone", "[", "X_", "]"}], ":=", 
   RowBox[{"Graphics3D", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Line", "[", 
        RowBox[{"X", "[", "\"\<Points\>\"", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"PointSize", "[", "Large", "]"}], ",", "Blue", ",", 
         RowBox[{"Point", "[", 
          RowBox[{"X", "[", "\"\<Points\>\"", "]"}], "]"}]}], "}"}]}], "}"}], 
     ",", " ", 
     RowBox[{"Axes", "\[Rule]", "True"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CalculateProteinAngles", "::", "usage"}], "=", 
   "\"\<Calculates the protein angles (plane and torsion) considering the \
sequence A-B-C-D.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalculateProteinAngles", "[", 
     RowBox[{"A_", ",", "B_", ",", "C_", ",", "D_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Calculate", " ", "the", " ", "plane", " ", "and", " ", "torsion", " ", 
       "angles", " ", "for", " ", "X4"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"nabc", ",", " ", "nbcd"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"centered", " ", "at", " ", "C"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Angle[BCD] =\>\"", ",", 
         RowBox[{"VectorAngle", "[", 
          RowBox[{
           RowBox[{"B", "-", "C"}], ",", 
           RowBox[{"D", "-", "C"}]}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"centered", " ", "at", " ", "B", " ", "and", " ", "C"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nabc", ",", "nbcd"}], "}"}], " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{"A", "-", "B"}], ",", 
            RowBox[{"C", "-", "B"}]}], "]"}], ",", 
          RowBox[{"Cross", "[", 
           RowBox[{
            RowBox[{"B", "-", "C"}], ",", 
            RowBox[{"D", "-", "C"}]}], "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Angle[ABCD]=\>\"", ",", 
         RowBox[{"VectorAngle", "[", 
          RowBox[{"nabc", ",", "nbcd"}], "]"}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CalculateProteinAnglesForAtomAtPosition", "::", "usage"}], "=", 
   "\"\<Calculates the protein angles (plane and torsion) to i-th \
atom.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalculateProteinAnglesForAtomAtPosition", "[", 
     RowBox[{"X_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"CalculateProteinAngles", "[", 
     RowBox[{
      RowBox[{"X", "[", 
       RowBox[{"[", 
        RowBox[{"i", "-", "3"}], "]"}], "]"}], ",", 
      RowBox[{"X", "[", 
       RowBox[{"[", 
        RowBox[{"i", "-", "2"}], "]"}], "]"}], ",", 
      RowBox[{"X", "[", 
       RowBox[{"[", 
        RowBox[{"i", "-", "1"}], "]"}], "]"}], ",", 
      RowBox[{"X", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetEdgeWeight", "::", "usage"}], "=", 
   "\"\<Gets edge weight.\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetEdgeWeight", "[", 
     RowBox[{"G_", ",", "E_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", 
        RowBox[{"D", "=", 
         RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"FailureQ", "[", 
           RowBox[{"PropertyValue", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"G", ",", 
               RowBox[{"E", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", "EdgeWeight"}], 
            "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "E", " ", "is", " ", "a", " ", "list", " ", "of", " ", "edges"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Length", "[", "E", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"D", ",", 
             RowBox[{"PropertyValue", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"G", ",", 
                 RowBox[{"E", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], "}"}], ",", 
               "EdgeWeight"}], "]"}]}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"E", " ", "is", " ", "a", " ", "single", " ", "edge"}], " ",
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{"D", "=", 
          RowBox[{"PropertyValue", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"G", ",", "E"}], "}"}], ",", "EdgeWeight"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "D", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IsNaturalOrderValid", "[", "G_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"local", " ", "variables"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i", ",", "j"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "4"}], ",", 
         RowBox[{"i", "\[LessEqual]", 
          RowBox[{"Length", "[", 
           RowBox[{"VertexList", "[", "G", "]"}], "]"}]}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"j", "=", "1"}], ",", 
            RowBox[{"j", "\[LessEqual]", "3"}], ",", 
            RowBox[{"j", "++"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"FailureQ", "[", 
               RowBox[{"GetEdgeWeight", "[", 
                RowBox[{"G", ",", 
                 RowBox[{"i", "\[UndirectedEdge]", 
                  RowBox[{"(", 
                   RowBox[{"i", "-", "j"}], ")"}]}]}], "]"}], "]"}], ",", 
              RowBox[{"Return", "[", "False", "]"}]}], "]"}]}], "]"}], 
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "True", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CalculatePartialSolutionError", "[", 
     RowBox[{"G_", ",", "X_", ",", "i_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"local", " ", "variables"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "j", ",", "k", ",", "V", ",", "Xi", ",", "Xj", ",", "dij", ",", "Dij", 
        ",", "errorDij"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"current", " ", "position"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Xi", "=", 
        RowBox[{"X", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "considering", " ", "only", " ", "the", " ", "precedent", " ", 
         "atoms"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"V", "=", " ", 
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"AdjacencyList", "[", 
           RowBox[{"G", ",", "i"}], "]"}], ",", 
          RowBox[{
           RowBox[{"#", "<", "i"}], "&"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"errorDij", "=", "0.0"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"k", "=", "1"}], ",", 
         RowBox[{"k", "\[LessEqual]", 
          RowBox[{"Length", "[", "V", "]"}]}], ",", 
         RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"neighbor", " ", "index"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"j", "=", 
           RowBox[{"V", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], ";", " ", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"neighbor", " ", "coordinate"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Xj", "=", 
           RowBox[{"X", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"actual", " ", "distance"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"dij", "=", 
           RowBox[{"EuclideanDistance", "[", 
            RowBox[{"Xi", ",", "Xj"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"prescribed", " ", "distance"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Dij", "=", 
           RowBox[{"GetEdgeWeight", "[", 
            RowBox[{"G", ",", 
             RowBox[{"i", "\[UndirectedEdge]", "j"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "check", " ", "if", " ", "actual", " ", "distance", " ", "is", " ",
             "valid"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"errorDij", "=", 
           RowBox[{"Max", "[", 
            RowBox[{"errorDij", ",", 
             RowBox[{"Abs", "[", 
              RowBox[{"Dij", "-", "dij"}], "]"}]}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "errorDij", "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CheckDMDGPSolutionQuality", "[", 
    RowBox[{"G_", ",", "X_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "j", ",", "k", ",", "dij", ",", " ", "Dij", ",", 
       "numberOfEdges", ",", "E", ",", "error"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"E", "=", 
       RowBox[{"EdgeList", "[", "G", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"numberOfEdges", "=", 
       RowBox[{"Length", "[", "E", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"error", "=", 
       RowBox[{"Table", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "numberOfEdges"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", "=", "1"}], ",", 
        RowBox[{"k", "\[LessEqual]", "numberOfEdges"}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"i", "=", 
            RowBox[{
             RowBox[{"E", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ",", 
           RowBox[{"j", "=", 
            RowBox[{
             RowBox[{"E", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dij", "=", 
          RowBox[{"GetEdgeWeight", "[", 
           RowBox[{"G", ",", 
            RowBox[{"i", "\[UndirectedEdge]", "j"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Dij", "=", 
          RowBox[{"Norm", "[", 
           RowBox[{
            RowBox[{"X", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "-", 
            RowBox[{"X", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"error", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "=", 
          RowBox[{"Abs", "[", 
           RowBox[{"Dij", "-", "dij"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<max(error) = \>\"", ",", 
        RowBox[{"Max", "[", "error", "]"}], ",", " ", 
        "\"\< mean(error) = \>\"", ",", " ", 
        RowBox[{"Mean", "[", "error", "]"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.679334396696954*^9, 3.6793344197378874`*^9}, {
   3.679334459021727*^9, 3.6793344614910192`*^9}, {3.679334506573509*^9, 
   3.67933450744427*^9}, 3.679334554859289*^9, {3.6793347748775415`*^9, 
   3.6793348146727505`*^9}, {3.6793348683176303`*^9, 
   3.6793349148147354`*^9}, {3.679335216182414*^9, 3.679335270449379*^9}, {
   3.679335358320606*^9, 3.6793353855927134`*^9}, {3.679335422113183*^9, 
   3.679335422860292*^9}, {3.679335467322652*^9, 3.6793354718670073`*^9}, {
   3.679335502941807*^9, 3.6793355176517873`*^9}, {3.6793359308181715`*^9, 
   3.6793359602458916`*^9}, {3.6793359984610925`*^9, 3.679336011029911*^9}, {
   3.679336355941925*^9, 3.679336390681263*^9}, {3.679336436703087*^9, 
   3.679336440913059*^9}, {3.6793364973777227`*^9, 3.679336508943397*^9}, {
   3.679337482798051*^9, 3.6793374878195066`*^9}, {3.679337531710136*^9, 
   3.679337679993342*^9}, {3.679337711180924*^9, 3.6793377943636985`*^9}, {
   3.679337830273183*^9, 3.6793379235522385`*^9}, {3.6793380600889235`*^9, 
   3.679338107718841*^9}, {3.679338168311281*^9, 3.6793381690922422`*^9}, {
   3.679338254307039*^9, 3.679338327393572*^9}, {3.6793384127916727`*^9, 
   3.679338418720523*^9}, {3.6793384657072325`*^9, 3.679338788372825*^9}, {
   3.679338898441475*^9, 3.6793389990638256`*^9}, {3.6793390477861385`*^9, 
   3.679339051499843*^9}, {3.6793391446277075`*^9, 3.6793392599804153`*^9}, 
   3.6793393742092657`*^9, {3.6793395780321927`*^9, 3.6793398587893867`*^9}, {
   3.6793398957561593`*^9, 3.6793399605794096`*^9}, {3.67934000207397*^9, 
   3.6793400630782733`*^9}, {3.6793401514655437`*^9, 
   3.6793403347497687`*^9}, {3.6793403699550896`*^9, 3.67934037140318*^9}, {
   3.679340563130898*^9, 3.6793405841237473`*^9}, {3.6793406189939303`*^9, 
   3.6793406823092556`*^9}, {3.6793413087872534`*^9, 
   3.6793413117913976`*^9}, {3.6793414144409704`*^9, 
   3.6793414780425982`*^9}, {3.6793415857352*^9, 3.679341749056054*^9}, {
   3.6793418327409945`*^9, 3.6793418417524166`*^9}, {3.679341876481241*^9, 
   3.6793418824052687`*^9}, {3.679341997125859*^9, 3.6793420172739105`*^9}, {
   3.67934205563032*^9, 3.6793420821291895`*^9}, {3.679342117275077*^9, 
   3.6793421196924405`*^9}, {3.6793421834981775`*^9, 3.679342183855644*^9}, {
   3.6793422500684495`*^9, 3.6793422840007253`*^9}, {3.6793424043195424`*^9, 
   3.6793424350150757`*^9}, {3.679342585125659*^9, 3.679342801705634*^9}, {
   3.679342833323803*^9, 3.6793428396110015`*^9}, {3.6793429405557547`*^9, 
   3.6793429972575336`*^9}, {3.679343068573412*^9, 3.6793430980621653`*^9}, 
   3.6793431423230133`*^9, {3.6793431858227177`*^9, 3.6793432209529057`*^9}, {
   3.6793432860551014`*^9, 3.6793433042354126`*^9}, {3.6793433545087633`*^9, 
   3.6793433652364955`*^9}, {3.6793452969963503`*^9, 3.6793453088097954`*^9}, 
   3.6793461153501606`*^9, {3.6793473536334457`*^9, 3.6793473954665585`*^9}, {
   3.6793477301073675`*^9, 3.679347763333604*^9}, {3.6793478591437263`*^9, 
   3.6793478625984306`*^9}, {3.6793480121537013`*^9, 
   3.6793482720333853`*^9}, {3.67934834772797*^9, 3.6793483523074236`*^9}, {
   3.6793484687244396`*^9, 3.679348489631818*^9}, {3.679348535732118*^9, 
   3.6793485836744003`*^9}, {3.679348656480409*^9, 3.6793486600900903`*^9}, 
   3.6793492489231615`*^9, {3.6793494190708942`*^9, 3.679349419296319*^9}, 
   3.6793494823993444`*^9, {3.6793500975888023`*^9, 3.6793501010398235`*^9}, {
   3.6793503502988024`*^9, 3.679350357442238*^9}, {3.679350388693789*^9, 
   3.6793504609919558`*^9}, {3.679350512381988*^9, 3.6793505224916997`*^9}, {
   3.6793505658690414`*^9, 3.679350573203977*^9}, {3.6793920543569756`*^9, 
   3.6793923209393916`*^9}, {3.679392352626535*^9, 3.6793925381168537`*^9}, {
   3.6793926280473437`*^9, 3.679392661685611*^9}, {3.679392696383786*^9, 
   3.679392699025669*^9}, {3.6793928383564887`*^9, 3.6793934549091573`*^9}, {
   3.679393586505351*^9, 3.679393616703784*^9}, {3.6793939133345203`*^9, 
   3.6793939143222685`*^9}, 3.6793940696010857`*^9, {3.679394099668668*^9, 
   3.6793944506348133`*^9}, {3.679394784056423*^9, 3.67939534176003*^9}, {
   3.679395381425836*^9, 3.679395503566868*^9}, {3.6793955684350924`*^9, 
   3.6793955734567842`*^9}, {3.6793957804079714`*^9, 
   3.6793958367041416`*^9}, {3.6793960807594223`*^9, 3.679396100513118*^9}, {
   3.67939616157646*^9, 3.679396197364892*^9}, {3.6793962497184567`*^9, 
   3.679396282906206*^9}, {3.679396609090597*^9, 3.6793966167836933`*^9}, {
   3.679396648625914*^9, 3.6793966543985653`*^9}, {3.679396740943916*^9, 
   3.679396768582145*^9}, {3.679396857866257*^9, 3.6793968963813653`*^9}, {
   3.6793969336171*^9, 3.6793970905785065`*^9}, {3.6793971251566105`*^9, 
   3.6793971298515577`*^9}, {3.679397221304947*^9, 3.67939722410863*^9}, {
   3.6793972641763353`*^9, 3.679397266225936*^9}, {3.6793983203128195`*^9, 
   3.6793983706649785`*^9}, {3.679398435449253*^9, 3.6793984477299423`*^9}, {
   3.6793984907409554`*^9, 3.6793985421648207`*^9}, {3.679398593771634*^9, 
   3.6793986705180993`*^9}, {3.6793989235435977`*^9, 3.67939893434542*^9}, {
   3.679403394164427*^9, 3.6794034018166647`*^9}, {3.679403783825127*^9, 
   3.6794037864835734`*^9}, {3.6794038759602175`*^9, 
   3.6794040830475106`*^9}, {3.679404119305796*^9, 3.679404298238202*^9}, 
   3.679404382036023*^9, {3.679404653274694*^9, 3.6794046842305584`*^9}, {
   3.6794050293859835`*^9, 3.6794050557043276`*^9}, {3.6794051146048007`*^9, 
   3.679405116722584*^9}, {3.679405184367193*^9, 3.6794052171029243`*^9}, {
   3.679405498432304*^9, 3.679405569807764*^9}, {3.679405690984426*^9, 
   3.6794056940269375`*^9}, {3.679405754352635*^9, 3.6794057624882355`*^9}, 
   3.679405828952403*^9, {3.6794059773823776`*^9, 3.679406037058329*^9}, {
   3.679406078458248*^9, 3.6794061638320656`*^9}, {3.6794064355972614`*^9, 
   3.679406619068183*^9}, {3.67940666239577*^9, 3.679406687383835*^9}, {
   3.679406724763648*^9, 3.6794067251687045`*^9}, 3.6794068172515316`*^9, {
   3.679406863506428*^9, 3.679406872901106*^9}, {3.679406930446825*^9, 
   3.679406948401491*^9}, {3.6794070040861063`*^9, 3.6794070065561094`*^9}, {
   3.679407312344544*^9, 3.679407314713808*^9}, {3.679407430180848*^9, 
   3.679407458271701*^9}, 3.6794078238766403`*^9, {3.679407878354503*^9, 
   3.6794082035777364`*^9}, {3.679566685353998*^9, 3.67956669759547*^9}, 
   3.679568153295287*^9, {3.6795682979748397`*^9, 3.679568399913588*^9}, {
   3.679568451510522*^9, 3.679568495166552*^9}, {3.6795691795206947`*^9, 
   3.679569250499019*^9}, {3.679569280716798*^9, 3.6795693785712852`*^9}, {
   3.6795925633128986`*^9, 3.679592673970081*^9}, {3.679592721867278*^9, 
   3.6795927229374475`*^9}, {3.679594988131906*^9, 3.679595118982105*^9}, {
   3.679738892130002*^9, 3.679738904422254*^9}, {3.6797389527800984`*^9, 
   3.6797389661620564`*^9}, {3.6797390238401327`*^9, 
   3.6797390636940556`*^9}, {3.6797391569629755`*^9, 3.679739218024413*^9}, {
   3.679739321633385*^9, 3.6797393341911097`*^9}, {3.6797394358016376`*^9, 
   3.679739498369319*^9}, {3.679739592363925*^9, 3.6797396087330103`*^9}, {
   3.6797405277538753`*^9, 3.6797405906735935`*^9}, {3.679741837482974*^9, 
   3.679741856061937*^9}, {3.6797530753347263`*^9, 3.679753080740266*^9}, {
   3.679822610411623*^9, 3.6798226951736937`*^9}, {3.6798262757554946`*^9, 
   3.6798262950500765`*^9}, {3.6798304972475395`*^9, 3.679830500587058*^9}, {
   3.6798305863580213`*^9, 3.6798306115801296`*^9}, {3.679830653827534*^9, 
   3.679830659160823*^9}, {3.679830750679475*^9, 3.679830778729604*^9}, {
   3.6798309380103083`*^9, 3.679831207376337*^9}, {3.6798312397643733`*^9, 
   3.6798313536889253`*^9}, {3.6798313849934535`*^9, 3.679831403721264*^9}, {
   3.6798314534696703`*^9, 3.6798315710288057`*^9}, {3.6798316592417555`*^9, 
   3.6798317372267046`*^9}, 3.679831789061343*^9, {3.679831822090675*^9, 
   3.679831828828328*^9}, {3.6798318972804823`*^9, 3.6798319051885147`*^9}, {
   3.679831945915737*^9, 3.6798319534838204`*^9}, {3.679831984167186*^9, 
   3.679831996593215*^9}, {3.6798321399538794`*^9, 3.6798321522301235`*^9}, {
   3.6798322802409973`*^9, 3.6798322901002426`*^9}, {3.679832475527353*^9, 
   3.6798324791745257`*^9}, {3.679832515937626*^9, 3.6798325272304134`*^9}, {
   3.6798328341287575`*^9, 3.6798328453074446`*^9}, {3.679832936913255*^9, 
   3.6798329499211493`*^9}, 3.6798329836635427`*^9, 3.6799120745739098`*^9, {
   3.68096946640281*^9, 3.680969506471238*^9}, {3.6809695943663626`*^9, 
   3.6809695983006277`*^9}, {3.680971291386725*^9, 3.680971292487916*^9}, {
   3.6810483453596783`*^9, 3.6810483658374515`*^9}, {3.681049666557871*^9, 
   3.681049672721483*^9}, {3.681049746015087*^9, 3.6810497473331203`*^9}, {
   3.681050036116782*^9, 3.6810503893437195`*^9}, {3.681050439415736*^9, 
   3.681050443570201*^9}, {3.6810508388119097`*^9, 3.681050853163069*^9}, {
   3.6810508894027395`*^9, 3.681050893808611*^9}, {3.681050960791823*^9, 
   3.6810510981120815`*^9}, {3.68105113216866*^9, 3.6810511668364615`*^9}, {
   3.681051291204856*^9, 3.6810512973216534`*^9}, {3.681051343040867*^9, 
   3.6810513458639803`*^9}, {3.6810514354795513`*^9, 
   3.6810514424265547`*^9}, {3.6810515295113626`*^9, 3.681051567230074*^9}, 
   3.681051692501606*^9, {3.681051791144629*^9, 3.681051837795389*^9}, {
   3.6810519974251823`*^9, 3.6810521036048183`*^9}, {3.681052180564599*^9, 
   3.6810521932444377`*^9}, {3.681052498724401*^9, 3.6810525317013626`*^9}, {
   3.681052601514738*^9, 3.6810526020129356`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "Subsection",
 CellChangeTimes->{{3.679350148964155*^9, 3.679350152549901*^9}}],

Cell[CellGroupData[{

Cell["Generating Random Backbone", "Subsubsection",
 CellChangeTimes->{{3.6794062471789994`*^9, 3.6794062544567323`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"GenerateRandom3DBackbone", "[", 
    RowBox[{"15", ",", 
     RowBox[{"algorithm", "=", "\"\<HomogeneousCoords\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<X=\>\"", ",", "X"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot3DBackbone", "[", "X", "]"}]}], "Input",
 CellChangeTimes->{{3.679350157857408*^9, 3.679350165349809*^9}, {
  3.6793502625517855`*^9, 3.679350272500025*^9}, {3.679396602457681*^9, 
  3.679396602655339*^9}, {3.6793984596979012`*^9, 3.679398481302373*^9}, {
  3.679398558121312*^9, 3.679398568806862*^9}, {3.6793987232327337`*^9, 
  3.6793987324597783`*^9}, {3.6794062058056207`*^9, 3.6794062060104556`*^9}, {
  3.679739893222548*^9, 3.6797398937194076`*^9}, {3.681050559273715*^9, 
  3.6810505666590476`*^9}, {3.681050654496676*^9, 3.6810506562786503`*^9}, {
  3.681050712877989*^9, 3.6810507449910135`*^9}, {3.681050801548744*^9, 
  3.681050813086647*^9}, {3.681050922084615*^9, 3.6810509231624775`*^9}, {
  3.6810511804399896`*^9, 3.6810511998720293`*^9}, {3.6810515964300175`*^9, 
  3.6810515965511436`*^9}, {3.681052116460451*^9, 3.6810521260369215`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"X=\"\>", "\[InvisibleSpace]", 
   RowBox[{"\[LeftAssociation]", 
    RowBox[{
     RowBox[{"\<\"Points\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.526`"}], ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2.0337555109089696`"}], ",", "1.4390484151485563`", 
          ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.5241785045443845`"}], ",", "2.1572837656628074`", 
          ",", 
          RowBox[{"-", "1.246252484794385`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2.033757142297638`"}], ",", "1.4371162838994702`", 
          ",", 
          RowBox[{"-", "2.49138878663294`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.5260016299275454`"}], ",", 
          RowBox[{"-", "0.0019304007715184035`"}], ",", 
          RowBox[{"-", "2.4891574204098705`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2.0355770034436476`"}], ",", 
          RowBox[{"-", "0.7182318911089862`"}], ",", 
          RowBox[{"-", "1.2417917508300764`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.527821491073555`"}], ",", 
          RowBox[{"-", "2.157278575779975`"}], ",", 
          RowBox[{"-", "1.2395603846070071`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "2.0374001288268087`"}], ",", 
          RowBox[{"-", "2.8774460575433123`"}], ",", 
          RowBox[{"-", "2.484696686445562`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1.5278231224622236`"}], ",", 
          RowBox[{"-", "2.159210707029061`"}], ",", 
          RowBox[{"-", "3.7309491712399474`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.0018247538508919803`"}], ",", 
          RowBox[{"-", "2.161142838278147`"}], ",", 
          RowBox[{"-", "3.7298329882841172`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.5077522525136928`", ",", 
          RowBox[{"-", "1.4429074877638954`"}], ",", 
          RowBox[{"-", "4.976085473078503`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2.0337506211250247`", ",", 
          RowBox[{"-", "1.4448396190129813`"}], ",", 
          RowBox[{"-", "4.974969290122672`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2.5396830066508334`", ",", 
          RowBox[{"-", "2.884529577873029`"}], ",", 
          RowBox[{"-", "4.973854106855433`"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"2.030107633134731`", ",", 
          RowBox[{"-", "3.6027643538005374`"}], ",", 
          RowBox[{"-", "6.220107590443057`"}]}], "}"}]}], "}"}]}], ",", 
     RowBox[{"\<\"TorsionAngles\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", 
        RowBox[{"60", " ", "\[Degree]"}], ",", 
        RowBox[{"60", " ", "\[Degree]"}], ",", 
        RowBox[{"300", " ", "\[Degree]"}], ",", 
        RowBox[{"60", " ", "\[Degree]"}], ",", 
        RowBox[{"180", " ", "\[Degree]"}], ",", 
        RowBox[{"300", " ", "\[Degree]"}], ",", 
        RowBox[{"60", " ", "\[Degree]"}], ",", 
        RowBox[{"60", " ", "\[Degree]"}], ",", 
        RowBox[{"180", " ", "\[Degree]"}], ",", 
        RowBox[{"180", " ", "\[Degree]"}], ",", 
        RowBox[{"60", " ", "\[Degree]"}], ",", 
        RowBox[{"60", " ", "\[Degree]"}]}], "}"}]}], ",", 
     RowBox[{"\<\"CovalentBondLengths\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "1.526`", ",", "1.526`", ",", "1.526`", ",", "1.526`", ",", 
        "1.526`", ",", "1.526`", ",", "1.526`", ",", "1.526`", ",", "1.526`", 
        ",", "1.526`", ",", "1.526`", ",", "1.526`", ",", "1.526`", ",", 
        "1.526`"}], "}"}]}], ",", 
     RowBox[{"\<\"PlaneRotationAngles\"\>", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "1.91`", ",", "1.91`", ",", "1.91`", ",", "1.91`", 
        ",", "1.91`", ",", "1.91`", ",", "1.91`", ",", "1.91`", ",", "1.91`", 
        ",", "1.91`", ",", "1.91`", ",", "1.91`", ",", "1.91`"}], "}"}]}]}], 
    "\[RightAssociation]"}]}],
  SequenceForm["X=", 
   Association[
   "Points" -> {{0, 0, 
      0}, {-1.526, 0, 0}, {-2.0337555109089696`, 1.4390484151485563`, 
       0}, {-1.5241785045443845`, 
      2.1572837656628074`, -1.246252484794385}, {-2.033757142297638, 
      1.4371162838994702`, -2.49138878663294}, {-1.5260016299275454`, \
-0.0019304007715184035`, -2.4891574204098705`}, {-2.0355770034436476`, \
-0.7182318911089862, -1.2417917508300764`}, {-1.527821491073555, \
-2.157278575779975, -1.2395603846070071`}, {-2.0374001288268087`, \
-2.8774460575433123`, -2.484696686445562}, {-1.5278231224622236`, \
-2.159210707029061, -3.7309491712399474`}, {-0.0018247538508919803`, \
-2.161142838278147, -3.7298329882841172`}, {
      0.5077522525136928, -1.4429074877638954`, -4.976085473078503}, {
      2.0337506211250247`, -1.4448396190129813`, -4.974969290122672}, {
      2.5396830066508334`, -2.884529577873029, -4.973854106855433}, {
      2.030107633134731, -3.6027643538005374`, -6.220107590443057}}, 
    "TorsionAngles" -> {
     0, 0, 0, 60 Degree, 60 Degree, 300 Degree, 60 Degree, 180 Degree, 300 
      Degree, 60 Degree, 60 Degree, 180 Degree, 180 Degree, 60 Degree, 60 
      Degree}, "CovalentBondLengths" -> {
     0, 1.526, 1.526, 1.526, 1.526, 1.526, 1.526, 1.526, 1.526, 1.526, 1.526, 
      1.526, 1.526, 1.526, 1.526}, 
    "PlaneRotationAngles" -> {
     0, 0, 1.91, 1.91, 1.91, 1.91, 1.91, 1.91, 1.91, 1.91, 1.91, 1.91, 1.91, 
      1.91, 1.91}]],
  Editable->False]], "Print",
 CellChangeTimes->{3.6810524273065057`*^9, 3.681052539281664*^9, 
  3.6810526794448013`*^9}],

Cell[BoxData[
 Graphics3DBox[{
   Line3DBox[{{0, 0, 
     0}, {-1.526, 0, 0}, {-2.0337555109089696`, 1.4390484151485563`, 
      0}, {-1.5241785045443845`, 
     2.1572837656628074`, -1.246252484794385}, {-2.033757142297638, 
     1.4371162838994702`, -2.49138878663294}, {-1.5260016299275454`, \
-0.0019304007715184035`, -2.4891574204098705`}, {-2.0355770034436476`, \
-0.7182318911089862, -1.2417917508300764`}, {-1.527821491073555, \
-2.157278575779975, -1.2395603846070071`}, {-2.0374001288268087`, \
-2.8774460575433123`, -2.484696686445562}, {-1.5278231224622236`, \
-2.159210707029061, -3.7309491712399474`}, {-0.0018247538508919803`, \
-2.161142838278147, -3.7298329882841172`}, {
     0.5077522525136928, -1.4429074877638954`, -4.976085473078503}, {
     2.0337506211250247`, -1.4448396190129813`, -4.974969290122672}, {
     2.5396830066508334`, -2.884529577873029, -4.973854106855433}, {
     2.030107633134731, -3.6027643538005374`, -6.220107590443057}}], 
   {RGBColor[0, 0, 1], PointSize[Large], 
    Point3DBox[{{0, 0, 
      0}, {-1.526, 0, 0}, {-2.0337555109089696`, 1.4390484151485563`, 
       0}, {-1.5241785045443845`, 
      2.1572837656628074`, -1.246252484794385}, {-2.033757142297638, 
      1.4371162838994702`, -2.49138878663294}, {-1.5260016299275454`, \
-0.0019304007715184035`, -2.4891574204098705`}, {-2.0355770034436476`, \
-0.7182318911089862, -1.2417917508300764`}, {-1.527821491073555, \
-2.157278575779975, -1.2395603846070071`}, {-2.0374001288268087`, \
-2.8774460575433123`, -2.484696686445562}, {-1.5278231224622236`, \
-2.159210707029061, -3.7309491712399474`}, {-0.0018247538508919803`, \
-2.161142838278147, -3.7298329882841172`}, {
      0.5077522525136928, -1.4429074877638954`, -4.976085473078503}, {
      2.0337506211250247`, -1.4448396190129813`, -4.974969290122672}, {
      2.5396830066508334`, -2.884529577873029, -4.973854106855433}, {
      2.030107633134731, -3.6027643538005374`, -6.220107590443057}}]}},
  Axes->True]], "Output",
 CellChangeTimes->{3.6810524273285227`*^9, 3.681052539307824*^9, 
  3.681052679464224*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Set Position Using Different Coordinate Systems", "Subsubsection",
 CellChangeTimes->{{3.6794062953388*^9, 3.6794063086951036`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"d", "=", 
   RowBox[{"X", "[", "\"\<CovalentBondLengths\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"X", "[", "\"\<PlaneRotationAngles\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"X", "[", "\"\<TorsionAngles\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{"SetPositionUsingCartesianSystem", "[", 
    RowBox[{"d", ",", "t", ",", "w"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"SetPositionUsingHomogeneousCoords", "[", 
    RowBox[{"d", ",", "t", ",", "w"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<S=\>\"", ",", "S"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<P=\>\"", ",", "P"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CalculateProteinAnglesForAtomAtPosition", "[", 
   RowBox[{"S", ",", "7"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CalculateProteinAnglesForAtomAtPosition", "[", 
   RowBox[{"P", ",", "8"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6793987045695095`*^9, 3.6793987140824037`*^9}, {
   3.6793988077473593`*^9, 3.679398910820831*^9}, 3.679403365459792*^9, {
   3.6794037427752213`*^9, 3.679403761930681*^9}, {3.6794038004309072`*^9, 
   3.679403807167263*^9}, {3.6794043087374773`*^9, 3.679404323245549*^9}, {
   3.6794043551722713`*^9, 3.6794043700379753`*^9}, {3.6794044728356934`*^9, 
   3.679404492302487*^9}, {3.6794045994142947`*^9, 3.67940460493628*^9}, {
   3.679404874108617*^9, 3.679404951631407*^9}, {3.6794052537841816`*^9, 
   3.679405308631333*^9}, 3.6794053456443725`*^9, {3.67940564264299*^9, 
   3.6794056486049147`*^9}, {3.679405741699015*^9, 3.679405742392773*^9}, {
   3.679406182549927*^9, 3.679406196506175*^9}, {3.6794063253031263`*^9, 
   3.6794064123489637`*^9}, {3.679406634125557*^9, 3.67940663702704*^9}, {
   3.6794067069580584`*^9, 3.679406732888578*^9}, {3.6794068473309193`*^9, 
   3.6794068484966364`*^9}, {3.6794070513742027`*^9, 3.679407100491548*^9}, {
   3.679407141288206*^9, 3.6794071715629845`*^9}, {3.679407250161986*^9, 
   3.679407252676136*^9}, {3.6794073278153877`*^9, 3.6794073829957857`*^9}, {
   3.679739870868251*^9, 3.679739871727892*^9}, {3.6797531093519835`*^9, 
   3.6797531194817133`*^9}, {3.6810525540653863`*^9, 3.6810525729632235`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"S=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.526`"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.0337555109089696`"}], ",", "1.4390484151485563`", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.5241785045443843`"}], ",", "2.1572837656628074`", ",", 
       RowBox[{"-", "1.246252484794385`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.033757142297638`"}], ",", "1.4371162838994704`", ",", 
       RowBox[{"-", "2.49138878663294`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.5260016299275458`"}], ",", 
       RowBox[{"-", "0.0019304007715190696`"}], ",", 
       RowBox[{"-", "2.4891574204098705`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.035577003443648`"}], ",", 
       RowBox[{"-", "0.7182318911089864`"}], ",", 
       RowBox[{"-", "1.241791750830077`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.5278214910735564`"}], ",", 
       RowBox[{"-", "2.157278575779975`"}], ",", 
       RowBox[{"-", "1.2395603846070082`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.037400128826811`"}], ",", 
       RowBox[{"-", "2.8774460575433114`"}], ",", 
       RowBox[{"-", "2.484696686445563`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.5278231224622258`"}], ",", 
       RowBox[{"-", "2.1592107070290605`"}], ",", 
       RowBox[{"-", "3.7309491712399474`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.0018247538508944228`"}], ",", 
       RowBox[{"-", "2.1611428382781472`"}], ",", 
       RowBox[{"-", "3.7298329882841177`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5077522525136908`", ",", 
       RowBox[{"-", "1.4429074877638959`"}], ",", 
       RowBox[{"-", "4.976085473078502`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.033750621125023`", ",", 
       RowBox[{"-", "1.4448396190129826`"}], ",", 
       RowBox[{"-", "4.974969290122672`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.539683006650831`", ",", 
       RowBox[{"-", "2.8845295778730304`"}], ",", 
       RowBox[{"-", "4.973854106855434`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.0301076331347283`", ",", 
       RowBox[{"-", "3.6027643538005383`"}], ",", 
       RowBox[{"-", "6.2201075904430585`"}]}], "}"}]}], "}"}]}],
  SequenceForm[
  "S=", {{0, 0, 
    0}, {-1.526, 0, 0}, {-2.0337555109089696`, 1.4390484151485563`, 
     0}, {-1.5241785045443843`, 
    2.1572837656628074`, -1.246252484794385}, {-2.033757142297638, 
    1.4371162838994704`, -2.49138878663294}, {-1.5260016299275458`, \
-0.0019304007715190696`, -2.4891574204098705`}, {-2.035577003443648, \
-0.7182318911089864, -1.241791750830077}, {-1.5278214910735564`, \
-2.157278575779975, -1.2395603846070082`}, {-2.037400128826811, \
-2.8774460575433114`, -2.484696686445563}, {-1.5278231224622258`, \
-2.1592107070290605`, -3.7309491712399474`}, {-0.0018247538508944228`, \
-2.1611428382781472`, -3.7298329882841177`}, {
    0.5077522525136908, -1.4429074877638959`, -4.976085473078502}, {
    2.033750621125023, -1.4448396190129826`, -4.974969290122672}, {
    2.539683006650831, -2.8845295778730304`, -4.973854106855434}, {
    2.0301076331347283`, -3.6027643538005383`, -6.2201075904430585`}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6810524483552217`*^9, {3.681052542588118*^9, 3.681052573660295*^9}, 
   3.6810526795232677`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"P=\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.526`"}], ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.0337555109089696`"}], ",", "1.4390484151485563`", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.5241785045443845`"}], ",", "2.1572837656628074`", ",", 
       RowBox[{"-", "1.246252484794385`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.033757142297638`"}], ",", "1.4371162838994702`", ",", 
       RowBox[{"-", "2.49138878663294`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.5260016299275454`"}], ",", 
       RowBox[{"-", "0.0019304007715184035`"}], ",", 
       RowBox[{"-", "2.4891574204098705`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.0355770034436476`"}], ",", 
       RowBox[{"-", "0.7182318911089862`"}], ",", 
       RowBox[{"-", "1.2417917508300764`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.527821491073555`"}], ",", 
       RowBox[{"-", "2.157278575779975`"}], ",", 
       RowBox[{"-", "1.2395603846070071`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2.0374001288268087`"}], ",", 
       RowBox[{"-", "2.8774460575433123`"}], ",", 
       RowBox[{"-", "2.484696686445562`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1.5278231224622236`"}], ",", 
       RowBox[{"-", "2.159210707029061`"}], ",", 
       RowBox[{"-", "3.7309491712399474`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.0018247538508919803`"}], ",", 
       RowBox[{"-", "2.161142838278147`"}], ",", 
       RowBox[{"-", "3.7298329882841172`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5077522525136928`", ",", 
       RowBox[{"-", "1.4429074877638954`"}], ",", 
       RowBox[{"-", "4.976085473078503`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.0337506211250247`", ",", 
       RowBox[{"-", "1.4448396190129813`"}], ",", 
       RowBox[{"-", "4.974969290122672`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.5396830066508334`", ",", 
       RowBox[{"-", "2.884529577873029`"}], ",", 
       RowBox[{"-", "4.973854106855433`"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2.030107633134731`", ",", 
       RowBox[{"-", "3.6027643538005374`"}], ",", 
       RowBox[{"-", "6.220107590443057`"}]}], "}"}]}], "}"}]}],
  SequenceForm[
  "P=", {{0, 0, 
    0}, {-1.526, 0, 0}, {-2.0337555109089696`, 1.4390484151485563`, 
     0}, {-1.5241785045443845`, 
    2.1572837656628074`, -1.246252484794385}, {-2.033757142297638, 
    1.4371162838994702`, -2.49138878663294}, {-1.5260016299275454`, \
-0.0019304007715184035`, -2.4891574204098705`}, {-2.0355770034436476`, \
-0.7182318911089862, -1.2417917508300764`}, {-1.527821491073555, \
-2.157278575779975, -1.2395603846070071`}, {-2.0374001288268087`, \
-2.8774460575433123`, -2.484696686445562}, {-1.5278231224622236`, \
-2.159210707029061, -3.7309491712399474`}, {-0.0018247538508919803`, \
-2.161142838278147, -3.7298329882841172`}, {
    0.5077522525136928, -1.4429074877638954`, -4.976085473078503}, {
    2.0337506211250247`, -1.4448396190129813`, -4.974969290122672}, {
    2.5396830066508334`, -2.884529577873029, -4.973854106855433}, {
    2.030107633134731, -3.6027643538005374`, -6.220107590443057}}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6810524483552217`*^9, {3.681052542588118*^9, 3.681052573660295*^9}, 
   3.6810526795272646`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Angle[BCD] =\"\>", "\[InvisibleSpace]", "1.91`"}],
  SequenceForm["Angle[BCD] =", 1.91],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6810524483552217`*^9, {3.681052542588118*^9, 3.681052573660295*^9}, 
   3.6810526795312676`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Angle[ABCD]=\"\>", "\[InvisibleSpace]", "1.0471975511965979`"}],
  SequenceForm["Angle[ABCD]=", 1.0471975511965979`],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6810524483552217`*^9, {3.681052542588118*^9, 3.681052573660295*^9}, 
   3.681052679534273*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Angle[BCD] =\"\>", "\[InvisibleSpace]", "1.9100000000000001`"}],
  SequenceForm["Angle[BCD] =", 1.9100000000000001`],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6810524483552217`*^9, {3.681052542588118*^9, 3.681052573660295*^9}, 
   3.6810526795367746`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"\<\"Angle[ABCD]=\"\>", "\[InvisibleSpace]", 
    "3.141592653589793`"}], "\[VeryThinSpace]", "-", 
   RowBox[{"2.1073424338879928`*^-8", " ", "\[ImaginaryI]"}]}],
  SequenceForm["Angle[ABCD]=", 
   Complex[3.141592653589793, -2.1073424338879928`*^-8]],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.6810524483552217`*^9, {3.681052542588118*^9, 3.681052573660295*^9}, 
   3.6810526795397778`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate Random DMDGP Instance", "Subsubsection",
 CellChangeTimes->{{3.679407510769739*^9, 3.679407522115453*^9}, 
   3.6798319122161026`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "M", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"M", "=", 
   RowBox[{"GenerateRandomDMDGPInstance", "[", 
    RowBox[{"7", ",", 
     RowBox[{"Dtol", "=", "3.0"}], ",", 
     RowBox[{"algorithm", "=", "\"\<DistanceMatrix\>\""}], ",", 
     RowBox[{"seed", "=", "1"}]}], "]"}]}], ";", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"G", "=", 
     RowBox[{"M", "[", "\"\<G\>\"", "]"}]}], ",", 
    RowBox[{"X", "=", 
     RowBox[{"M", "[", "\"\<X\>\"", "]"}]}]}], "}"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"{", 
  RowBox[{"G", ",", 
   RowBox[{"MatrixPlot", "[", 
    RowBox[{
     RowBox[{"GraphDistanceMatrix", "[", "G", "]"}], ",", 
     RowBox[{"ColorFunction", "\[Rule]", "\"\<Monochrome\>\""}]}], "]"}], ",",
    " ", 
   RowBox[{"Plot3DBackbone", "[", "X", "]"}]}], "}"}]}], "Input",
 CellChangeTimes->{
  3.679350281568641*^9, {3.6793503418859043`*^9, 3.6793503720521092`*^9}, {
   3.679350466576418*^9, 3.6793504789596534`*^9}, {3.6793505316493063`*^9, 
   3.679350533144163*^9}, {3.679392586310916*^9, 3.6793925872193985`*^9}, {
   3.67939730521247*^9, 3.6793973055760155`*^9}, {3.6794074757601814`*^9, 
   3.679407479794337*^9}, {3.679407534659811*^9, 3.6794075684004955`*^9}, {
   3.6795694018983793`*^9, 3.6795695468110123`*^9}, {3.679735147182562*^9, 
   3.679735162738102*^9}, {3.6798315901620045`*^9, 3.6798315955643563`*^9}, 
   3.6798319165363736`*^9, {3.679831960388562*^9, 3.6798319664981513`*^9}, {
   3.6798320290465565`*^9, 3.6798320405548406`*^9}, {3.6798320749511194`*^9, 
   3.679832079322584*^9}, {3.679832112464017*^9, 3.6798321175544796`*^9}, 
   3.679832159448175*^9, {3.679832378489052*^9, 3.6798324125404615`*^9}, {
   3.679832556647768*^9, 3.6798326872337575`*^9}, {3.679832755296446*^9, 
   3.679832786136928*^9}, {3.6798330083383417`*^9, 3.679833016907524*^9}, {
   3.6810526429808593`*^9, 3.6810526572953067`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   GraphicsBox[
    NamespaceBox["NetworkGraphics",
     DynamicModuleBox[{Typeset`graph = HoldComplete[
       Graph[{1, 2, 3, 4, 5, 6, 7}, {Null, 
         SparseArray[
         Automatic, {7, 7}, 0, {
          1, {{0, 2, 6, 11, 16, 21, 25, 28}, {{2}, {3}, {1}, {3}, {4}, {5}, {
            1}, {2}, {4}, {5}, {6}, {2}, {3}, {5}, {6}, {7}, {2}, {3}, {4}, {
            6}, {7}, {3}, {4}, {5}, {7}, {4}, {5}, {6}}}, Pattern}]}, {
        EdgeWeight -> {1.526, 2.491389535840226, 1.526, 2.491389535840226, 
          2.9206401036696796`, 1.5260000000000002`, 2.491389535840226, 
          2.9206401036696796`, 1.526, 2.4913895358402263`, 
          2.9206401036696796`, 1.5260000000000002`, 2.491389535840226, 
          1.526}}]]}, 
      TagBox[
       GraphicsGroupBox[
        GraphicsComplexBox[{{0., 0.560409850347722}, {0.9184854334566116, 
         0.054408256351048345`}, {1.1950595508028286`, 0.7437735371584835}, {
         1.916218107535511, 0.6914952852439853}, {2.0161025303774363`, 0.}, {
         2.4881031976214842`, 0.7757360808614635}, {3.0708357609809487`, 
         0.34730051873051887`}}, {
          {Hue[0.6, 0.7, 0.5], Opacity[0.7], 
           {Arrowheads[0.], ArrowBox[{1, 2}, 0.03074535887751026]}, 
           {Arrowheads[0.], ArrowBox[{1, 3}, 0.03074535887751026]}, 
           {Arrowheads[0.], ArrowBox[{2, 3}, 0.03074535887751026]}, 
           {Arrowheads[0.], ArrowBox[{2, 4}, 0.03074535887751026]}, 
           {Arrowheads[0.], ArrowBox[{2, 5}, 0.03074535887751026]}, 
           {Arrowheads[0.], ArrowBox[{3, 4}, 0.03074535887751026]}, 
           {Arrowheads[0.], ArrowBox[{3, 5}, 0.03074535887751026]}, 
           {Arrowheads[0.], ArrowBox[{3, 6}, 0.03074535887751026]}, 
           {Arrowheads[0.], ArrowBox[{4, 5}, 0.03074535887751026]}, 
           {Arrowheads[0.], ArrowBox[{4, 6}, 0.03074535887751026]}, 
           {Arrowheads[0.], ArrowBox[{4, 7}, 0.03074535887751026]}, 
           {Arrowheads[0.], ArrowBox[{5, 6}, 0.03074535887751026]}, 
           {Arrowheads[0.], ArrowBox[{5, 7}, 0.03074535887751026]}, 
           {Arrowheads[0.], ArrowBox[{6, 7}, 0.03074535887751026]}}, 
          {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], 
           DiskBox[1, 0.03074535887751026], DiskBox[2, 0.03074535887751026], 
           DiskBox[3, 0.03074535887751026], DiskBox[4, 0.03074535887751026], 
           DiskBox[5, 0.03074535887751026], DiskBox[6, 0.03074535887751026], 
           DiskBox[7, 0.03074535887751026]}}]],
       MouseAppearanceTag["NetworkGraphics"]],
      AllowKernelInitialization->False]],
    DefaultBaseStyle->{
     "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
    FormatType->TraditionalForm,
    FrameTicks->None], ",", 
   GraphicsBox[
    RasterBox[SparseArray[
     Automatic, {7, 7}, 1., {
      1, {{0, 6, 12, 18, 24, 30, 36, 42}, {{1}, {2}, {3}, {4}, {5}, {6}, {
        1}, {2}, {3}, {4}, {5}, {7}, {1}, {2}, {3}, {4}, {6}, {7}, {1}, {2}, {
        3}, {5}, {6}, {7}, {1}, {2}, {4}, {5}, {6}, {7}, {1}, {3}, {4}, {5}, {
        6}, {7}, {2}, {3}, {4}, {5}, {6}, {7}}}, CompressedData["
1:eJxTTMoPSmVkYGDQYhgF1AYAejYB1Q==
       "]}], {{0, 0}, {7, 7}}, {0, 1}],
    Frame->True,
    FrameLabel->{None, None},
    FrameTicks->{{{{6.5, 
         FormBox["1", TraditionalForm]}, {5.5, 
         FormBox["2", TraditionalForm]}, {4.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {2.5, 
         FormBox["5", TraditionalForm]}, {1.5, 
         FormBox["6", TraditionalForm]}, {0.5, 
         FormBox["7", TraditionalForm]}}, {{6.5, 
         FormBox["1", TraditionalForm]}, {5.5, 
         FormBox["2", TraditionalForm]}, {4.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {2.5, 
         FormBox["5", TraditionalForm]}, {1.5, 
         FormBox["6", TraditionalForm]}, {0.5, 
         FormBox["7", TraditionalForm]}}}, {{{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}}, {{0.5, 
         FormBox["1", TraditionalForm]}, {1.5, 
         FormBox["2", TraditionalForm]}, {2.5, 
         FormBox["3", TraditionalForm]}, {3.5, 
         FormBox["4", TraditionalForm]}, {4.5, 
         FormBox["5", TraditionalForm]}, {5.5, 
         FormBox["6", TraditionalForm]}, {6.5, 
         FormBox["7", TraditionalForm]}}}},
    GridLinesStyle->Directive[
      GrayLevel[0.5, 0.4]],
    Method->{
     "AxisPadding" -> Scaled[0.02], "DefaultBoundaryStyle" -> Automatic, 
      "DefaultPlotStyle" -> Automatic, "DomainPadding" -> Scaled[0.02], 
      "RangePadding" -> Scaled[0.05]}], ",", 
   Graphics3DBox[{
     Line3DBox[{{0, 0, 
       0}, {-1.526, 0, 0}, {-2.0337555109089696`, 1.4390484151485563`, 
        0}, {-3.55975551090897, 1.4390484151485563`, 0.}, {-4.067511021817939,
        0.7195242075742782, 1.246252484794385}, {-3.557934015453354, 
       1.4396928436785696`, 2.49138878663294}, {-4.067512653206608, 
       2.878096253126635, 2.4902736033657007`}}], 
     {RGBColor[0, 0, 1], PointSize[Large], 
      Point3DBox[{{0, 0, 
        0}, {-1.526, 0, 0}, {-2.0337555109089696`, 1.4390484151485563`, 
         0}, {-3.55975551090897, 1.4390484151485563`, 
        0.}, {-4.067511021817939, 0.7195242075742782, 
        1.246252484794385}, {-3.557934015453354, 1.4396928436785696`, 
        2.49138878663294}, {-4.067512653206608, 2.878096253126635, 
        2.4902736033657007`}}]}},
    Axes->True]}], "}"}]], "Output",
 CellChangeTimes->{
  3.679832723143999*^9, {3.6798327675232363`*^9, 3.6798327868063793`*^9}, 
   3.6798328523773947`*^9, {3.6798329747584*^9, 3.679833017523157*^9}, 
   3.6799120230507717`*^9, 3.6802498004595013`*^9, 3.6802650768975334`*^9, 
   3.680884929076393*^9, 3.680888052759701*^9, 3.6808888109690638`*^9, 
   3.6809606291392126`*^9, 3.680960689564831*^9, 3.6809710062338395`*^9, 
   3.6809745200346155`*^9, 3.6809779801796703`*^9, 3.681037966996437*^9, 
   3.6810525821654034`*^9, {3.6810526258507357`*^9, 3.6810526796183314`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Timing", "Subsubsection",
 CellChangeTimes->{{3.6797384400638847`*^9, 3.679738449164445*^9}, {
  3.6797531924783444`*^9, 3.6797531931477766`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Comparison", " ", "between", " ", "HomogeneousCoords", " ", "and", " ", 
    "CartesianSystem", " ", "algorithms"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Time(HomogeneousCoords)=\>\"", ",", 
      RowBox[{"First", "[", 
       RowBox[{"Timing", "[", 
        RowBox[{"Timing", "[", 
         RowBox[{"GenerateRandom3DBackbone", "[", 
          RowBox[{"1000", ",", "\"\<HomogeneousCoords\>\""}], "]"}], "]"}], 
        "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Print", "[", 
     RowBox[{"\"\<Time(CartesianSystem)=\>\"", ",", 
      RowBox[{"First", "[", 
       RowBox[{"Timing", "[", 
        RowBox[{"Timing", "[", 
         RowBox[{"GenerateRandom3DBackbone", "[", 
          RowBox[{"1000", ",", "\"\<CartesianSystem\>\""}], "]"}], "]"}], 
        "]"}], "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.679736995861993*^9, 3.679737108374234*^9}, {
   3.679737170416292*^9, 3.6797371881758313`*^9}, {3.6797374175247035`*^9, 
   3.6797374296543937`*^9}, {3.6797375077969713`*^9, 
   3.6797375083972406`*^9}, {3.679737567606184*^9, 3.679737587564953*^9}, 
   3.679737618559945*^9, {3.679737756677066*^9, 3.679737876465124*^9}, {
   3.679737921117589*^9, 3.679737947602236*^9}, {3.6797379783729334`*^9, 
   3.6797380132961597`*^9}, 3.679738215629839*^9, 3.679738272251295*^9, {
   3.6797383083382792`*^9, 3.6797383371093683`*^9}, {3.679738408861701*^9, 
   3.6797384185301433`*^9}, {3.67973875610773*^9, 3.6797387587133164`*^9}, {
   3.679739228813849*^9, 3.679739228937063*^9}, {3.6797395758387523`*^9, 
   3.6797395858278775`*^9}, {3.6797396623072777`*^9, 3.67973969363463*^9}, {
   3.679739994261594*^9, 3.67974008736335*^9}, {3.679740123268535*^9, 
   3.67974013272523*^9}, {3.6797401744831133`*^9, 3.6797403252268763`*^9}, {
   3.6797403613964577`*^9, 3.6797403727872944`*^9}, {3.6797404135477304`*^9, 
   3.6797404208132915`*^9}, {3.679740456195278*^9, 3.6797404762483387`*^9}, {
   3.6797406069977407`*^9, 3.6797406453138895`*^9}, {3.6797406838694105`*^9, 
   3.6797406923179336`*^9}, {3.6797528762915554`*^9, 3.679753003347789*^9}, {
   3.6797532038724775`*^9, 3.679753210593068*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Estimating", " ", "complexity", " ", "of", " ", "random", " ", "backbone",
     " ", "generation"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", "x", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"tp", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", 
         RowBox[{"First", "[", 
          RowBox[{"Timing", "[", 
           RowBox[{"GenerateRandom3DBackbone", "[", 
            RowBox[{"n", ",", "\"\<HomogeneousCoords\>\""}], "]"}], "]"}], 
          "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "100", ",", "10000", ",", "100"}], "}"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"fp", "=", 
     RowBox[{"Fit", "[", 
      RowBox[{"tp", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "x"}], "}"}], ",", "x"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Show", "[", 
     RowBox[{
      RowBox[{"ListPlot", "[", "tp", "]"}], ",", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"{", "fp", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "100", ",", "10000"}], "}"}]}], "]"}], ",", 
      RowBox[{"AxesLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"HoldForm", "[", 
          RowBox[{"Problem", " ", "Size"}], "]"}], ",", 
         RowBox[{"HoldForm", "[", 
          RowBox[{"Time", " ", "in", " ", "Seconds"}], "]"}]}], "}"}]}], ",", 
      RowBox[{"PlotLabel", "\[Rule]", 
       RowBox[{"HoldForm", "[", "GenerateRandom3DBackbone", "]"}]}], ",", 
      RowBox[{"LabelStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"GrayLevel", "[", "0", "]"}], "}"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "*)"}]}]], "Input",
 CellChangeTimes->{{3.6797384729463034`*^9, 3.679738475425184*^9}, {
   3.679738516700796*^9, 3.679738544680171*^9}, {3.6797385852697315`*^9, 
   3.6797387966542225`*^9}, {3.6797388310657253`*^9, 3.679738847322424*^9}, {
   3.679740708910391*^9, 3.679740892171446*^9}, {3.6797527150228705`*^9, 
   3.6797527942870846`*^9}, {3.67975284721195*^9, 3.679752868802577*^9}, 
   3.6797532155000467`*^9, 3.6799177101688576`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Estimating", " ", "complexity", " ", "of", " ", "distance", " ", 
    "calculation", " ", "algorithms", " ", "in", " ", 
    "GenerateRandomDMDGPInstance", " ", "function"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"numberOfAtoms", "=", 
    RowBox[{"50", "\[IndentingNewLine]", 
     RowBox[{"First", "[", 
      RowBox[{"Timing", "[", 
       RowBox[{"M", "=", 
        RowBox[{"GenerateRandomDMDGPInstance", "[", 
         RowBox[{"numberOfAtoms", ",", 
          RowBox[{"Dtol", "=", "5.0"}], ",", 
          RowBox[{"algorithm", "=", "\"\<Nearest\>\""}]}], "]"}]}], "]"}], 
      "]"}], "\[IndentingNewLine]", 
     RowBox[{"First", "[", 
      RowBox[{"Timing", "[", 
       RowBox[{"M", "=", 
        RowBox[{"GenerateRandomDMDGPInstance", "[", 
         RowBox[{"numberOfAtoms", ",", 
          RowBox[{"Dtol", "=", "5.0"}], ",", 
          RowBox[{"algorithm", "=", "\"\<DistanceMatrix\>\""}]}], "]"}]}], 
       "]"}], "]"}]}]}], "\[IndentingNewLine]", "*)"}]}]], "Input",
 CellChangeTimes->{{3.679917720141371*^9, 3.6799177515681624`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["MDGP Solvers", "Section",
 CellChangeTimes->{{3.6795571036686206`*^9, 3.679557113728629*^9}}],

Cell[CellGroupData[{

Cell["Source Code", "Subsection",
 CellChangeTimes->{{3.679557165643343*^9, 3.6795571685082006`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "BPPlotEstimatedComplexity", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BPGetNodePosition", "[", 
     RowBox[{"G_", ",", "X_", ",", "i_", ",", "branch_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "j", ",", "u", ",", "v", ",", "a", ",", "b", ",", "c", ",", "delta", 
        ",", "dy", ",", "dz", ",", "dw", ",", "ky", ",", "kz", ",", "kw", ",",
         "A", ",", "x3", ",", "y", ",", "z", ",", "w"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"y", ",", "z", ",", "w"}], "}"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"[", 
            RowBox[{"i", "-", "j"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dy", ",", "dz", ",", "dw"}], "}"}], "=", 
        RowBox[{"GetEdgeWeight", "[", 
         RowBox[{"G", ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"i", "\[UndirectedEdge]", 
             RowBox[{"(", 
              RowBox[{"i", "-", "j"}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "3"}], "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ky", ",", "kz", ",", "kw"}], "}"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"dy", "^", "2"}], "-", 
           RowBox[{"y", ".", "y"}]}], ",", 
          RowBox[{
           RowBox[{"dz", "^", "2"}], "-", 
           RowBox[{"z", ".", "z"}]}], ",", 
          RowBox[{
           RowBox[{"dw", "^", "2"}], "-", 
           RowBox[{"w", ".", "w"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"set", " ", 
          RowBox[{"x", "[", 
           RowBox[{"1", ":", "2"}], "]"}]}], "=", 
         RowBox[{
          RowBox[{"u", "*", 
           RowBox[{"x", "[", "3", "]"}]}], "+", "v"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"A", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], "-", 
           RowBox[{"z", "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"y", "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], "-", 
           RowBox[{"w", "[", 
            RowBox[{"[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}]}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"u", "=", 
        RowBox[{"LinearSolve", "[", 
         RowBox[{"A", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"z", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "-", 
             RowBox[{"y", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"w", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "-", 
             RowBox[{"y", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"v", "=", 
        RowBox[{"LinearSolve", "[", 
         RowBox[{"A", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"kz", "-", "ky"}], ")"}], "/", "2"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"kw", "-", "ky"}], ")"}], "/", "2"}]}], "}"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"set", "/", "solve"}], " ", "the", " ", "quadratic", " ", 
         "equation"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"u", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"u", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"u", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "1"}], "}"}]}], ";", 
       RowBox[{"v", "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"v", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"v", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", "0"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"a", "=", 
        RowBox[{"u", ".", "u"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"b", "=", 
        RowBox[{"2", "*", 
         RowBox[{"(", 
          RowBox[{"u", ".", 
           RowBox[{"(", 
            RowBox[{"v", "-", "y"}], ")"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"c", "=", 
        RowBox[{
         RowBox[{"v", ".", 
          RowBox[{"(", 
           RowBox[{"v", "-", 
            RowBox[{"2", "*", "y"}]}], ")"}]}], "-", "ky"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "the", " ", "free", " ", "coordinate"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"x3", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "b"}], "-", 
           RowBox[{"Sqrt", "[", 
            RowBox[{
             RowBox[{"b", "^", "2"}], "-", 
             RowBox[{"4", "*", "a", "*", "c"}]}], "]"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", "a"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"branch", "\[Equal]", "1"}], ",", 
         RowBox[{"x3", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "b"}], "/", "a"}], ")"}], "-", "x3"}]}]}], "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "output"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"u", "*", "x3"}], "+", "v"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BPSolver", "[", "G_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"local", " ", "variables"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "j", ",", "tABC", ",", "dAB", ",", "dAC", ",", "dBC", ",", 
        "numberOfAtoms", ",", "prune", ",", "node", ",", "branch", ",", "X", 
        ",", "S", ",", "work", ",", 
        RowBox[{"tol", "=", "0.001"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"numberOfAtoms", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"VertexList", "[", "G", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "check", " ", "if", " ", "natural", " ", "order", " ", "is", " ", 
         "valid"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Not", "[", 
          RowBox[{"IsNaturalOrderValid", "[", "G", "]"}], "]"}], ",", 
         RowBox[{"Throw", "[", "\"\<InvalidOrdering\>\"", "]"}]}], "]"}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "init", " ", "atoms", " ", "positions", " ", "on", " ", "Euclidean", 
         " ", "3", "d", " ", "space"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"X", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"dAB", ",", "dAC", ",", "dBC"}], "}"}], "=", 
        RowBox[{"GetEdgeWeight", "[", 
         RowBox[{"G", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"1", "\[UndirectedEdge]", "2"}], ",", 
            RowBox[{"1", "\[UndirectedEdge]", "3"}], ",", 
            RowBox[{"2", "\[UndirectedEdge]", "3"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "planar", " ", "rotation", " ", "angle", " ", "for", " ", "third", 
         " ", "atom"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tABC", "=", 
        RowBox[{"ArcCos", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dAB", "^", "2"}], "+", 
            RowBox[{"dBC", "^", "2"}], "-", 
            RowBox[{"dAC", "^", "2"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", "*", "dAB", "*", "dBC"}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "set", " ", "the", " ", "position", " ", "of", " ", "the", " ", 
         "three", " ", "first", " ", "points"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}], "=", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "dAB"}], ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "dAB"}], "+", 
             RowBox[{"dBC", "*", 
              RowBox[{"Cos", "[", "tABC", "]"}]}]}], ",", 
            RowBox[{"dBC", "*", 
             RowBox[{"Sin", "[", "tABC", "]"}]}], " ", ",", "0"}], "}"}]}], 
         "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"init", " ", "BPTree"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"branch", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"branch", "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}], "=", 
          "1"}]}], "}"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"node", "=", "3"}], ",", 
         RowBox[{"prune", "=", "False"}]}], "}"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"work", "=", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ",", 
         RowBox[{
          RowBox[{"work", "[", 
           RowBox[{"[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "2", ",", "3"}], "}"}], "]"}], "]"}], "=", 
          "1"}]}], "}"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"BP", " ", "core"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<Points\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"\"\<Branches\>\"", "\[Rule]", 
           RowBox[{"{", "}"}]}]}], "|>"}]}], ";", " ", 
       RowBox[{"(*", " ", "solutions", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{"True", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"go", " ", "to", " ", "next", " ", "node"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"prune", "||", " ", 
             RowBox[{"node", "\[Equal]", "numberOfAtoms"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "if", " ", "pruned", " ", "or", " ", "last", " ", "node"}], ",",
               " ", 
              RowBox[{
              "search", " ", "for", " ", "a", " ", "node", " ", "to", " ", 
               "branch"}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"i", "=", "node"}], ";", " ", 
             RowBox[{"prune", "=", "False"}], ";", "\[IndentingNewLine]", 
             RowBox[{"While", "[", 
              RowBox[{
               RowBox[{"i", ">", "0"}], ",", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"branch", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"branch", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "=", "1"}], ";", 
                   RowBox[{"Break", "[", "]"}]}]}], "]"}], ";", 
                RowBox[{"i", "--"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{
              "there", " ", "is", " ", "no", " ", "next", " ", "node"}], " ", 
              "*)"}], "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"i", "\[Equal]", "0"}], ",", 
               RowBox[{"Break", "[", "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"reset", " ", "lower", " ", 
               RowBox[{"(", 
                RowBox[{"until", " ", "k"}], ")"}], " ", "tree", " ", 
               "levels"}], " ", "*)"}], "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"j", "=", 
                RowBox[{"i", "+", "1"}]}], ",", 
               RowBox[{"j", "\[LessEqual]", "node"}], ",", 
               RowBox[{"j", "++"}], ",", 
               RowBox[{
                RowBox[{"branch", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "=", "0"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"node", "=", "i"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{
              "if", " ", "not", " ", "pruned", " ", "nor", " ", "last", " ", 
               "node"}], ",", " ", 
              RowBox[{
              "just", " ", "go", " ", "to", " ", "the", " ", "child", " ", 
               "node"}]}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"node", "++"}]}], "\[IndentingNewLine]", "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"calculate", " ", "position", " ", "of", " ", "i"}], "-", 
            RowBox[{"th", " ", "node"}]}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"work", "[", 
            RowBox[{"[", "node", "]"}], "]"}], "++"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{"[", "node", "]"}], "]"}], "=", 
           RowBox[{"BPGetNodePosition", "[", 
            RowBox[{"G", ",", "X", ",", "node", ",", 
             RowBox[{"branch", "[", 
              RowBox[{"[", "node", "]"}], "]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "prune", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"CalculatePartialSolutionError", "[", 
              RowBox[{"G", ",", "X", ",", "node"}], "]"}], ">", "tol"}], ",", 
            RowBox[{
             RowBox[{"prune", "=", "True"}], ";", 
             RowBox[{"Continue", "[", "]"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"new", " ", "solution", " ", "found"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"node", "\[Equal]", "numberOfAtoms"}], ",", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{
               RowBox[{"S", "[", "\"\<Points\>\"", "]"}], ",", "X"}], "]"}], 
             ";", 
             RowBox[{"AppendTo", "[", 
              RowBox[{
               RowBox[{"S", "[", "\"\<Branches\>\"", "]"}], ",", "branch"}], 
              "]"}]}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<A total of \>\"", ",", " ", 
         RowBox[{"Length", "[", "S", "]"}], ",", 
         "\"\< solutions has been found.\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"S", ",", "work"}], "}"}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BPPlotEstimatedComplexity", "[", "G_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"local", " ", "variables"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "numberOfAtoms", ",", "i", ",", "j", ",", "k", ",", "work", ",", 
       "choices", ",", "V", ",", "R", ",", "reduced"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "[", 
         RowBox[{"IsNaturalOrderValid", "[", "G", "]"}], "]"}], ",", 
        RowBox[{"Throw", "[", "\"\<InvalidOrdering\>\"", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"numberOfAtoms", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"VertexList", "[", "G", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"work", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"1", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"work", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "=", "2"}]}], "}"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"choices", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"Infinity", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"choices", "[", 
          RowBox[{"[", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], "]"}], "]"}], 
         "=", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", "1", ",", "2"}], "}"}]}]}], "}"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "5"}], ",", 
        RowBox[{"i", "\[LessEqual]", "numberOfAtoms"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "only", " ", "edges", " ", "with", " ", "precedent", " ", 
          "vertices"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"V", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"AdjacencyList", "[", 
             RowBox[{"G", ",", "i"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#", "<", "i"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"work", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"2", "*", 
           RowBox[{"choices", "[", 
            RowBox[{"[", 
             RowBox[{"i", "-", "1"}], "]"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "V", "]"}], "<", "4"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "there", " ", "is", " ", "no", " ", "additional", " ", 
             "constraint"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"choices", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "=", 
            RowBox[{"work", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "take", " ", "the", " ", "four", " ", "most", " ", "restrictive", 
             " ", "constraints"}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"R", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"choices", "[", 
                RowBox[{"[", 
                 RowBox[{"V", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", 
                 RowBox[{"Length", "[", "V", "]"}]}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"minimal", " ", "number", " ", "of", " ", "choices"}], 
             " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"k", "=", 
             RowBox[{"RankedMin", "[", 
              RowBox[{"R", ",", "4"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "minimal", " ", "index", " ", "with", " ", "minimal", " ", 
              "number", " ", "of", " ", "choices"}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"k", "=", 
             RowBox[{"Min", "[", 
              RowBox[{"Select", "[", 
               RowBox[{"V", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"choices", "[", 
                    RowBox[{"[", "#", "]"}], "]"}], "\[Equal]", "k"}], ")"}], 
                 "&"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "update", " ", "intermediate", " ", "number", " ", "of", " ", 
              "choices"}], " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"j", "=", 
               RowBox[{"(", 
                RowBox[{"k", "+", "1"}], ")"}]}], ",", 
              RowBox[{"j", "\[LessEqual]", "i"}], ",", 
              RowBox[{"j", "++"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"choices", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ">", 
                 RowBox[{"choices", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"choices", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "=", 
                 RowBox[{"choices", "[", 
                  RowBox[{"[", "k", "]"}], "]"}]}]}], "]"}]}], "]"}], ";"}]}],
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Estimated number of Solutions \>\"", ",", 
        RowBox[{"choices", "[", 
         RowBox[{"[", "numberOfAtoms", "]"}], "]"}], ",", "\"\<.\>\""}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"ListLinePlot", "[", 
       RowBox[{"work", ",", 
        RowBox[{"Filling", "\[Rule]", "Axis"}], ",", " ", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"{", "\"\<Estimated\>\"", "}"}]}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.679558175961939*^9, 3.6795582465756893`*^9}, {
   3.6795582826425705`*^9, 3.6795582839429235`*^9}, {3.6795657231676226`*^9, 
   3.6795657791530952`*^9}, {3.6795658130773067`*^9, 3.679565871544673*^9}, {
   3.6795861090630603`*^9, 3.679586268296414*^9}, {3.6795863005452967`*^9, 
   3.679586495840868*^9}, {3.6795865460918303`*^9, 3.6795865970915422`*^9}, {
   3.6795868432394185`*^9, 3.6795869018284483`*^9}, {3.679586939131709*^9, 
   3.679586976913601*^9}, {3.6795870626458464`*^9, 3.6795871011073523`*^9}, {
   3.6795871633176947`*^9, 3.679587758105817*^9}, {3.679587804838523*^9, 
   3.6795878406799817`*^9}, {3.6795881298229246`*^9, 3.679588139590253*^9}, {
   3.679588432141921*^9, 3.679588820678732*^9}, {3.67958885218464*^9, 
   3.679588859454245*^9}, {3.679591543221243*^9, 3.6795916551338434`*^9}, {
   3.679591702248043*^9, 3.679591773731745*^9}, {3.6795919722830153`*^9, 
   3.6795919729205785`*^9}, {3.6795920143454957`*^9, 
   3.6795920373721275`*^9}, {3.6795920942295294`*^9, 3.679592111174794*^9}, {
   3.6795921457433033`*^9, 3.6795921895011177`*^9}, {3.6795922813103876`*^9, 
   3.6795922980595803`*^9}, {3.679592407947278*^9, 3.6795924086627626`*^9}, {
   3.6795924498624945`*^9, 3.679592466754154*^9}, {3.679592757750784*^9, 
   3.679592801039822*^9}, {3.679592909747943*^9, 3.6795929608876143`*^9}, {
   3.679593939143162*^9, 3.6795940165402756`*^9}, {3.679594087903904*^9, 
   3.6795941883419476`*^9}, {3.679594287225954*^9, 3.6795943875196476`*^9}, {
   3.679594448595685*^9, 3.679594478828597*^9}, {3.6795945652724648`*^9, 
   3.6795946280032177`*^9}, {3.6795946789134407`*^9, 
   3.6795947026597376`*^9}, {3.679594776154107*^9, 3.6795948130815954`*^9}, {
   3.679594874794201*^9, 3.6795948828190813`*^9}, {3.6795949534488997`*^9, 
   3.6795949725060587`*^9}, {3.6795953069724016`*^9, 3.679595386091648*^9}, {
   3.6795955639765224`*^9, 3.6795956274997435`*^9}, {3.679595702271488*^9, 
   3.6795959233026123`*^9}, {3.679595965972151*^9, 3.6795959811159763`*^9}, {
   3.679596019161744*^9, 3.6795961007578773`*^9}, {3.679596138153123*^9, 
   3.679596343165894*^9}, {3.6795963808982925`*^9, 3.679596485412173*^9}, {
   3.679596522566841*^9, 3.6795965922679443`*^9}, {3.6795966325388813`*^9, 
   3.6795966980857244`*^9}, {3.679596732170254*^9, 3.679596952279262*^9}, {
   3.6795970019970694`*^9, 3.6795970768712177`*^9}, {3.679597120771289*^9, 
   3.679597123641965*^9}, {3.679597504661482*^9, 3.67959752405188*^9}, {
   3.6795977558745494`*^9, 3.679597791424835*^9}, 3.6795987087156878`*^9, {
   3.6795988192242517`*^9, 3.67959883584793*^9}, {3.679598870164411*^9, 
   3.6795991011240025`*^9}, {3.679599318938053*^9, 3.679599340969948*^9}, {
   3.6795993740469303`*^9, 3.679599392408225*^9}, {3.679599446418444*^9, 
   3.6795994936803236`*^9}, {3.6795995268675137`*^9, 3.6795995571197987`*^9}, 
   3.679599593529305*^9, {3.6795996462842827`*^9, 3.679599664667951*^9}, 
   3.6796000535012045`*^9, {3.6796005685888577`*^9, 3.6796006406104794`*^9}, {
   3.679600696928871*^9, 3.6796007267160053`*^9}, {3.6796008413370132`*^9, 
   3.6796008545284967`*^9}, {3.6796009031430583`*^9, 
   3.6796009310933266`*^9}, {3.6796010302991343`*^9, 3.67960105103058*^9}, {
   3.679601123591203*^9, 3.6796011690061445`*^9}, {3.6796012042311897`*^9, 
   3.6796012284117613`*^9}, {3.6796013171753454`*^9, 
   3.6796013538183103`*^9}, {3.679678803727684*^9, 3.6796788489988422`*^9}, {
   3.6796789029728556`*^9, 3.679678973714923*^9}, {3.679679007940275*^9, 
   3.6796790171013775`*^9}, {3.6796791140754843`*^9, 3.679679297244875*^9}, {
   3.679679330413969*^9, 3.6796793579806814`*^9}, {3.6796794551957006`*^9, 
   3.6796794760541725`*^9}, {3.679679575327817*^9, 3.6796796729758596`*^9}, {
   3.679679868010354*^9, 3.6796800326147842`*^9}, {3.6796800872006283`*^9, 
   3.679680109202219*^9}, {3.6796801598977137`*^9, 3.679680170399706*^9}, {
   3.679680211818449*^9, 3.6796804482737713`*^9}, {3.6796805112298536`*^9, 
   3.6796805744565773`*^9}, {3.6796806218580914`*^9, 3.679680757892975*^9}, {
   3.679680811495949*^9, 3.6796808818651915`*^9}, {3.6796809144827785`*^9, 
   3.6796809666833677`*^9}, {3.6796810029485235`*^9, 
   3.6796810081740055`*^9}, {3.6796810575156417`*^9, 
   3.6796811033995237`*^9}, {3.679681332527998*^9, 3.6796813333625546`*^9}, {
   3.6796813807917876`*^9, 3.67968147752941*^9}, {3.679681563739986*^9, 
   3.6796815769607897`*^9}, {3.6796817221757703`*^9, 3.679681763490862*^9}, {
   3.679681838781067*^9, 3.6796818408804646`*^9}, {3.6796818894447145`*^9, 
   3.679682079969407*^9}, {3.679682121825989*^9, 3.6796821248530035`*^9}, {
   3.679682265526948*^9, 3.679682306277526*^9}, {3.6796823673326397`*^9, 
   3.679682384445038*^9}, {3.6796824443186035`*^9, 3.679682475464719*^9}, {
   3.6796825288595295`*^9, 3.6796825637327585`*^9}, {3.67968278119676*^9, 
   3.679682782882883*^9}, {3.6797345890383964`*^9, 3.6797346061187067`*^9}, {
   3.679734645268098*^9, 3.679734678069255*^9}, {3.679734719550336*^9, 
   3.679734728336152*^9}, {3.679734851985812*^9, 3.6797348613539844`*^9}, {
   3.6797349632167463`*^9, 3.6797349754570136`*^9}, {3.679735010318187*^9, 
   3.679735089425761*^9}, {3.6797352029473877`*^9, 3.6797352174003067`*^9}, {
   3.679735334219095*^9, 3.6797353520668097`*^9}, {3.6797354127852964`*^9, 
   3.6797354225972743`*^9}, {3.6797356146960435`*^9, 3.6797356233076*^9}, {
   3.679735670171296*^9, 3.679735748032075*^9}, {3.679735818469843*^9, 
   3.679735848457308*^9}, {3.67973596027987*^9, 3.679735975920292*^9}, {
   3.6797360359884872`*^9, 3.679736087721181*^9}, {3.6797362491591873`*^9, 
   3.679736251571519*^9}, {3.6797363112665663`*^9, 3.67973638863768*^9}, {
   3.6797365176603727`*^9, 3.679736520301809*^9}, {3.679736670119876*^9, 
   3.6797367431527596`*^9}, {3.679756482791448*^9, 3.679756557876812*^9}, {
   3.6797567570184045`*^9, 3.6797567594612527`*^9}, {3.6797567906860046`*^9, 
   3.679756802275606*^9}, {3.6797568773893633`*^9, 3.679756886271783*^9}, {
   3.679757001405609*^9, 3.6797570054216137`*^9}, {3.679757180744531*^9, 
   3.6797572214769106`*^9}, {3.6797572539267645`*^9, 
   3.6797572552707305`*^9}, {3.679757302135573*^9, 3.679757309602027*^9}, {
   3.6797576159368067`*^9, 3.679757640960533*^9}, {3.6797577488837395`*^9, 
   3.6797577653388815`*^9}, {3.6797577958104706`*^9, 3.679757803108025*^9}, {
   3.6797578760871897`*^9, 3.6797578901608458`*^9}, {3.679758056388175*^9, 
   3.679758057856022*^9}, {3.679758116808442*^9, 3.679758142175377*^9}, {
   3.6797583149135833`*^9, 3.679758607202947*^9}, {3.679758663127587*^9, 
   3.6797586884288898`*^9}, {3.679759119373311*^9, 3.679759252843992*^9}, {
   3.679760070123723*^9, 3.679760141715478*^9}, {3.6797601874366446`*^9, 
   3.67976021978776*^9}, {3.679761268846787*^9, 3.6797613467221656`*^9}, {
   3.6797613820967917`*^9, 3.679761404174221*^9}, {3.6797614488257165`*^9, 
   3.6797615135316324`*^9}, {3.6797616958144684`*^9, 3.679761727076391*^9}, {
   3.6797629611339755`*^9, 3.6797630599393997`*^9}, {3.6797632969326744`*^9, 
   3.6797633450875072`*^9}, {3.6797633864858117`*^9, 3.679763417622408*^9}, {
   3.679763454154428*^9, 3.679763458232932*^9}, {3.679763559460507*^9, 
   3.679763559766924*^9}, {3.67976360142772*^9, 3.679763602011773*^9}, {
   3.679763652514624*^9, 3.6797636554635086`*^9}, {3.6797636883303623`*^9, 
   3.6797636933229237`*^9}, {3.679763739648059*^9, 3.6797637500153637`*^9}, {
   3.6797638017358065`*^9, 3.679763821403262*^9}, {3.6797639540004077`*^9, 
   3.679763967875004*^9}, {3.679764012996402*^9, 3.679764053151238*^9}, {
   3.679764105585392*^9, 3.6797641333006964`*^9}, {3.679764241169329*^9, 
   3.6797642550419507`*^9}, {3.6797642965486746`*^9, 
   3.6797642974911604`*^9}, {3.679766312258819*^9, 3.6797663400081835`*^9}, {
   3.6797665204820805`*^9, 3.6797666179276123`*^9}, {3.6797666878843207`*^9, 
   3.679766700259632*^9}, 3.679766730824309*^9, {3.67976678431518*^9, 
   3.6797667911152844`*^9}, {3.679766899700026*^9, 3.6797669126934752`*^9}, {
   3.6797669454005632`*^9, 3.679766965008849*^9}, {3.6797670469007864`*^9, 
   3.6797670576985207`*^9}, {3.679767112514214*^9, 3.6797671303351617`*^9}, {
   3.6797675537044563`*^9, 3.6797676224830623`*^9}, {3.679767976648643*^9, 
   3.6797680158816223`*^9}, {3.679768074496215*^9, 3.6797680775963783`*^9}, {
   3.6797683593332515`*^9, 3.6797683759920163`*^9}, {3.6797689343634205`*^9, 
   3.67976894926108*^9}, {3.679769294256039*^9, 3.679769332344527*^9}, {
   3.6798191469974074`*^9, 3.679819160356634*^9}, 3.6798192106398354`*^9, {
   3.67981926129202*^9, 3.679819264210451*^9}, {3.6798201118432903`*^9, 
   3.6798201155779047`*^9}, {3.679820335384288*^9, 3.679820377209854*^9}, {
   3.679820499748266*^9, 3.679820500648081*^9}, {3.6798205849449463`*^9, 
   3.679820599020897*^9}, {3.679820651543778*^9, 3.679820717123869*^9}, 
   3.6798208645536685`*^9, {3.679820946173946*^9, 3.6798209585549765`*^9}, {
   3.6798211650566034`*^9, 3.679821179641118*^9}, {3.6798212774784584`*^9, 
   3.6798212833238792`*^9}, {3.6798215653792295`*^9, 3.67982157108221*^9}, {
   3.679821616893424*^9, 3.679821653145285*^9}, {3.6798222987882447`*^9, 
   3.6798223432753534`*^9}, 3.679822416580861*^9, {3.679822823372448*^9, 
   3.6798228417201242`*^9}, {3.679823267991959*^9, 3.6798232844684114`*^9}, {
   3.679826381840706*^9, 3.67982643359863*^9}, 3.6798265156658287`*^9, {
   3.6798266225012636`*^9, 3.679826673734756*^9}, {3.679826743782586*^9, 
   3.679826770138029*^9}, {3.6798288730382085`*^9, 3.6798288749212675`*^9}, 
   3.679830925818262*^9, {3.6799122356862607`*^9, 3.679912420141233*^9}, 
   3.679912621838517*^9, {3.679912660005648*^9, 3.6799127645180964`*^9}, {
   3.679912796764311*^9, 3.679912833673414*^9}, {3.679912923419185*^9, 
   3.6799130110394573`*^9}, {3.6799132053019743`*^9, 
   3.6799132383140087`*^9}, {3.6799132802516465`*^9, 3.67991331943956*^9}, {
   3.679913510472663*^9, 3.6799136126746993`*^9}, {3.6799143039934287`*^9, 
   3.679914498499134*^9}, {3.6799146006025815`*^9, 3.679914665572703*^9}, {
   3.6799147788339305`*^9, 3.6799147832198434`*^9}, {3.679915529268517*^9, 
   3.6799155521864934`*^9}, {3.6799163694288054`*^9, 
   3.6799163759577293`*^9}, {3.679916633719616*^9, 3.6799166874558907`*^9}, {
   3.6799167701444783`*^9, 3.6799167738622227`*^9}, {3.6799168079043493`*^9, 
   3.6799168533126335`*^9}, {3.679916959985268*^9, 3.6799169731612396`*^9}, 
   3.6799170200748706`*^9, {3.6799171302212915`*^9, 3.679917141185356*^9}, {
   3.679917187615794*^9, 3.6799171931360073`*^9}, {3.679917338879426*^9, 
   3.679917349384443*^9}, {3.6799174136620827`*^9, 3.6799174401714363`*^9}, {
   3.6799175166104527`*^9, 3.6799175282932596`*^9}, 3.6799178373631587`*^9, {
   3.6799179537059784`*^9, 3.6799179803577185`*^9}, {3.67991866146945*^9, 
   3.6799187062925053`*^9}, {3.679918827393654*^9, 3.6799189074639287`*^9}, {
   3.6799189626153173`*^9, 3.6799189686805744`*^9}, {3.6799190280052376`*^9, 
   3.6799190455061207`*^9}, {3.6799190972022314`*^9, 3.679919125280387*^9}, {
   3.679924566119967*^9, 3.679924604385762*^9}, {3.6799246642790704`*^9, 
   3.6799246956132803`*^9}, {3.6799247527275844`*^9, 
   3.6799247930164156`*^9}, {3.679924951195854*^9, 3.6799249803781705`*^9}, {
   3.679925022623218*^9, 3.6799250488316956`*^9}, {3.6799253861656322`*^9, 
   3.6799254381888103`*^9}, {3.6799255434641275`*^9, 3.679925616718331*^9}, {
   3.679925661348341*^9, 3.679925698259054*^9}, {3.67992573602477*^9, 
   3.6799257478959365`*^9}, {3.6799258174994507`*^9, 
   3.6799259665814676`*^9}, {3.679926003783972*^9, 3.679926024748337*^9}, {
   3.679926069235965*^9, 3.6799260902291036`*^9}, {3.6799261736068425`*^9, 
   3.679926196432872*^9}, {3.679926255248601*^9, 3.6799262580962477`*^9}, {
   3.679926293552193*^9, 3.679926293751954*^9}, {3.6799263246875305`*^9, 
   3.67992632905294*^9}, {3.6799263775010214`*^9, 3.6799264110418615`*^9}, {
   3.6799264515895023`*^9, 3.679926470697673*^9}, {3.6799267773032274`*^9, 
   3.6799268074427676`*^9}, {3.6799273312718644`*^9, 
   3.6799273548658895`*^9}, {3.6799274096231394`*^9, 
   3.6799274791310563`*^9}, {3.6802492252310677`*^9, 
   3.6802494747564917`*^9}, {3.680249508550872*^9, 3.6802495430476055`*^9}, {
   3.680249675725598*^9, 3.6802497003809333`*^9}, 3.68024975508574*^9, {
   3.680256236853915*^9, 3.6802562600900726`*^9}, {3.68025634441387*^9, 
   3.680256365234165*^9}, {3.6802567065770197`*^9, 3.6802567081447225`*^9}, {
   3.68025976930814*^9, 3.6802597702248554`*^9}, {3.6802649405067997`*^9, 
   3.6802650359517117`*^9}, {3.680265067363373*^9, 3.6802650674600096`*^9}, {
   3.6802651867038527`*^9, 3.680265190137226*^9}, {3.680265223704136*^9, 
   3.680265238230487*^9}, {3.680265490528492*^9, 3.6802655052228985`*^9}, {
   3.680265558508396*^9, 3.680265561709672*^9}, {3.6808879559628687`*^9, 
   3.680888011732835*^9}, {3.6809606117806787`*^9, 3.6809606203078012`*^9}, 
   3.6809606847064285`*^9, {3.6809675539292154`*^9, 3.6809675860694647`*^9}, {
   3.6809692430036077`*^9, 3.680969426149309*^9}, {3.680969611597622*^9, 
   3.680969678171399*^9}, {3.6809717051663656`*^9, 3.680971757266692*^9}, {
   3.681049731545925*^9, 3.6810497326806526`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples", "Subsection",
 CellChangeTimes->{{3.6797567333782396`*^9, 3.6797567347311673`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"M", "=", 
    RowBox[{"GenerateRandomDMDGPInstance", "[", 
     RowBox[{"15", ",", "4"}], "]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"M", "[", "\"\<X\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"M", "[", "\"\<G\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"S", ",", "work"}], "}"}], "=", 
    RowBox[{"BPSolver", "[", "G", "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"work", ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
     RowBox[{"PlotMarkers", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "Small"}], "}"}]}], ",", 
     RowBox[{"PlotLegends", "\[Rule]", 
      RowBox[{"{", "\"\<Real\>\"", "}"}]}]}], "]"}], ",", 
   RowBox[{"BPPlotEstimatedComplexity", "[", "G", "]"}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"HoldForm", "[", 
       RowBox[{"Atom", " ", "ID"}], "]"}], ",", 
      RowBox[{"HoldForm", "[", 
       RowBox[{"Computed", " ", "Locations"}], "]"}]}], "}"}]}], ",", 
   RowBox[{"PlotLabel", "\[Rule]", 
    RowBox[{"HoldForm", "[", 
     RowBox[{"Computational", " ", "Effort"}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CheckDMDGPSolutionQuality", "[", 
   RowBox[{"G", ",", 
    RowBox[{
     RowBox[{"S", "[", "\"\<Points\>\"", "]"}], "[", 
     RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"MatrixPlot", "[", 
    RowBox[{
     RowBox[{"WeightedAdjacencyMatrix", "[", "G", "]"}], ",", 
     RowBox[{"ColorFunction", "->", "\"\<TemperatureMap\>\""}]}], "]"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"MatrixPlot", "[", 
    RowBox[{
     RowBox[{"WeightedAdjacencyMatrix", "[", "G", "]"}], ",", 
     RowBox[{"ColorFunction", "->", "\"\<Monochrome\>\""}]}], "]"}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6798218509178233`*^9, 3.679821852271891*^9}, {
   3.6798220754379344`*^9, 3.6798220755372047`*^9}, {3.679822744321784*^9, 
   3.6798227445214615`*^9}, {3.6798231052765684`*^9, 3.679823107593405*^9}, 
   3.679823226558363*^9, {3.6798233451775875`*^9, 3.679823345308581*^9}, {
   3.679823525737986*^9, 3.679823549906366*^9}, {3.6798263139146395`*^9, 
   3.679826344570452*^9}, {3.6798288602280912`*^9, 3.6798288604903975`*^9}, {
   3.6798288950564623`*^9, 3.679828994620492*^9}, {3.679829044969572*^9, 
   3.6798290909698343`*^9}, {3.6798294100005565`*^9, 
   3.6798294105697436`*^9}, {3.6798295004715223`*^9, 
   3.6798295681002893`*^9}, {3.6798296319378924`*^9, 3.679829632507357*^9}, {
   3.6798299800985794`*^9, 3.6798299863477526`*^9}, {3.679830157933735*^9, 
   3.6798301597117043`*^9}, {3.6798302974701996`*^9, 
   3.6798303164031887`*^9}, {3.6798303891181116`*^9, 3.679830389302563*^9}, {
   3.6798304759096456`*^9, 3.679830478014727*^9}, {3.6799119298147106`*^9, 
   3.6799119406954846`*^9}, {3.679912001613147*^9, 3.679912019708365*^9}, {
   3.6799121456440763`*^9, 3.6799121778114533`*^9}, 3.679912535631927*^9, {
   3.6799174812432394`*^9, 3.6799174816978993`*^9}, {3.679918592547327*^9, 
   3.6799186296132526`*^9}, {3.6799255011209993`*^9, 
   3.6799255012742624`*^9}, {3.6799265772569237`*^9, 
   3.6799266196275845`*^9}, {3.679927091468864*^9, 3.6799271177650127`*^9}, {
   3.679927217233017*^9, 3.679927233987025*^9}, {3.679927271460558*^9, 
   3.679927271760435*^9}, {3.679927363032942*^9, 3.679927363786351*^9}, 
   3.6799274640577226`*^9, {3.6799274956489134`*^9, 3.6799275047564964`*^9}, {
   3.6802494864436903`*^9, 3.680249517698353*^9}, {3.680249838745507*^9, 
   3.680249885493765*^9}, {3.6802499632347374`*^9, 3.68024997989824*^9}, {
   3.6802500278218193`*^9, 3.680250042557376*^9}, {3.6802500816458673`*^9, 
   3.680250094230627*^9}, {3.6802501729429226`*^9, 3.680250245242584*^9}, {
   3.680250277069769*^9, 3.680250349656209*^9}, {3.6802561938862762`*^9, 
   3.680256217314024*^9}, {3.6802562822999315`*^9, 3.6802562845355077`*^9}, {
   3.680259514448849*^9, 3.68025956932335*^9}, {3.680259617915313*^9, 
   3.680259625069577*^9}, {3.6802596588968315`*^9, 3.6802596591149898`*^9}, {
   3.6802597057100697`*^9, 3.680259710865752*^9}, {3.680259778882868*^9, 
   3.680259779298339*^9}, {3.6802598345877275`*^9, 3.6802598347003174`*^9}, {
   3.6802634539441957`*^9, 3.6802634724224014`*^9}, {3.680264125324051*^9, 
   3.680264127539488*^9}, {3.680971309238633*^9, 3.6809713321665344`*^9}, {
   3.6809713775361547`*^9, 3.680971388619849*^9}, 3.680971453133582*^9, {
   3.6809717846377277`*^9, 3.6809717933103046`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.015625`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.6799271469492083`*^9, 3.6799271740522785`*^9}, {
   3.6799272179881067`*^9, 3.679927281469102*^9}, {3.679927317320711*^9, 
   3.679927365286113*^9}, {3.679927453916457*^9, 3.6799275170958385`*^9}, 
   3.6802498005753965`*^9, 3.6802498866569033`*^9, {3.6802500874955435`*^9, 
   3.68025009471589*^9}, 3.680250180614589*^9, {3.680250219236457*^9, 
   3.6802502457057276`*^9}, {3.6802502787355022`*^9, 3.6802503500409083`*^9}, 
   3.680256218570443*^9, {3.6802563677819405`*^9, 3.6802563806826296`*^9}, 
   3.680256713564142*^9, {3.6802587392251263`*^9, 3.6802588003173075`*^9}, {
   3.680259338867547*^9, 3.6802593474582205`*^9}, {3.6802595194218073`*^9, 
   3.680259747997115*^9}, {3.680259781490365*^9, 3.680259858910825*^9}, {
   3.6802634298024864`*^9, 3.6802634802026253`*^9}, {3.6802635491747704`*^9, 
   3.6802635562098227`*^9}, {3.680263641741452*^9, 3.6802637076868067`*^9}, {
   3.680263752807864*^9, 3.6802637701774087`*^9}, {3.6802641284478893`*^9, 
   3.6802641619252925`*^9}, 3.680265077753748*^9, 3.6802651689287195`*^9, {
   3.6802652438409615`*^9, 3.6802652533568344`*^9}, {3.680265327079457*^9, 
   3.6802653387973366`*^9}, 3.68088805290685*^9, 3.6808888111012087`*^9, 
   3.6809605798279586`*^9, 3.680960629305588*^9, 3.6809606897178974`*^9, {
   3.68096971176832*^9, 3.680969719188016*^9}, 3.6809710071972437`*^9, {
   3.6809713190992594`*^9, 3.6809713335362363`*^9}, {3.680971380155532*^9, 
   3.6809713900381804`*^9}, 3.680971798572049*^9, 3.680974520504698*^9, 
   3.6809779803172493`*^9, 3.681037967134864*^9, 3.6810526799561195`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"A total of \"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\" solutions has been found.\"\>"}],
  SequenceForm["A total of ", 2, " solutions has been found."],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6799271469804535`*^9, 3.679927174083527*^9}, {
   3.6799272180193634`*^9, 3.679927281569375*^9}, {3.6799273173892736`*^9, 
   3.6799273653329887`*^9}, {3.6799274539633656`*^9, 3.6799275171114597`*^9}, 
   3.6802498005753965`*^9, 3.6802498890625424`*^9, {3.6802500876517067`*^9, 
   3.680250094762784*^9}, 3.6802501806992292`*^9, {3.6802502192989597`*^9, 
   3.6802502457394896`*^9}, {3.680250282398637*^9, 3.6802503500721617`*^9}, 
   3.680256218576445*^9, {3.680256367819974*^9, 3.680256380883774*^9}, 
   3.680256713670718*^9, {3.680258739543357*^9, 3.6802588012481823`*^9}, {
   3.6802593389816294`*^9, 3.6802593477964725`*^9}, {3.6802595194278097`*^9, 
   3.6802597480271435`*^9}, {3.680259781508377*^9, 3.680259858967866*^9}, {
   3.680263430136228*^9, 3.680263476073059*^9}, {3.680263545611732*^9, 
   3.6802635565080686`*^9}, {3.6802636422118273`*^9, 
   3.6802637051493874`*^9}, {3.680263749796473*^9, 3.680263772450802*^9}, {
   3.680264128483425*^9, 3.680264161962401*^9}, 3.680265078309658*^9, 
   3.6802651689982843`*^9, {3.6802652439685507`*^9, 3.680265253488931*^9}, {
   3.6802653296406198`*^9, 3.6802653388533874`*^9}, 3.680888052910358*^9, 
   3.6808888111012087`*^9, 3.6809605798474903`*^9, 3.6809606293134007`*^9, 
   3.680960689784453*^9, {3.680969712024822*^9, 3.6809697192305436`*^9}, 
   3.6809710073977876`*^9, {3.6809713193466806`*^9, 3.6809713335987406`*^9}, 
   3.680971380224548*^9, 3.6809714346799784`*^9, 3.680971798618924*^9, 
   3.6809745206205845`*^9, 3.6809779804648924`*^9, 3.6810379673119984`*^9, 
   3.6810526802888594`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.09375`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{{3.6799271469492083`*^9, 3.6799271740522785`*^9}, {
   3.6799272179881067`*^9, 3.679927281469102*^9}, {3.679927317320711*^9, 
   3.679927365286113*^9}, {3.679927453916457*^9, 3.6799275170958385`*^9}, 
   3.6802498005753965`*^9, 3.6802498866569033`*^9, {3.6802500874955435`*^9, 
   3.68025009471589*^9}, 3.680250180614589*^9, {3.680250219236457*^9, 
   3.6802502457057276`*^9}, {3.6802502787355022`*^9, 3.6802503500409083`*^9}, 
   3.680256218570443*^9, {3.6802563677819405`*^9, 3.6802563806826296`*^9}, 
   3.680256713564142*^9, {3.6802587392251263`*^9, 3.6802588003173075`*^9}, {
   3.680259338867547*^9, 3.6802593474582205`*^9}, {3.6802595194218073`*^9, 
   3.680259747997115*^9}, {3.680259781490365*^9, 3.680259858910825*^9}, {
   3.6802634298024864`*^9, 3.6802634802026253`*^9}, {3.6802635491747704`*^9, 
   3.6802635562098227`*^9}, {3.680263641741452*^9, 3.6802637076868067`*^9}, {
   3.680263752807864*^9, 3.6802637701774087`*^9}, {3.6802641284478893`*^9, 
   3.6802641619252925`*^9}, 3.680265077753748*^9, 3.6802651689287195`*^9, {
   3.6802652438409615`*^9, 3.6802652533568344`*^9}, {3.680265327079457*^9, 
   3.6802653387973366`*^9}, 3.68088805290685*^9, 3.6808888111012087`*^9, 
   3.6809605798279586`*^9, 3.680960629305588*^9, 3.6809606897178974`*^9, {
   3.68096971176832*^9, 3.680969719188016*^9}, 3.6809710071972437`*^9, {
   3.6809713190992594`*^9, 3.6809713335362363`*^9}, {3.680971380155532*^9, 
   3.6809713900381804`*^9}, 3.680971798572049*^9, 3.680974520504698*^9, 
   3.6809779803172493`*^9, 3.681037967134864*^9, 3.6810526802908616`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Estimated number of Solutions \"\>", "\[InvisibleSpace]", "8", 
   "\[InvisibleSpace]", "\<\".\"\>"}],
  SequenceForm["Estimated number of Solutions ", 8, "."],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6799271469804535`*^9, 3.679927174083527*^9}, {
   3.6799272180193634`*^9, 3.679927281569375*^9}, {3.6799273173892736`*^9, 
   3.6799273653329887`*^9}, {3.6799274539633656`*^9, 3.6799275171114597`*^9}, 
   3.6802498005753965`*^9, 3.6802498890625424`*^9, {3.6802500876517067`*^9, 
   3.680250094762784*^9}, 3.6802501806992292`*^9, {3.6802502192989597`*^9, 
   3.6802502457394896`*^9}, {3.680250282398637*^9, 3.6802503500721617`*^9}, 
   3.680256218576445*^9, {3.680256367819974*^9, 3.680256380883774*^9}, 
   3.680256713670718*^9, {3.680258739543357*^9, 3.6802588012481823`*^9}, {
   3.6802593389816294`*^9, 3.6802593477964725`*^9}, {3.6802595194278097`*^9, 
   3.6802597480271435`*^9}, {3.680259781508377*^9, 3.680259858967866*^9}, {
   3.680263430136228*^9, 3.680263476073059*^9}, {3.680263545611732*^9, 
   3.6802635565080686`*^9}, {3.6802636422118273`*^9, 
   3.6802637051493874`*^9}, {3.680263749796473*^9, 3.680263772450802*^9}, {
   3.680264128483425*^9, 3.680264161962401*^9}, 3.680265078309658*^9, 
   3.6802651689982843`*^9, {3.6802652439685507`*^9, 3.680265253488931*^9}, {
   3.6802653296406198`*^9, 3.6802653388533874`*^9}, 3.680888052910358*^9, 
   3.6808888111012087`*^9, 3.6809605798474903`*^9, 3.6809606293134007`*^9, 
   3.680960689784453*^9, {3.680969712024822*^9, 3.6809697192305436`*^9}, 
   3.6809710073977876`*^9, {3.6809713193466806`*^9, 3.6809713335987406`*^9}, 
   3.680971380224548*^9, 3.6809714346799784`*^9, 3.680971798618924*^9, 
   3.6809745206205845`*^9, 3.6809779804648924`*^9, 3.6810379673119984`*^9, 
   3.681052680720252*^9}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{{}, {{{
         Directive[
          PointSize[0.012833333333333334`], 
          AbsoluteThickness[1.6], 
          RGBColor[1, 0, 0], 
          AbsolutePointSize[6]], 
         GeometricTransformationBox[
          InsetBox[
           BoxData[
            FormBox[
             StyleBox[
             "\"\[FilledCircle]\"", FontSize -> Small, StripOnInput -> False],
              TraditionalForm]], {0., 0.}], {{{1., 1.}}, {{2., 1.}}, {{3., 
          1.}}, {{4., 2.}}, {{5., 4.}}, {{6., 4.}}, {{7., 4.}}, {{8., 4.}}, {{
          9., 8.}}, {{10., 8.}}, {{11., 8.}}, {{12., 8.}}, {{13., 16.}}, {{
          14., 32.}}, {{15., 64.}}}]}, {}}}, {}}, {{}, 
      GraphicsComplexBox[{{1., 1.}, {2., 1.}, {3., 1.}, {4., 2.}, {5., 4.}, {
       6., 4.}, {7., 4.}, {8., 4.}, {9., 4.}, {10., 4.}, {11., 4.}, {12., 
       4.}, {13., 4.}, {14., 8.}, {15., 8.5}, {14.0625, 8.5}, {1., 0.}, {15., 
       0.}}, {{{}, {
          EdgeForm[], 
          Directive[
           RGBColor[0.368417, 0.506779, 0.709798], 
           Opacity[0.2]], 
          GraphicsGroupBox[{
            
            PolygonBox[{{1, 17, 18, 15, 16, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5,
              4, 3, 2}}]}]}, {}, {}}, {{}, {}, {
          Hue[0.67, 0.6, 0.6], 
          Directive[
           PointSize[0.019444444444444445`], 
           RGBColor[0.368417, 0.506779, 0.709798], 
           AbsoluteThickness[1.6]], 
          
          LineBox[{1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 
           16}]}}}], {}}}, {AxesLabel -> {
       FormBox[
        TagBox[
         RowBox[{"Atom", " ", "ID"}], HoldForm], TraditionalForm], 
       FormBox[
        TagBox[
         RowBox[{"Computed", " ", "Locations"}], HoldForm], TraditionalForm]},
      PlotLabel -> FormBox[
       TagBox[
        RowBox[{"Computational", " ", "Effort"}], HoldForm], TraditionalForm],
      DisplayFunction -> Identity, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.05]}}, AxesOrigin -> {0., 0}, 
     PlotRange -> {{0., 15.}, {0, 18.5}}, PlotRangeClipping -> True, 
     ImagePadding -> All, DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {None, None}, AxesOrigin -> {0., 0}, DisplayFunction :> 
     Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], 
     Method -> {"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& ), "CopiedValueFunction" -> ({
           (Part[{{Identity, Identity}, {Identity, Identity}}, 1, 2][#]& )[
            Part[#, 1]], 
           (Part[{{Identity, Identity}, {Identity, Identity}}, 2, 2][#]& )[
            Part[#, 2]]}& )}}, PlotRange -> {{0., 15.}, {0, 18.5}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{
        Scaled[0.02], 
        Scaled[0.02]}, {
        Scaled[0.02], 
        Scaled[0.05]}}, Ticks -> {Automatic, Automatic}}],FormBox[
    TagBox[
     GridBox[{{
        FormBox[
         TemplateBox[{"\"Real\""}, "PointLegend", DisplayFunction -> (StyleBox[
            StyleBox[
             PaneBox[
              TagBox[
               GridBox[{{
                  TagBox[
                   GridBox[{{
                    GraphicsBox[{{}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.308], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0, 0]], {
                    InsetBox[
                    FormBox[
                    StyleBox["\"\[FilledCircle]\"", 
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.308], 
                    AbsoluteThickness[1.6], 
                    RGBColor[1, 0, 0]], FontSize -> 10, Plain, StripOnInput -> 
                    False], TraditionalForm], 
                    NCache[
                    Scaled[{
                    Rational[1, 2], 
                    Rational[1, 2]}], 
                    Scaled[{0.5, 0.5}]]]}}}, AspectRatio -> Full, 
                    ImageSize -> {15, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                    AutoDelete -> False, 
                    GridBoxDividers -> {
                    "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                    GridBoxItemSize -> {
                    "Columns" -> {{All}}, "Rows" -> {{All}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
               "Grid"], Alignment -> Left, AppearanceElements -> None, 
              ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
              "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
            FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
            False]& ), InterpretationFunction :> (RowBox[{"PointLegend", "[", 
             RowBox[{
               RowBox[{"{", 
                 RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"PointSize", "[", "0.012833333333333334`", "]"}], 
                    ",", 
                    RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}], ",", 
                    InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[1, 0, 0], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> RGBColor[0.6666666666666666, 0., 0.], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[1, 0, 0]"], Appearance -> None, BaseStyle -> {},
                     BaselinePosition -> Baseline, DefaultBaseStyle -> {}, 
                    ButtonFunction :> With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[1, 0, 0]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[1, 0, 0], Editable -> False, Selectable -> 
                    False]}], "]"}], "}"}], ",", 
               RowBox[{"{", #, "}"}], ",", 
               RowBox[{"LegendMarkers", "\[Rule]", 
                 RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"\"\[FilledCircle]\"", ",", "Small"}], "}"}], 
                   "}"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", 
                 RowBox[{"{", "False", "}"}]}], ",", 
               RowBox[{"LabelStyle", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", 
               RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
          Editable -> True], TraditionalForm]}, {
        FormBox[
         TemplateBox[{"\"Estimated\""}, "LineLegend", 
          DisplayFunction -> (StyleBox[
            StyleBox[
             PaneBox[
              TagBox[
               GridBox[{{
                  TagBox[
                   GridBox[{{
                    GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                    AutoDelete -> False, 
                    GridBoxDividers -> {
                    "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                    GridBoxItemSize -> {
                    "Columns" -> {{All}}, "Rows" -> {{All}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
                GridBoxAlignment -> {
                 "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                False, GridBoxItemSize -> {
                 "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
               "Grid"], Alignment -> Left, AppearanceElements -> None, 
              ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
              "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
            FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
            False]& ), InterpretationFunction :> (RowBox[{"LineLegend", "[", 
             RowBox[{
               RowBox[{"{", 
                 RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"PointSize", "[", "0.019444444444444445`", "]"}], 
                    ",", 
                    InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.368417, 0.506779, 0.709798]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                    RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
                 "}"}], ",", 
               RowBox[{"{", #, "}"}], ",", 
               RowBox[{"LegendMarkers", "\[Rule]", 
                 RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"False", ",", "Automatic"}], "}"}], "}"}]}], ",", 
               RowBox[{"Joined", "\[Rule]", 
                 RowBox[{"{", "True", "}"}]}], ",", 
               RowBox[{"LabelStyle", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ",", 
               RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
          Editable -> True], TraditionalForm]}}, 
      GridBoxAlignment -> {"Columns" -> {{Left}}}, AutoDelete -> False, 
      GridBoxItemSize -> {
       "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
      GridBoxSpacings -> {"Columns" -> {{0}}}], "Grid"], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{{3.6799271469492083`*^9, 3.6799271740522785`*^9}, {
   3.6799272179881067`*^9, 3.679927281469102*^9}, {3.679927317320711*^9, 
   3.679927365286113*^9}, {3.679927453916457*^9, 3.6799275170958385`*^9}, 
   3.6802498005753965`*^9, 3.6802498866569033`*^9, {3.6802500874955435`*^9, 
   3.68025009471589*^9}, 3.680250180614589*^9, {3.680250219236457*^9, 
   3.6802502457057276`*^9}, {3.6802502787355022`*^9, 3.6802503500409083`*^9}, 
   3.680256218570443*^9, {3.6802563677819405`*^9, 3.6802563806826296`*^9}, 
   3.680256713564142*^9, {3.6802587392251263`*^9, 3.6802588003173075`*^9}, {
   3.680259338867547*^9, 3.6802593474582205`*^9}, {3.6802595194218073`*^9, 
   3.680259747997115*^9}, {3.680259781490365*^9, 3.680259858910825*^9}, {
   3.6802634298024864`*^9, 3.6802634802026253`*^9}, {3.6802635491747704`*^9, 
   3.6802635562098227`*^9}, {3.680263641741452*^9, 3.6802637076868067`*^9}, {
   3.680263752807864*^9, 3.6802637701774087`*^9}, {3.6802641284478893`*^9, 
   3.6802641619252925`*^9}, 3.680265077753748*^9, 3.6802651689287195`*^9, {
   3.6802652438409615`*^9, 3.6802652533568344`*^9}, {3.680265327079457*^9, 
   3.6802653387973366`*^9}, 3.68088805290685*^9, 3.6808888111012087`*^9, 
   3.6809605798279586`*^9, 3.680960629305588*^9, 3.6809606897178974`*^9, {
   3.68096971176832*^9, 3.680969719188016*^9}, 3.6809710071972437`*^9, {
   3.6809713190992594`*^9, 3.6809713335362363`*^9}, {3.680971380155532*^9, 
   3.6809713900381804`*^9}, 3.680971798572049*^9, 3.680974520504698*^9, 
   3.6809779803172493`*^9, 3.681037967134864*^9, 3.6810526808383403`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"max(error) = \"\>", "\[InvisibleSpace]", 
   "0.00005624424952754836`", "\[InvisibleSpace]", "\<\" mean(error) = \"\>", 
   "\[InvisibleSpace]", "2.7916743015620294`*^-6"}],
  SequenceForm[
  "max(error) = ", 0.00005624424952754836, " mean(error) = ", 
   2.7916743015620294`*^-6],
  Editable->False]], "Print",
 CellChangeTimes->{{3.6799271469804535`*^9, 3.679927174083527*^9}, {
   3.6799272180193634`*^9, 3.679927281569375*^9}, {3.6799273173892736`*^9, 
   3.6799273653329887`*^9}, {3.6799274539633656`*^9, 3.6799275171114597`*^9}, 
   3.6802498005753965`*^9, 3.6802498890625424`*^9, {3.6802500876517067`*^9, 
   3.680250094762784*^9}, 3.6802501806992292`*^9, {3.6802502192989597`*^9, 
   3.6802502457394896`*^9}, {3.680250282398637*^9, 3.6802503500721617`*^9}, 
   3.680256218576445*^9, {3.680256367819974*^9, 3.680256380883774*^9}, 
   3.680256713670718*^9, {3.680258739543357*^9, 3.6802588012481823`*^9}, {
   3.6802593389816294`*^9, 3.6802593477964725`*^9}, {3.6802595194278097`*^9, 
   3.6802597480271435`*^9}, {3.680259781508377*^9, 3.680259858967866*^9}, {
   3.680263430136228*^9, 3.680263476073059*^9}, {3.680263545611732*^9, 
   3.6802635565080686`*^9}, {3.6802636422118273`*^9, 
   3.6802637051493874`*^9}, {3.680263749796473*^9, 3.680263772450802*^9}, {
   3.680264128483425*^9, 3.680264161962401*^9}, 3.680265078309658*^9, 
   3.6802651689982843`*^9, {3.6802652439685507`*^9, 3.680265253488931*^9}, {
   3.6802653296406198`*^9, 3.6802653388533874`*^9}, 3.680888052910358*^9, 
   3.6808888111012087`*^9, 3.6809605798474903`*^9, 3.6809606293134007`*^9, 
   3.680960689784453*^9, {3.680969712024822*^9, 3.6809697192305436`*^9}, 
   3.6809710073977876`*^9, {3.6809713193466806`*^9, 3.6809713335987406`*^9}, 
   3.680971380224548*^9, 3.6809714346799784`*^9, 3.680971798618924*^9, 
   3.6809745206205845`*^9, 3.6809779804648924`*^9, 3.6810379673119984`*^9, 
   3.6810526808603563`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["BuildUp Solver", "Section",
 CellChangeTimes->{{3.680878757330321*^9, 3.6808787634963007`*^9}}],

Cell[CellGroupData[{

Cell["Source Code", "Subsection",
 CellChangeTimes->{{3.6808787874069276`*^9, 3.6808787932715735`*^9}}],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "BuildUpSolver", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"BuildUpSolver", "[", "G_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "j", ",", "k", ",", "b", ",", "d", ",", "s", ",", "p", ",", 
        "basis", ",", "kmax", ",", "A", ",", "P", ",", "X", ",", "Y", ",", 
        "U2", ",", "U3", ",", "U4", ",", "V3", ",", "V4", ",", 
        "numberOfAtoms", ",", "maxAbsDetA", ",", "absDetA", ",", 
        RowBox[{"tol", "=", "0.001"}], ",", "error"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"numberOfAtoms", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"VertexList", "[", "G", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"X", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "set", " ", "the", " ", "position", " ", "of", " ", "the", " ", 
         "first", " ", "four", " ", "atoms"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"GetEdgeWeight", "[", 
         RowBox[{"G", ",", 
          RowBox[{"1", "\[Rule]", "2"}]}], "]"}]}], ";", 
       RowBox[{"U2", "=", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"GetEdgeWeight", "[", 
             RowBox[{"G", ",", 
              RowBox[{"3", "\[Rule]", "1"}]}], "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"GetEdgeWeight", "[", 
             RowBox[{"G", ",", 
              RowBox[{"3", "\[Rule]", "2"}]}], "]"}], "^", "2"}], "+", 
           RowBox[{"U2", "^", "2"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", "U2"}], ")"}]}]}], ";", 
       RowBox[{"U3", "=", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"GetEdgeWeight", "[", 
            RowBox[{"G", ",", 
             RowBox[{"3", "\[Rule]", "1"}]}], "]"}], "^", "2"}], "-", 
          RowBox[{"U3", "^", "2"}]}], "]"}]}], ";", 
       RowBox[{"V3", "=", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"GetEdgeWeight", "[", 
             RowBox[{"G", ",", 
              RowBox[{"4", "\[Rule]", "1"}]}], "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"GetEdgeWeight", "[", 
             RowBox[{"G", ",", 
              RowBox[{"4", "\[Rule]", "2"}]}], "]"}], "^", "2"}], "+", 
           RowBox[{"U2", "^", "2"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", "U2"}], ")"}]}]}], ";", 
       RowBox[{"U4", "=", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"GetEdgeWeight", "[", 
             RowBox[{"G", ",", 
              RowBox[{"4", "\[Rule]", "2"}]}], "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"GetEdgeWeight", "[", 
             RowBox[{"G", ",", 
              RowBox[{"4", "\[Rule]", "3"}]}], "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"U4", "-", "U2"}], ")"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"U4", "-", "U3"}], ")"}], "^", "2"}], "+", 
           RowBox[{"V3", "^", "2"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", "V3"}], ")"}]}]}], ";", 
       RowBox[{"V4", "=", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"GetEdgeWeight", "[", 
            RowBox[{"G", ",", 
             RowBox[{"4", "\[Rule]", "1"}]}], "]"}], "^", "2"}], "-", 
          RowBox[{"U4", "^", "2"}], "-", 
          RowBox[{"V4", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "remaining", " ", "atoms"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "5"}], ",", 
         RowBox[{"i", "\[LessEqual]", "numberOfAtoms"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"P", "=", 
           RowBox[{"Subsets", "[", 
            RowBox[{
             RowBox[{"Select", "[", 
              RowBox[{
               RowBox[{"AdjacencyList", "[", 
                RowBox[{"G", ",", "i"}], "]"}], ",", 
               RowBox[{
                RowBox[{"#", "<", "i"}], "&"}]}], "]"}], ",", 
             RowBox[{"{", "4", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<P=\>\"", ",", "P"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "P", "]"}], "<", "1"}], ",", 
            RowBox[{"Throw", "[", "\"\<NotEnoughAdjacentNodes\>\"", "]"}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "search", " ", "for", " ", "systems", " ", "with", " ", "higher", 
            " ", "statbility"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"maxAbsDetA", "=", "0"}], ";", "\[IndentingNewLine]", 
          RowBox[{"basis", "=", 
           RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"s", "=", "1"}], ",", 
            RowBox[{"s", "\[LessEqual]", 
             RowBox[{"Length", "[", "P", "]"}]}], ",", 
            RowBox[{"s", "++"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<P[s]=\>\"", ",", 
               RowBox[{"P", "[", 
                RowBox[{"[", "s", "]"}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"p", "=", 
              RowBox[{"Permutations", "[", 
               RowBox[{"P", "[", 
                RowBox[{"[", "s", "]"}], "]"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"For", "[", 
              RowBox[{
               RowBox[{"k", "=", "1"}], ",", 
               RowBox[{"k", "\[LessEqual]", 
                RowBox[{"Length", "[", "p", "]"}]}], ",", 
               RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Y", "=", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{"X", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"p", "[", 
                    RowBox[{"[", "k", "]"}], "]"}], "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"A", "=", 
                 RowBox[{"2", "*", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Y", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", 
                    RowBox[{"Y", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "2", ",", "4"}], "}"}]}], "]"}]}]}], 
                ";", "\[IndentingNewLine]", 
                RowBox[{"absDetA", "=", 
                 RowBox[{"Abs", "[", 
                  RowBox[{"Det", "[", "A", "]"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<i=\>\"", ",", "i", ",", "\"\<, |DetA|=\>\"", ",", 
                  "absDetA"}], "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"absDetA", ">", "maxAbsDetA"}], ",", 
                  RowBox[{
                   RowBox[{"maxAbsDetA", "=", "absDetA"}], ";", 
                   RowBox[{"basis", "=", 
                    RowBox[{"p", "[", 
                    RowBox[{"[", "k", "]"}], "]"}]}]}]}], "]"}], ";"}]}], 
              "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<basis=\>\"", ",", "basis"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"solve", " ", "the", " ", "linear", " ", "system"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"Y", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"[", 
               RowBox[{"basis", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"A", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Y", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", 
              RowBox[{"Y", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"d", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"GetEdgeWeight", "[", 
              RowBox[{"G", ",", 
               RowBox[{"i", "\[Rule]", 
                RowBox[{"basis", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"A", "=", 
           RowBox[{"2", "*", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Y", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "-", 
               RowBox[{"Y", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "2", ",", "4"}], "}"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"lu", " ", "=", " ", 
           RowBox[{"LUDecomposition", "[", "A", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"b", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "]"}], "^", "2"}], "-", 
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "j", "]"}], "]"}], "]"}], "^", "2"}]}], ")"}],
               "-", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"d", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "-", 
                RowBox[{
                 RowBox[{"d", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], "^", "2"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "2", ",", "4"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "=", 
             RowBox[{"LinearSolve", "[", 
              RowBox[{"A", ",", "b"}], "]"}]}], ";"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"LUBackSubstitution", "[", 
            RowBox[{"lu", ",", "b"}], "]"}]}], ";"}]}], "\[IndentingNewLine]",
         "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "X", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GASolver2", "[", "G_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "i", ",", "j", ",", "d", ",", "x", ",", "y", ",", "z", ",", "s", ",", 
        "numberOfAtoms", ",", "A", ",", "C", ",", "B", ",", "D", ",", "Y", 
        ",", "M", ",", "X", ",", "S", ",", "U2", ",", "U3", ",", "U4", ",", 
        "V3", ",", "V4"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"numberOfAtoms", "=", 
        RowBox[{"Length", "[", 
         RowBox[{"VertexList", "[", "G", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"X", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "set", " ", "the", " ", "position", " ", "of", " ", "the", " ", 
         "first", " ", "four", " ", "atoms"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{"GetEdgeWeight", "[", 
         RowBox[{"G", ",", 
          RowBox[{"1", "\[Rule]", "2"}]}], "]"}]}], ";", 
       RowBox[{"U2", "=", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"GetEdgeWeight", "[", 
             RowBox[{"G", ",", 
              RowBox[{"3", "\[Rule]", "1"}]}], "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"GetEdgeWeight", "[", 
             RowBox[{"G", ",", 
              RowBox[{"3", "\[Rule]", "2"}]}], "]"}], "^", "2"}], "+", 
           RowBox[{"U2", "^", "2"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", "U2"}], ")"}]}]}], ";", 
       RowBox[{"U3", "=", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"GetEdgeWeight", "[", 
            RowBox[{"G", ",", 
             RowBox[{"3", "\[Rule]", "1"}]}], "]"}], "^", "2"}], "-", 
          RowBox[{"U3", "^", "2"}]}], "]"}]}], ";", 
       RowBox[{"V3", "=", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"GetEdgeWeight", "[", 
             RowBox[{"G", ",", 
              RowBox[{"4", "\[Rule]", "1"}]}], "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"GetEdgeWeight", "[", 
             RowBox[{"G", ",", 
              RowBox[{"4", "\[Rule]", "2"}]}], "]"}], "^", "2"}], "+", 
           RowBox[{"U2", "^", "2"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", "U2"}], ")"}]}]}], ";", 
       RowBox[{"U4", "=", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"GetEdgeWeight", "[", 
             RowBox[{"G", ",", 
              RowBox[{"4", "\[Rule]", "2"}]}], "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"GetEdgeWeight", "[", 
             RowBox[{"G", ",", 
              RowBox[{"4", "\[Rule]", "3"}]}], "]"}], "^", "2"}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"U4", "-", "U2"}], ")"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"U4", "-", "U3"}], ")"}], "^", "2"}], "+", 
           RowBox[{"V3", "^", "2"}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{"2", "*", "V3"}], ")"}]}]}], ";", 
       RowBox[{"V4", "=", 
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"X", "[", 
          RowBox[{"[", "4", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "=", 
        RowBox[{"Sqrt", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"GetEdgeWeight", "[", 
            RowBox[{"G", ",", 
             RowBox[{"4", "\[Rule]", "1"}]}], "]"}], "^", "2"}], "-", 
          RowBox[{"U4", "^", "2"}], "-", 
          RowBox[{"V4", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"set", " ", "the", " ", "remaining", " ", "atoms"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "5"}], ",", 
         RowBox[{"i", "\[LessEqual]", "numberOfAtoms"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"P", "=", 
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{"AdjacencyList", "[", 
              RowBox[{"G", ",", "i"}], "]"}], ",", 
             RowBox[{
              RowBox[{"#", "<", "i"}], "&"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "P", "]"}], "<", "4"}], ",", 
            RowBox[{"Throw", "[", "\"\<NotEnoughAdjacentNodes\>\"", "]"}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Y", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"X", "[", 
              RowBox[{"[", 
               RowBox[{"P", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"S", "=", 
           RowBox[{"Y", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"squared", " ", "distances"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"z", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Norm", "[", 
                RowBox[{"Y", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], "^", "2"}], "-", 
              RowBox[{
               RowBox[{"GetEdgeWeight", "[", 
                RowBox[{"G", ",", 
                 RowBox[{"i", "\[Rule]", 
                  RowBox[{"P", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], "^", "2"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"M", "=", 
           RowBox[{"Transpose", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Cross", "[", 
               RowBox[{
                RowBox[{"Y", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"Y", "[", 
                 RowBox[{"[", "3", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"Cross", "[", 
               RowBox[{
                RowBox[{"Y", "[", 
                 RowBox[{"[", "3", "]"}], "]"}], ",", 
                RowBox[{"Y", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"Cross", "[", 
               RowBox[{
                RowBox[{"Y", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], ",", 
                RowBox[{"Y", "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"A", "=", 
           RowBox[{"0.5", "*", 
            RowBox[{"(", 
             RowBox[{"M", ".", 
              RowBox[{"z", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"B", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{"M", "[", 
                RowBox[{"[", 
                 RowBox[{"k", ",", "j"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "3"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"C", "=", 
           RowBox[{"0.5", "*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Transpose", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "-", 
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "-", 
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", 
                  RowBox[{"Y", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}]}], "}"}], "]"}], ".", 
              RowBox[{"z", "[", 
               RowBox[{"[", 
                RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ")"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"d", " ", "=", 
           RowBox[{"Det", "[", 
            RowBox[{"Y", "[", 
             RowBox[{"[", 
              RowBox[{"1", ";;", "3"}], "]"}], "]"}], "]"}]}], ";", 
          RowBox[{"Print", "[", 
           RowBox[{"\"\<Det(A)=\>\"", ",", "d"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"D", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{"S", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "*", 
               RowBox[{"S", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"B", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "/", "2"}]}], "+", 
              RowBox[{"A", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "*", 
               RowBox[{"S", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{"S", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"B", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "/", "2"}]}], "+", 
              RowBox[{"A", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "*", 
               RowBox[{"S", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"C", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "*", 
               RowBox[{"S", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"B", "[", 
                RowBox[{"[", "3", "]"}], "]"}], "*", 
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "/", "2"}]}], "+", 
              RowBox[{"A", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Dot", "[", 
                RowBox[{"A", ",", "S"}], "]"}]}], "+", 
              RowBox[{"d", "*", 
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "/", "2"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"Dot", "[", 
                RowBox[{"B", ",", "S"}], "]"}]}], "+", "d"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"X", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"[", "1", "]"}], "]"}], ",", 
              RowBox[{"D", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{"D", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "/", 
            RowBox[{"D", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "X", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GASolver", "[", "G_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "i", ",", "j", ",", "d", ",", "x", ",", "y", ",", "z", ",", "r", ",", 
       "s", ",", "w", ",", "numberOfAtoms", ",", "A", ",", "B", ",", "C", ",",
        "D", ",", "X", ",", "S", ",", "U2", ",", "U3", ",", "U4", ",", "V3", 
       ",", "V4"}], "}"}], ",", 
     RowBox[{
      RowBox[{"numberOfAtoms", "=", 
       RowBox[{"Length", "[", 
        RowBox[{"VertexList", "[", "G", "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"X", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "numberOfAtoms"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "set", " ", "the", " ", "position", " ", "of", " ", "the", " ", 
        "first", " ", "four", " ", "atoms"}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{"GetEdgeWeight", "[", 
        RowBox[{"G", ",", 
         RowBox[{"1", "\[Rule]", "2"}]}], "]"}]}], ";", 
      RowBox[{"U2", "=", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"GetEdgeWeight", "[", 
            RowBox[{"G", ",", 
             RowBox[{"3", "\[Rule]", "1"}]}], "]"}], "^", "2"}], "-", 
          RowBox[{
           RowBox[{"GetEdgeWeight", "[", 
            RowBox[{"G", ",", 
             RowBox[{"3", "\[Rule]", "2"}]}], "]"}], "^", "2"}], "+", 
          RowBox[{"U2", "^", "2"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", "*", "U2"}], ")"}]}]}], ";", 
      RowBox[{"U3", "=", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"GetEdgeWeight", "[", 
           RowBox[{"G", ",", 
            RowBox[{"3", "\[Rule]", "1"}]}], "]"}], "^", "2"}], "-", 
         RowBox[{"U3", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"V3", "=", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"GetEdgeWeight", "[", 
            RowBox[{"G", ",", 
             RowBox[{"4", "\[Rule]", "1"}]}], "]"}], "^", "2"}], "-", 
          RowBox[{
           RowBox[{"GetEdgeWeight", "[", 
            RowBox[{"G", ",", 
             RowBox[{"4", "\[Rule]", "2"}]}], "]"}], "^", "2"}], "+", 
          RowBox[{"U2", "^", "2"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", "*", "U2"}], ")"}]}]}], ";", 
      RowBox[{"U4", "=", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"GetEdgeWeight", "[", 
            RowBox[{"G", ",", 
             RowBox[{"4", "\[Rule]", "2"}]}], "]"}], "^", "2"}], "-", 
          RowBox[{
           RowBox[{"GetEdgeWeight", "[", 
            RowBox[{"G", ",", 
             RowBox[{"4", "\[Rule]", "3"}]}], "]"}], "^", "2"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"U4", "-", "U2"}], ")"}], "^", "2"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"U4", "-", "U3"}], ")"}], "^", "2"}], "+", 
          RowBox[{"V3", "^", "2"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"2", "*", "V3"}], ")"}]}]}], ";", 
      RowBox[{"V4", "=", 
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"X", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "[", 
        RowBox[{"[", "3", "]"}], "]"}], "=", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"GetEdgeWeight", "[", 
           RowBox[{"G", ",", 
            RowBox[{"4", "\[Rule]", "1"}]}], "]"}], "^", "2"}], "-", 
         RowBox[{"U4", "^", "2"}], "-", 
         RowBox[{"V4", "^", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"set", " ", "the", " ", "remaining", " ", "atoms"}], "*)"}], 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "5"}], ",", 
        RowBox[{"i", "\[LessEqual]", "numberOfAtoms"}], ",", 
        RowBox[{"i", "++"}], ",", 
        RowBox[{
         RowBox[{"P", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"AdjacencyList", "[", 
             RowBox[{"G", ",", "i"}], "]"}], ",", 
            RowBox[{
             RowBox[{"#", "<", "i"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "P", "]"}], "<", "4"}], ",", 
           RowBox[{"Throw", "[", "\"\<NotEnoughAdjacentNodes\>\"", "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x", "=", 
            RowBox[{"X", "[", 
             RowBox[{"[", 
              RowBox[{"P", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"y", "=", 
            RowBox[{"X", "[", 
             RowBox[{"[", 
              RowBox[{"P", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"z", "=", 
            RowBox[{"X", "[", 
             RowBox[{"[", 
              RowBox[{"P", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "]"}], "]"}]}], ",", 
           RowBox[{"s", "=", 
            RowBox[{"X", "[", 
             RowBox[{"[", 
              RowBox[{"P", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "]"}], "]"}]}]}], "}"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"r", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"GetEdgeWeight", "[", 
             RowBox[{"G", ",", 
              RowBox[{"i", "\[Rule]", 
               RowBox[{"P", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "4"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"w", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"x", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "^", "2"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "-", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "^", "2"}]}], ",", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"y", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "^", "2"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "-", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], ",", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"z", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "^", "2"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "-", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "^", "2"}]}], ",", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"s", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "^", "2"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "3"}], "}"}]}], "]"}], "-", 
             RowBox[{
              RowBox[{"r", "[", 
               RowBox[{"[", "4", "]"}], "]"}], "^", "2"}]}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"A", "=", 
          RowBox[{"0.5", "*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "*", 
                  RowBox[{"y", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "*", 
                  RowBox[{"y", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "*", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "*", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}]}], ")"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"y", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "*", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"y", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "*", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "*", 
                  RowBox[{"y", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "*", 
                  RowBox[{"y", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}]}], ")"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "*", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "*", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"y", "[", 
                   RowBox[{"[", "3", "]"}], "]"}], "*", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"y", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "*", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", "3", "]"}], "]"}]}]}], ")"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "*", 
                  RowBox[{"y", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "*", 
                  RowBox[{"y", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "*", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"x", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "*", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"y", "[", 
                   RowBox[{"[", "1", "]"}], "]"}], "*", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", "2", "]"}], "]"}]}], "-", 
                 RowBox[{
                  RowBox[{"y", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "*", 
                  RowBox[{"z", "[", 
                   RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"B", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", 
              RowBox[{"y", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", 
              RowBox[{"z", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "*", 
              RowBox[{"y", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "*", 
              RowBox[{"z", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", 
              RowBox[{"z", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "*", 
              RowBox[{"z", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "*", 
              RowBox[{"y", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "*", 
              RowBox[{"z", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", 
              RowBox[{"y", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", 
              RowBox[{"z", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "*", 
              RowBox[{"z", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", 
              RowBox[{"z", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", 
              RowBox[{"y", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", 
              RowBox[{"z", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", 
              RowBox[{"y", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", 
              RowBox[{"z", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "+", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", 
              RowBox[{"z", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"y", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", 
              RowBox[{"z", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"C", "=", 
          RowBox[{"0.5", "*", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", 
                 RowBox[{"z", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", 
                 RowBox[{"y", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"y", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], "-", 
                 RowBox[{"z", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "-", 
                 RowBox[{"z", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "-", 
                 RowBox[{"y", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"y", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "-", 
                 RowBox[{"z", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "-", 
                 RowBox[{"z", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "-", 
                 RowBox[{"y", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"y", "[", 
                  RowBox[{"[", "3", "]"}], "]"}], "-", 
                 RowBox[{"z", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "*", 
               RowBox[{"w", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", 
            RowBox[{"y", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", 
            RowBox[{"z", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", 
            RowBox[{"y", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "*", 
            RowBox[{"z", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", 
            RowBox[{"y", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", 
            RowBox[{"z", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", 
            RowBox[{"y", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "*", 
            RowBox[{"z", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "*", 
            RowBox[{"y", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "*", 
            RowBox[{"z", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"x", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "*", 
            RowBox[{"y", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "*", 
            RowBox[{"z", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"D", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"C", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", 
              RowBox[{"s", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"C", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "*", 
              RowBox[{"s", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "-", 
             RowBox[{"0.5", "*", 
              RowBox[{"B", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", 
              RowBox[{"w", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "+", 
             RowBox[{"A", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"C", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "*", 
              RowBox[{"s", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"C", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", 
              RowBox[{"s", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], "-", 
             RowBox[{"0.5", "*", 
              RowBox[{"B", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", 
              RowBox[{"w", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "+", 
             RowBox[{"A", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"C", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "*", 
              RowBox[{"s", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], "-", 
             RowBox[{
              RowBox[{"C", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "*", 
              RowBox[{"s", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "-", 
             RowBox[{"0.5", "*", 
              RowBox[{"B", "[", 
               RowBox[{"[", "3", "]"}], "]"}], "*", 
              RowBox[{"w", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}], "+", 
             RowBox[{"A", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Dot", "[", 
               RowBox[{"A", ",", "s"}], "]"}]}], "+", 
             RowBox[{"0.5", "*", "d", "*", 
              RowBox[{"w", "[", 
               RowBox[{"[", "4", "]"}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{"-", 
              RowBox[{"Dot", "[", 
               RowBox[{"B", ",", "s"}], "]"}]}], "+", "d"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"X", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"D", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"D", "[", 
              RowBox[{"[", "3", "]"}], "]"}]}], "}"}], "/", 
           RowBox[{"D", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}]}], ";"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "X", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.680878796715887*^9, 3.6808788985008335`*^9}, {
   3.6808789677890434`*^9, 3.680879020711442*^9}, {3.6808790793750415`*^9, 
   3.68087932980835*^9}, {3.6808794433580427`*^9, 3.680879452768545*^9}, {
   3.680879482957798*^9, 3.6808798572569814`*^9}, {3.6808801823844533`*^9, 
   3.6808802178347673`*^9}, {3.6808811493834057`*^9, 
   3.6808816352290897`*^9}, {3.6808816739789124`*^9, 3.680882032196274*^9}, {
   3.6808820912500343`*^9, 3.6808821757453947`*^9}, {3.680882211133314*^9, 
   3.680882378871024*^9}, {3.6808824342608643`*^9, 3.680882434823531*^9}, {
   3.680883747151867*^9, 3.680883922885659*^9}, {3.680883972978032*^9, 
   3.680884390920006*^9}, {3.6808844300037193`*^9, 3.6808845512584267`*^9}, 
   3.68088461521344*^9, {3.6808846535514545`*^9, 3.6808847349773226`*^9}, {
   3.6808850013417034`*^9, 3.6808850118309097`*^9}, {3.680885071364455*^9, 
   3.680885338050998*^9}, {3.680885369092225*^9, 3.6808854465825834`*^9}, {
   3.6808858161521587`*^9, 3.6808858165517445`*^9}, {3.680885969295744*^9, 
   3.680886034427628*^9}, {3.680886171713134*^9, 3.6808863538065033`*^9}, 
   3.6808863990841804`*^9, {3.6808864612464943`*^9, 3.680886529813063*^9}, {
   3.6808869456867824`*^9, 3.680886961764923*^9}, {3.6808870123576927`*^9, 
   3.680887019550462*^9}, {3.680887114898735*^9, 3.6808871182675095`*^9}, {
   3.680887181162428*^9, 3.680887187111746*^9}, {3.680887251367427*^9, 
   3.680887273892291*^9}, {3.680887323898876*^9, 3.680887325082522*^9}, {
   3.680887456347989*^9, 3.6808874620826855`*^9}, {3.6808875561244335`*^9, 
   3.680887573091951*^9}, {3.680887721148032*^9, 3.6808878253963804`*^9}, {
   3.680887892923795*^9, 3.680887895438401*^9}, {3.6808883279068727`*^9, 
   3.6808883742127953`*^9}, {3.6808887446347*^9, 3.6808888009663877`*^9}, {
   3.680888843084072*^9, 3.68088888217283*^9}, {3.6808889672984886`*^9, 
   3.680888980048806*^9}, {3.680889012873393*^9, 3.680889017001927*^9}, {
   3.6809607127676287`*^9, 3.680960713931309*^9}, {3.680963627939675*^9, 
   3.6809636936788006`*^9}, {3.680963725032446*^9, 3.68096375932222*^9}, {
   3.680963996232436*^9, 3.680964178133572*^9}, {3.680964213180361*^9, 
   3.6809642748716707`*^9}, {3.680964349959564*^9, 3.6809643607069154`*^9}, {
   3.6809643998686404`*^9, 3.680964423431587*^9}, {3.6809649940240765`*^9, 
   3.6809650555320835`*^9}, {3.680965297215009*^9, 3.680965374687066*^9}, {
   3.680965746541073*^9, 3.680965840873766*^9}, {3.680966028202756*^9, 
   3.6809661594200068`*^9}, {3.680966229724207*^9, 3.6809662777779217`*^9}, {
   3.6809663143619595`*^9, 3.680966336214636*^9}, {3.68096644404537*^9, 
   3.6809666533585944`*^9}, {3.680966782656155*^9, 3.68096684043402*^9}, {
   3.6809669531870036`*^9, 3.680967156904188*^9}, {3.6809672053008804`*^9, 
   3.680967224729057*^9}, {3.680967332314844*^9, 3.680967339149928*^9}, {
   3.6809673783050733`*^9, 3.6809674245168176`*^9}, {3.6809676623088226`*^9, 
   3.6809678364166517`*^9}, {3.6809683681222277`*^9, 
   3.6809686165290656`*^9}, {3.6809686831482697`*^9, 3.680968684388035*^9}, {
   3.680968722806388*^9, 3.6809688286478157`*^9}, {3.6809688660650325`*^9, 
   3.6809688731104565`*^9}, {3.680968922304273*^9, 3.680968979206273*^9}, {
   3.6809690865346055`*^9, 3.680969130012158*^9}, {3.680969781989382*^9, 
   3.680969872823762*^9}, {3.6809699400381446`*^9, 3.680970004489729*^9}, {
   3.6809700536833115`*^9, 3.6809700682716103`*^9}, {3.6809710208681808`*^9, 
   3.680971077002434*^9}, {3.680971109326406*^9, 3.680971115550733*^9}, {
   3.6809711907370863`*^9, 3.680971216592291*^9}, {3.680971278912956*^9, 
   3.6809712801192245`*^9}, {3.6809718771352825`*^9, 3.680971944993314*^9}, {
   3.6809720034773016`*^9, 3.6809720732264376`*^9}, {3.6809724406934075`*^9, 
   3.68097248602604*^9}, {3.6809726599472265`*^9, 3.6809726602954173`*^9}, {
   3.6809727230464745`*^9, 3.6809727291279593`*^9}, {3.680973017680879*^9, 
   3.6809730380391974`*^9}, {3.6809731227303166`*^9, 
   3.6809731466993895`*^9}, {3.680973762644851*^9, 3.6809737679144526`*^9}, {
   3.680973813745384*^9, 3.6809738243622527`*^9}, {3.6809739095062947`*^9, 
   3.680973940278738*^9}, {3.680973995792797*^9, 3.6809740011452093`*^9}, {
   3.6809740466010485`*^9, 3.680974060123784*^9}, {3.6809753469202642`*^9, 
   3.680975657929818*^9}, {3.680975695072091*^9, 3.6809758501681805`*^9}, {
   3.6809758996673946`*^9, 3.6809762262710686`*^9}, {3.680976301712438*^9, 
   3.6809763299510756`*^9}, {3.6809763746469035`*^9, 3.680976380499403*^9}, {
   3.6809764218826056`*^9, 3.6809765347847033`*^9}, {3.680976581667529*^9, 
   3.680976597026043*^9}, {3.680976666398885*^9, 3.6809766669610734`*^9}, {
   3.6809767210323706`*^9, 3.680976781558323*^9}, {3.6809768323302093`*^9, 
   3.680976846514173*^9}, {3.680976911357921*^9, 3.6809769209581203`*^9}, {
   3.680977049628893*^9, 3.6809771526850805`*^9}, {3.6809773883553143`*^9, 
   3.6809774793566475`*^9}, {3.6809775209278545`*^9, 3.680977521665044*^9}, {
   3.6809776512633805`*^9, 3.6809776515167046`*^9}, {3.680977712319936*^9, 
   3.6809777460168*^9}, {3.6810531539619203`*^9, 3.681053166959158*^9}, {
   3.6810532473507404`*^9, 3.6810532616980743`*^9}, {3.681053537630972*^9, 
   3.6810535971654816`*^9}, {3.6810536299030733`*^9, 3.681053764619897*^9}, {
   3.6810540191911044`*^9, 3.6810541426058364`*^9}, {3.681054193325778*^9, 
   3.681054202050123*^9}, {3.681054407650793*^9, 3.681054422525179*^9}, {
   3.6810544649467773`*^9, 3.6810544702728024`*^9}, {3.6810545196776843`*^9, 
   3.6810545642818737`*^9}, {3.6810546574028754`*^9, 3.6810546706011558`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example", "Subsection",
 CellChangeTimes->{{3.6808847610415177`*^9, 3.680884762636571*^9}}],

Cell[BoxData[{
 RowBox[{"M", "=", 
  RowBox[{"GenerateRandomDMDGPInstance", "[", 
   RowBox[{"7", ",", "5", ",", "\"\<DistanceMatrix\>\"", ",", "2"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"M", "[", "\"\<X\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"G", "=", 
   RowBox[{"M", "[", "\"\<G\>\"", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Plot3DBackbone", "[", "X", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"S", "=", 
    RowBox[{"BuildUpSolver", "[", "G", "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"K", ",", "work"}], "}"}], "=", 
    RowBox[{"BPSolver", "[", "G", "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"Y", "=", 
    RowBox[{"GASolver", "[", "G", "]"}]}], ";"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"CheckDMDGPSolutionQuality", "[", 
  RowBox[{"G", ",", "S"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"CheckDMDGPSolutionQuality", "[", 
  RowBox[{"G", ",", "Y"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"CheckDMDGPSolutionQuality", "[", 
  RowBox[{"G", ",", 
   RowBox[{
    RowBox[{"K", "[", "\"\<Points\>\"", "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.680884955028639*^9, 3.680884983478408*^9}, 
   3.6808873429555445`*^9, {3.6808873986335063`*^9, 3.680887410506798*^9}, {
   3.680887842239436*^9, 3.680887877459011*^9}, {3.6808888186538677`*^9, 
   3.6808888264332404`*^9}, 3.680888887154725*^9, {3.680888998834424*^9, 
   3.6808889994339256`*^9}, {3.6809689035458927`*^9, 3.680968904973075*^9}, {
   3.6809689551549253`*^9, 3.6809689561999593`*^9}, 3.6809689913188176`*^9, {
   3.6809690334311333`*^9, 3.68096906912233*^9}, {3.6809691379674053`*^9, 
   3.680969162082096*^9}, 3.680970992114458*^9, {3.6809711284184494`*^9, 
   3.6809711531355295`*^9}, {3.680971229423437*^9, 3.6809712295077515`*^9}, {
   3.6809714628650637`*^9, 3.680971524803687*^9}, {3.6809718096686735`*^9, 
   3.680971822904169*^9}, {3.6809728579280663`*^9, 3.680972866434595*^9}, {
   3.680974535749872*^9, 3.6809745358716717`*^9}, {3.6810527194808207`*^9, 
   3.681052725948165*^9}, {3.6810527577368317`*^9, 3.6810528019060116`*^9}, {
   3.681052834116246*^9, 3.681052954628871*^9}, {3.6810529848109074`*^9, 
   3.681053053185604*^9}, {3.681053275793477*^9, 3.681053275913723*^9}, {
   3.681054312872018*^9, 3.681054326556278*^9}, {3.681054386588093*^9, 
   3.6810543866707025`*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{798, 818},
WindowMargins->{{Automatic, -7}, {Automatic, 0}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{594.9599999999999, 842.04}},
Magnification:>0.85 Inherited,
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (April 11, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 147, 2, 76, "Title"],
Cell[730, 26, 815, 20, 63, "Input"],
Cell[CellGroupData[{
Cell[1570, 50, 100, 1, 53, "Section"],
Cell[CellGroupData[{
Cell[1695, 55, 127, 2, 36, "Subsection"],
Cell[1825, 59, 49073, 1126, 3861, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[50935, 1190, 96, 1, 36, "Subsection"],
Cell[CellGroupData[{
Cell[51056, 1195, 121, 1, 28, "Subsubsection"],
Cell[CellGroupData[{
Cell[51202, 1200, 1204, 21, 63, "Input"],
Cell[52409, 1223, 5942, 130, 139, "Print"],
Cell[58354, 1355, 2076, 35, 379, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60479, 1396, 138, 1, 28, "Subsubsection"],
Cell[CellGroupData[{
Cell[60642, 1401, 2470, 49, 171, "Input"],
Cell[CellGroupData[{
Cell[63137, 1454, 3727, 87, 79, "Print"],
Cell[66867, 1543, 3724, 87, 79, "Print"],
Cell[70594, 1632, 288, 7, 18, "Print"],
Cell[70885, 1641, 315, 7, 18, "Print"],
Cell[71203, 1650, 317, 7, 18, "Print"],
Cell[71523, 1659, 460, 11, 18, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[72044, 1677, 149, 2, 28, "Subsubsection"],
Cell[CellGroupData[{
Cell[72218, 1683, 1919, 39, 81, "Input"],
Cell[74140, 1724, 6296, 119, 181, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[80485, 1849, 152, 2, 28, "Subsubsection"],
Cell[80640, 1853, 2328, 43, 135, "Input"],
Cell[82971, 1898, 2246, 54, 189, "Input"],
Cell[85220, 1954, 1163, 27, 153, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[86444, 1988, 99, 1, 53, "Section"],
Cell[CellGroupData[{
Cell[86568, 1993, 101, 1, 36, "Subsection"],
Cell[86672, 1996, 36741, 776, 1737, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123450, 2777, 100, 1, 36, "Subsection"],
Cell[CellGroupData[{
Cell[123575, 2782, 4798, 96, 189, "Input"],
Cell[128376, 2880, 1663, 23, 26, "Output"],
Cell[130042, 2905, 1835, 27, 18, "Print"],
Cell[131880, 2934, 1662, 23, 26, "Output"],
Cell[133545, 2959, 1821, 27, 18, "Print"],
Cell[135369, 2988, 16782, 336, 196, "Output"],
Cell[152154, 3326, 1944, 30, 18, "Print"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[154159, 3363, 101, 1, 53, "Section"],
Cell[CellGroupData[{
Cell[154285, 3368, 103, 1, 36, "Subsection"],
Cell[154391, 3371, 61080, 1513, 2385, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[215508, 4889, 97, 1, 36, "Subsection"],
Cell[215608, 4892, 2569, 54, 189, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

